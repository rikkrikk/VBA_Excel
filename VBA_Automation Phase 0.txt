Sub TM_Phase2V2()
'Phase2v2
    INIT
    DuplicateSameColor
    RAWTABLEINIT
    DATACREATION
    OUTMS
    OUTMR
    genMultiple
    genRapid
    StatusMemo
    HIGHLOW
    LowDollarValue
    RoundDollarValue


    For i = 1 To ActiveWorkbook.Worksheets.count
        Sheets(i).Select
        ActiveWindow.DisplayHeadings = False
        Application.DisplayFormulaBar = False
        ActiveWindow.DisplayGridlines = False
    Next

    RemoveTotals
    DashboardINIT
    HIDESHEETS
    tabcolors
    ARRANGEMENT
    IPCreation
    ActiveWindow.DisplayGridlines = False
    UserInformationInit


   Sheets("UserInformation").Select
   Sheets("UserInformation").Move Before:=Sheets(17)
   Sheets("IpInformation").Move Before:=Sheets(18)


    Sheets("DATA (2)").name = "Unusual Circular (28)"
    Sheets("Dashboard").Select
    Range("E5").Select
    Sheets("Dashboard").name = "CASE ANALYZER"
   ' ZIPCODEFINDER
  '  Search


End Sub
Sub Save()

    Range("D5:D74").Select
    Selection.Copy
    Workbooks.Open "/Users/jamagom/Desktop/RFI_Sheet/L0_RFI_UID.xlsx"
    Sheets(3).Select
    Range("D5:D74").Select
    Selection.PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    Range("D27:D43").Select
    Selection.Replace What:=" ", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, FormulaVersion:= _
        xlReplaceFormula2
    Sheets(2).Select
    ActiveWorkbook.RefreshAll
    Range("B9:C55").Copy
    Application.CutCopyMode = False
    Sheets(3).Select
    Range("E5").Select
End Sub
Private Sub INIT()
    Worksheets(1).name = "DATA (2)"

    'for count and data capacity
    Range("W2").FormulaR1C1 = "=COUNTA(C[-22])"
    Dim totalRows As Long
    totalRows = Range("W2").Value

    Range("A2:S" & totalRows).Select
    Application.CutCopyMode = False
    With Selection.Interior
        .ThemeColor = xlThemeColorDark1
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$C$2"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Application.CutCopyMode = False
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$D$2"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599963377788629
    End With


    Range("E:G,J:K,M:M").Select
    Selection.EntireColumn.Hidden = True

    Range("A1:A" & totalRows).Select
    Selection.Copy
    Range("O1").Select
    ActiveSheet.Paste
    Columns("O:O").Select
    Application.CutCopyMode = False
    Selection.Replace What:=" USD", Replacement:=" ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, FormulaVersion:= _
        xlReplaceFormula2
    Selection.Replace What:="$", Replacement:=" ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, FormulaVersion:= _
        xlReplaceFormula2
    Selection.NumberFormat = "$#,##0.00"
    Selection.NumberFormat = _
        "_([$$-en-US]* #,##0.00_);_([$$-en-US]* (#,##0.00);_([$$-en-US]* ""-""??_);_(@_)"

' resolve na yung 1 transaction pa check nalang yung count and data capacity xxxxxxxxxxxxxxxxxxxxxxxxxx
''    Range("B1:B" & totalRows).Select
    Range("B1").Select
    Selection.Copy
    Range("P1,Q1,S1,R1").Select
    ActiveSheet.Paste

    Application.CutCopyMode = False
    Range("P1").FormulaR1C1 = "Day"
    Range("P2").FormulaR1C1 = "=LEFT(RC[-14],17)"
'''    Range("P2:P" & totalRows).FillDown
    Range("P2").Copy
    Range("P2:P" & totalRows).Select
    ActiveSheet.Paste

    Application.CutCopyMode = False
    Range("Q1").FormulaR1C1 = "Date"
    Range("Q2").FormulaR1C1 = "=RIGHT(RC[-1],12)"
'''    Range("Q2:Q" & totalRows).FillDown
    Range("Q2").Copy
    Range("Q2:Q" & totalRows).Select
    ActiveSheet.Paste

    Range("N1").Select
    ActiveCell.FormulaR1C1 = "None"

    Range("A:A").Activate
    Selection.Font.Size = 14
    Selection.Font.Bold = True

    Range("R1").FormulaR1C1 = "ShortDate"
    Range("R2").FormulaR1C1 = "=DATEVALUE(RC[-1])"
    Columns("R:R").NumberFormat = "m/d/yy"
'''    Range("R2:R" & totalRows).FillDown
    Range("R2").Copy
    Range("R2:R" & totalRows).Select
    ActiveSheet.Paste

    Range("O1").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.NumberFormat = "0.00"

    Range("S1").FormulaR1C1 = "Round Identity"
    Range("S2").FormulaR1C1 = "=MOD(RC[-4],10)"
'''    Range("S2:S" & totalRows).FillDown
    Range("S2").Copy
    Range("S2:S" & totalRows).Select
    ActiveSheet.Paste

    Application.CutCopyMode = False
    Columns("O:S").EntireColumn.AutoFit


    ' unique color
    Range("A2:A" & totalRows).Select
    Selection.FormatConditions.AddUniqueValues
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    Selection.FormatConditions(1).DupeUnique = xlUnique
    With Selection.FormatConditions(1)
        .Font.Color = -11489280
        .Interior.PatternColorIndex = xlAutomatic
        .Interior.ThemeColor = xlThemeColorLight1
        .Interior.TintAndShade = 4.99893185216834E-02
    End With
    Selection.FormatConditions(1).StopIfTrue = False

    'new setting of highlight
    Range("U2").FormulaR1C1 = "=IF(COUNTIF(C1, RC[-20]) > 1, RC[-20], """")"
    Range("U2:U" & totalRows).FillDown
    Range("V2").Formula2R1C1 = "=UNIQUE(RC[-1]:R[1498]C[-1])"


    DuplicateSameColor

    End Sub

Sub DuplicateSameColor()
 Dim count As Long

' Calculate the number of non-empty cells in column A
Range("W2").FormulaR1C1 = "=COUNTA(C[-22])"
count = Range("W2").Value

      If count > 1 Then ' Ensure there are rows to select
    Range("A2:A" & count + 1).Select ' Count + 1 because you start from row 2
    Else
    MsgBox "No data to select."
    End If
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$2"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = 0.799981688894314
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$3"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.799981688894314
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$4"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = 0.799981688894314
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$5"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent4
        .TintAndShade = 0.799981688894314
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$6"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.799981688894314
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$7"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.799981688894314
    End With
 Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$8"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$9"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.399945066682943
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$10"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$11"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent4
        .TintAndShade = 0.399945066682943
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$12"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$13"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.399945066682943
    End With

    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$14"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = 0.499984740745262
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$15"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.499984740745262
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$16"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = 0.499984740745262
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$17"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent4
        .TintAndShade = 0.499984740745262
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$18"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.499984740745262
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$19"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.499984740745262
    End With

    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$20"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = 0.249977111117893
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$21"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.249977111117893
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$22"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = 0.249977111117893
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$23"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent4
        .TintAndShade = 0.249977111117893
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$24"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.249977111117893
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$25"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.249977111117893
    End With

    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$26"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = 0.399975585192419
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$27"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.399975585192419
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$28"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = 0.399975585192419
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$29"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent4
        .TintAndShade = 0.399975585192419
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$30"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$31"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.399975585192419
    End With

    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$32"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = 0.599993896298105
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$33"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0.599993896298105
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$34"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = 0.599993896298105
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="= $V$35"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent4
        .TintAndShade = 0.599993896298105
    End With
      Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$36"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.599993896298105
    End With
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$V$37"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.599993896298105
    End With
End Sub


Private Sub SetDATEVALUE()
    Range("Q1").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Range("R1").Select
    ActiveSheet.Paste
    Range("R1").Select
    Columns("R:R").ColumnWidth = 17
    Application.CutCopyMode = False
    Range("R2").Select
    ActiveCell.FormulaR1C1 = "=DATEVALUE(RC[-1])"
    Columns("R:R").Select
    Selection.NumberFormat = "m/d/yy"
    Range("R1").Select
    ActiveCell.FormulaR1C1 = "ShortDate"
    Range("R2").Select
    Selection.Copy
    Range(Selection, Selection.End(xlDown)).Select
    ActiveSheet.Paste
End Sub
Private Sub genMultiple()
    Dim PSheet As Worksheet
    Dim DSheet As Worksheet
    Dim PCache As PivotCache
    Dim PTable As PivotTable
    Dim pRange As Range
    Dim lastRow As Long
    Dim lastCol As Long

    On Error Resume Next
    Application.DisplayAlerts = False
    Worksheets("MULTIPLE (31)").Delete
    Sheets.Add Before:=ActiveSheet
    ActiveSheet.name = "MULTIPLE (31)"
    Application.DisplayAlerts = True

    Set PSheet = Worksheets("MULTIPLE (31)")
    Set DSheet = Worksheets("DATA (2)")

    lastRow = DSheet.Cells(Rows.count, 1).End(xlUp).Row
    lastCol = DSheet.Cells(1, Columns.count).End(xlToLeft).Column
    Set pRange = DSheet.Cells(1, 1).Resize(lastRow, lastCol)

    Set PCache = ActiveWorkbook.PivotCaches.Create _
    (SourceType:=xlDatabase, SourceData:=pRange). _
    CreatePivotTable(TableDestination:=PSheet.Cells(4, 2), _
    TableName:="MULTIPLEPT")

    Set PTable = PCache.CreatePivotTable _
    (TableDestination:=PSheet.Cells(4, 2), TableName:="MULTIPLEPT")

    With ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Amount2")
    .Orientation = xlRowField
    .Position = 1
    End With
    With ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Status")
        .Orientation = xlPageField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Amount")
        .Orientation = xlDataField
        .Position = 1
    End With

    ' TURN OFF ALL SUBTOTALS FOR EACH FIELD IN THE PIVOT TABLE AND HIDE THE FIELD CAPTIONS (HEADERS) IN THE PIVOT TABLE

    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Amount").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Time Created").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Sender").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Receiver").Subtotals = Array _
        (False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("IDs").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Funding Method").Subtotals _
        = Array(False, False, False, False, False, False, False, False, False, False, False, False _
        )
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Payout Method").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Status").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Backend Status").Subtotals _
        = Array(False, False, False, False, False, False, False, False, False, False, False, False _
        )
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Category").Subtotals = Array _
        (False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Group Request").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Memo").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("IP & Location").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("None").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Amount2").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Day").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Date").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("MULTIPLEPT").DisplayFieldCaptions = False

    ' DECLARE A COUNTER VARIABLE TO KEEP TRACK OF CELLS THAT MEET THE CONDITION
    Dim counter As Integer
    counter = 0

    For Each C In Worksheets("MULTIPLE (31)").Range("C:C").Cells
        If WorksheetFunction.IsNumber(C) = True Then
            If C.Value > 3 Then
                counter = counter + 1
                C.Font.Size = 13
                C.Interior.Color = vbRed
                C.Font.Color = vbWhite
                C.Font.Bold = vbTrue
            End If
        End If
    Next

    'RFI 31 CONDITION TO MARK IN DASHBOARD
    Range("C200").Select
    ActiveCell.FormulaR1C1 = "=MAX(R[-195]C:R[-1]C)"
    Range("F2").FormulaR1C1 = "=If(MAX(C[-3])>3,TRUE,"""")"


     Set t = ActiveSheet.Range("T25")

     Set btn = ActiveSheet.Buttons.Add(t.Left, t.Top, t.Width, t.Height)
     With btn
    .OnAction = "GotoDashboard"
    .Caption = "Dashboard > "
    .name = "Dashboard"
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)
    End With
    INSERTMULTIPLECHART
End Sub
Sub GotoMEMO()

Sheets("STATUS & MEMOS (24-26_40-43)").Activate

End Sub
Sub gotoDashboard()

Sheets("CASE ANALYZER").Activate

End Sub
Private Sub INSERTMULTIPLECHART()
    Columns("CV:CW").Select
    Range("F4").Activate
    ActiveSheet.Shapes.AddChart2(227, ColumnClustered, 286, 68, 900, 600).Select
    ActiveChart.SetSourceData Source:=Range("'MULTIPLE (31)'!$A$3:$B$36")
    ActiveChart.ChartTitle.Delete
    ActiveChart.Legend.Delete
    ActiveWorkbook.ShowPivotTableFieldList = True
    ActiveSheet.PivotTables("MULTIPLEPT").PivotFields("Status").Orientation = _
        xlHidden
End Sub

Sub OUTMR()

'ONE USER TO MANY RECEIVER SIDE CHART
    Dim PSheet As Worksheet
    Dim DSheet As Worksheet
    Dim PCache As PivotCache
    Dim PTable As PivotTable
    Dim pRange As Range
    Dim lastRow As Long
    Dim lastCol As Long

    On Error Resume Next
    Application.DisplayAlerts = False
    Worksheets("OUTM_Receiver").Delete
    Sheets.Add Before:=ActiveSheet
    ActiveSheet.name = "OUTM_Receiver"
    Application.DisplayAlerts = True

    Set PSheet = Worksheets("OUTM_Receiver")
    Set DSheet = Worksheets("DATA (2)")

    lastRow = DSheet.Cells(Rows.count, 1).End(xlUp).Row
    lastCol = DSheet.Cells(1, Columns.count).End(xlToLeft).Column
    Set pRange = DSheet.Cells(1, 1).Resize(lastRow, lastCol)

    Set PCache = ActiveWorkbook.PivotCaches.Create _
    (SourceType:=xlDatabase, SourceData:=pRange). _
    CreatePivotTable(TableDestination:=PSheet.Cells(1, 1), _
    TableName:="PivotTable1")

    Set PTable = PCache.CreatePivotTable _
    (TableDestination:=PSheet.Cells(1, 1), TableName:="PivotTable1")

    ActiveWorkbook.ShowPivotTableFieldList = True
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Status")
        .Orientation = xlPageField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Receiver")
        .Orientation = xlPageField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Amount2")
        .Orientation = xlRowField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Sender")
        .Orientation = xlColumnField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("PivotTable1").PivotFields("Amount")
        .Orientation = xlDataField
        .Position = 1
    End With


    Columns("A:A").Select
    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("D11").Select
    ActiveWorkbook.SlicerCaches.Add2(ActiveSheet.PivotTables("PivotTable1"), _
        "Receiver").Slicers.Add ActiveSheet, , "Receiver", "Receiver", 282, 598, 144, _
        191.249527559055
    ActiveWorkbook.SlicerCaches.Add2(ActiveSheet.PivotTables("PivotTable1"), _
        "Status").Slicers.Add ActiveSheet, , "Status", "Status", 320, 636, 144, _
        191.249527559055
    ActiveSheet.Shapes.Range(Array("Status")).Select
    ActiveSheet.Shapes("Status").IncrementLeft -636
    ActiveSheet.Shapes("Status").IncrementTop -320
    ActiveSheet.Shapes.Range(Array("Receiver")).Select
    ActiveSheet.Shapes("Receiver").IncrementLeft -598
    ActiveSheet.Shapes("Receiver").IncrementTop -53
    ActiveSheet.Shapes("Receiver").IncrementTop -35
    Columns("A:A").ColumnWidth = 28
    Range("B6").Select
   ActiveSheet.PivotTables("PivotTable1").TableStyle2 = "TableStyleMedium2"
    ActiveSheet.Shapes.Range(Array("Status")).Select
    ActiveSheet.Shapes.Range(Array("Status", "Receiver")).Select
    ActiveWorkbook.SlicerCaches("Slicer_Status1").Slicers("Status").Style = _
        "SlicerStyleDark1"
    ActiveWorkbook.SlicerCaches("Slicer_Receiver").Slicers("Receiver").Style = _
        "SlicerStyleDark1"

        Cells.Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Range("D1").Select
      Set G = ActiveSheet.Range("E2")

     Set btn = ActiveSheet.Buttons.Add(G.Left, G.Top, G.Width, G.Height)
     With btn
    .Caption = "Highlight Me! "
    .OnAction = "Rfi37Color"
    .name = "Highlight Me!  "
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)
      End With
End Sub



Sub OUTMS()

'
' 'ONE USER TO MANY SENDER SIDE CHART
'

'
    Dim PSheet As Worksheet
    Dim DSheet As Worksheet
    Dim PCache As PivotCache
    Dim PTable As PivotTable
    Dim pRange As Range
    Dim lastRow As Long
    Dim lastCol As Long

    On Error Resume Next
    Application.DisplayAlerts = False
    Worksheets("OUTM_Sender").Delete
    Sheets.Add Before:=ActiveSheet
    ActiveSheet.name = "OUTM_Sender"
    Application.DisplayAlerts = True

    Set PSheet = Worksheets("OUTM_Sender")
    Set DSheet = Worksheets("DATA (2)")

    lastRow = DSheet.Cells(Rows.count, 1).End(xlUp).Row
    lastCol = DSheet.Cells(1, Columns.count).End(xlToLeft).Column
    Set pRange = DSheet.Cells(1, 1).Resize(lastRow, lastCol)

    Set PCache = ActiveWorkbook.PivotCaches.Create _
    (SourceType:=xlDatabase, SourceData:=pRange). _
    CreatePivotTable(TableDestination:=PSheet.Cells(1, 1), _
    TableName:="OUTM_SenderPT")

    Set PTable = PCache.CreatePivotTable _
    (TableDestination:=PSheet.Cells(1, 1), TableName:="OUTM_SenderPT")

    With ActiveSheet.PivotTables("OUTM_SenderPT").PivotFields("Amount2")
    .Orientation = xlRowField
    .Position = 1
    End With
    With ActiveSheet.PivotTables("OUTM_SenderPT").PivotFields("Status")
        .Orientation = xlPageField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("OUTM_SenderPT").PivotFields("Sender")
        .Orientation = xlPageField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("OUTM_SenderPT").PivotFields("Receiver")
        .Orientation = xlColumnField
        .Position = 1
    End With

    With ActiveSheet.PivotTables("OUTM_SenderPT").PivotFields("Amount")
        .Orientation = xlDataField
        .Position = 1
    End With

    Columns("A:E").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("C9").Select
   ActiveSheet.PivotTables("OUTM_SenderPT").TableStyle2 = "TableStyleMedium2"
    Columns("A:A").Select
    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Selection.ColumnWidth = 20.83
    Range("C9").Select
    ActiveWorkbook.SlicerCaches.Add2(ActiveSheet.PivotTables("OUTM_SenderPT"), _
        "Sender").Slicers.Add ActiveSheet, , "Sender 1", "Sender", 297, 718, 144, _
        191.249527559055
    ActiveWorkbook.SlicerCaches.Add2(ActiveSheet.PivotTables("OUTM_SenderPT"), _
        "Status").Slicers.Add ActiveSheet, , "Status 2", "Status", 335, 756, 144, _
        191.249527559055
    ActiveSheet.Shapes.Range(Array("Status 2")).Select
    ActiveSheet.Shapes("Status 2").IncrementLeft -756
    ActiveSheet.Shapes("Status 2").IncrementTop -335
    ActiveSheet.Shapes.Range(Array("Sender 1")).Select
    ActiveSheet.Shapes("Sender 1").IncrementLeft -718
    ActiveSheet.Shapes("Sender 1").IncrementTop -107
    Columns("A:A").ColumnWidth = 24.33
    Range("D1").Select
    
    
    
       
  Set G = ActiveSheet.Range("E2")

     Set btn = ActiveSheet.Buttons.Add(G.Left, G.Top, G.Width, G.Height)
     With btn
    .Caption = "Highlight Me! "
    .OnAction = "Rfi37Color"
    .name = "Highlight Me!  "
    .Font.Bold = True
    .Font.Size = 12


   .Font.Color = RGB(220, 20, 60)
   End With
End Sub
Sub Rfi37Color()
'
' Macro1 Macro
'

'
  

    
    ' Select the Pivot Table
    Dim pt As PivotTable
    Set pt = Range("B4").PivotTable
    
    ' Select all data in the Pivot Table
    Dim ptDataRange As Range
    Set ptDataRange = pt.DataBodyRange ' This selects the data area of the Pivot Table
    
    ' Apply conditional formatting to the entire data range of the Pivot Table
    With ptDataRange
        .FormatConditions.Add Type:=xlExpression, Formula1:="=($b7 - $b6)<11"
        .FormatConditions(.FormatConditions.count).SetFirstPriority
        With .FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorAccent5
            .TintAndShade = 0.599963377788629
        End With
'        With ptDataRange
'        .FormatConditions.Add Type:=xlExpression, Formula1:="=($b8 - $b6)<11"
'        .FormatConditions(.FormatConditions.count).SetFirstPriority
'        With .FormatConditions(1).Interior
'            .PatternColorIndex = xlAutomatic
'            .ThemeColor = xlThemeColorAccent5
'            .TintAndShade = 0.599963377788629
'        End With
'End With
    End With
    
  

Range("E3").Value = "Always check the separator amount if its value differs by $10 vs the last highlighted amount."
End Sub
Private Sub genRapid()
    Dim PSheet As Worksheet
    Dim DSheet As Worksheet
    Dim PCache As PivotCache
    Dim PTable As PivotTable
    Dim pRange As Range
    Dim lastRow As Long
    Dim lastCol As Long

    On Error Resume Next
    Application.DisplayAlerts = False
    Worksheets("RAPID (27)").Delete
    Sheets.Add Before:=ActiveSheet
    ActiveSheet.name = "RAPID (27)"
    Application.DisplayAlerts = True

    Set PSheet = Worksheets("RAPID (27)")
    Set DSheet = Worksheets("DATA (2)")

    lastRow = DSheet.Cells(Rows.count, 1).End(xlUp).Row
    lastCol = DSheet.Cells(1, Columns.count).End(xlToLeft).Column
    Set pRange = DSheet.Cells(1, 1).Resize(lastRow, lastCol)

    Set PCache = ActiveWorkbook.PivotCaches.Create _
    (SourceType:=xlDatabase, SourceData:=pRange). _
    CreatePivotTable(TableDestination:=PSheet.Cells(4, 2), _
    TableName:="RAPIDPT")

    Set PTable = PCache.CreatePivotTable _
    (TableDestination:=PSheet.Cells(4, 2), TableName:="RAPIDPT")

    With ActiveSheet.PivotTables("RAPIDPT").PivotFields("ShortDate")
    .Orientation = xlRowField
    .Position = 1
    End With
    With ActiveSheet.PivotTables("RAPIDPT").PivotFields("Time Created")
    .Orientation = xlRowField
    .Position = 2
    End With
    With ActiveSheet.PivotTables("RAPIDPT").PivotFields("Status")
        .Orientation = xlPageField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("RAPIDPT").PivotFields("Date")
        .Orientation = xlDataField
        .Position = 1
    End With

    Set PCache = ActiveWorkbook.PivotCaches.Create _
    (SourceType:=xlDatabase, SourceData:=pRange). _
    CreatePivotTable(TableDestination:=PSheet.Cells(100, 100), _
    TableName:="RAPIDPT2")

    Set PTable = PCache.CreatePivotTable _
    (TableDestination:=PSheet.Cells(100, 100), TableName:="RAPIDPT2")

    With ActiveSheet.PivotTables("RAPIDPT2").PivotFields("Date")
    .Orientation = xlRowField
    .Position = 1
    End With
    With ActiveSheet.PivotTables("RAPIDPT2").PivotFields("Date")
        .Orientation = xlDataField
        .Position = 1
    End With


    ' TURN OFF ALL TOTALS FOR EACH FIELD IN THE PIVOT TABLE AND HIDE THE FIELD CAPTIONS (HEADERS) IN THE PIVOT TABLE
    With ActiveSheet.PivotTables("RAPIDPT")
        .ColumnGrand = False
        .RowGrand = False
    End With
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Amount").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Time Created").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Sender").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Receiver").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("IDs").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Funding Method").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Payout Method").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Status").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Backend Status").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Category").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Group Request").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Memo").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("IP & Location").Subtotals = _
        Array(False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("None").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Amount2").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Day").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("Date").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("ShortDate").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("RAPIDPT").DisplayFieldCaptions = False



    ActiveSheet.PivotTables("RAPIDPT").PivotFields("ShortDate").ShowDetail = False



    ActiveSheet.PivotTables("RAPIDPT").DisplayFieldCaptions = True
    ActiveSheet.PivotTables("RAPIDPT").PivotFields("ShortDate").PivotFilters.Add2 _
        Type:=xlValueIsGreaterThanOrEqualTo, DataField:=ActiveSheet.PivotTables( _
        "RAPIDPT").PivotFields("Count of Date"), Value1:=5

    InsertRapidChart

    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Select
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Select
    ActiveChart.ClearToMatchStyle
    ActiveChart.ChartStyle = 228

    Dim counter As Integer
    counter = 0

    For Each C In Worksheets("RAPID (27)").Range("C:C").Cells
        If WorksheetFunction.IsNumber(C) = True Then
            If C.Value >= 5 Then
                C.Font.Size = 13
                C.Interior.Color = vbRed
                C.Font.Color = vbWhite
                C.Font.Bold = vbTrue
                counter = counter + 1
            End If
        End If
    Next

    Range("E2").Value = "Automia:"
    Range("F2").FormulaR1C1 = _
        "=IF(MAX(C[21])>4,OR((MAX(C[21])-(IF(COUNTA(C[21])<2,0,LARGE(C[21],2)))>3),MAX(C[21])>19),"""")"
    Range("AA3").Formula2R1C1 = "=COUNTIF(RAWTABLE[Date], UNIQUE(RAWTABLE[Date]))"
    With Range("AA:AA").Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With

Set R = ActiveSheet.Range("E3")

     Set btn = ActiveSheet.Buttons.Add(R.Left, R.Top, R.Width, R.Height)
     With btn
    .Caption = "DROP "
    .OnAction = "DropRapidData"
    .name = "DROP "
    .Font.Bold = True
    .Font.Size = 12


   .Font.Color = RGB(220, 20, 60)
     End With
Set R = ActiveSheet.Range("F3")

     Set btn = ActiveSheet.Buttons.Add(R.Left, R.Top, R.Width, R.Height)
     With btn
    .Caption = "UNDO "
    .OnAction = "UndoDropRapid"
    .name = "UNDO "
    .Font.Bold = True
    .Font.Size = 12


   .Font.Color = RGB(220, 20, 60) 'RED
    End With
End Sub


Sub DropRapidData()

 ActiveSheet.PivotTables("RAPIDPT").PivotFields("ShortDate").ShowDetail = True
 Range("B5:B500").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="AM", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = -0.499984740745262
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.599963377788629
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.FormatConditions.Add Type:=xlTextString, String:="PM", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249946592608417
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.799981688894314
    End With

 ActiveWindow.Zoom = 200
 ActiveWindow.SmallScroll up:=5
 Range("D4").Select
End Sub

Sub UndoDropRapid()

 ActiveSheet.PivotTables("RAPIDPT").PivotFields("ShortDate").ShowDetail = False
 ActiveWindow.Zoom = 90

End Sub
Private Sub InsertRapidChart()

    Columns("CV:CW").Select
    Range("F4").Activate
    ActiveSheet.Shapes.AddChart2(227, xlLine, 286, 68, 900, 600).Select
    ActiveChart.SetSourceData Source:=Range("'RAPID (27)'!$CV:$CW")
    ActiveChart.ChartTitle.Delete
    ActiveChart.Legend.Delete

End Sub

Private Sub StatusMemo()

    Dim PSheet As Worksheet
    Dim DSheet As Worksheet
    Dim PCache As PivotCache
    Dim PTable As PivotTable
    Dim pRange As Range
    Dim lastRow As Long
    Dim lastCol As Long


    On Error Resume Next
    Application.DisplayAlerts = False
    Worksheets("Status N Memos (24-26)").Delete
    Sheets.Add Before:=ActiveSheet
    ActiveSheet.name = "Status N Memos (24-26)"
    Application.DisplayAlerts = True

    Set PSheet = Worksheets("Status N Memos (24-26)")
    Set DSheet = Worksheets("DATA (2)")

    lastRow = DSheet.Cells(Rows.count, 1).End(xlUp).Row
    lastCol = DSheet.Cells(1, Columns.count).End(xlToLeft).Column
    Set pRange = DSheet.Cells(1, 1).Resize(lastRow, lastCol)

    Set PCache = ActiveWorkbook.PivotCaches.Create _
    (SourceType:=xlDatabase, SourceData:=pRange). _
    CreatePivotTable(TableDestination:=PSheet.Cells(8, 3), _
    TableName:="SnM")

    Set PTable = PCache.CreatePivotTable _
    (TableDestination:=PSheet.Cells(8, 3), TableName:="SnM")

    With ActiveSheet.PivotTables("SnM").PivotFields("Status")
        .Orientation = xlRowField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("SnM").PivotFields("Status")
        .Orientation = xlDataField
        .Position = 1
    End With
    ActiveSheet.PivotTables("SnM").DisplayFieldCaptions = False
    ActiveSheet.PivotTables("SnM").TableStyle2 = "TableStyleMedium2"

    'ADD COLOR GREEN TO COMPLETED STATUS

    Sheets("Status N Memos (24-26 & 40-43)").Select
    Rows("2:2").RowHeight = 1
    Selection.EntireRow.Hidden = True
    Columns("C:C").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="R: Completed", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = 16383844
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 42805
    End With
    Selection.FormatConditions.Add Type:=xlTextString, String:="Nux", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = 16383844
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 42805
    End With

    'CHARTS FOR STATUS AND MEMO

    Set PCache = ActiveWorkbook.PivotCaches.Create _
    (SourceType:=xlDatabase, SourceData:=pRange). _
    CreatePivotTable(TableDestination:=PSheet.Cells(8, 7), _
    TableName:="Mem")

    Set PTable = PCache.CreatePivotTable _
    (TableDestination:=PSheet.Cells(8, 7), TableName:="Mem")

    With ActiveSheet.PivotTables("Mem").PivotFields("Memo")
        .Orientation = xlRowField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("Mem").PivotFields("Memo")
        .Orientation = xlDataField
        .Position = 1
    End With
    ActiveSheet.PivotTables("Mem").DisplayFieldCaptions = False
    ActiveSheet.PivotTables("Mem").TableStyle2 = "TableStyleMedium2"


    Range("C5").Select
    ActiveCell.FormulaR1C1 = "STATUS"
    Range("C5").Select
    With Selection.Font
        .name = Calibri
        .Size = 15
        .Color = -0.499984740745262
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With

    Range("G5:H5").Select
    ActiveCell.FormulaR1C1 = "MEMO"
    Range("G5:H5").Select
    With Selection.Font
        .name = Calibri
        .Size = 15
        .Color = -0.499984740745262
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With

    ActiveWindow.Zoom = 145
    Worksheets("Status N Memos (24-26)").Range("A:G").Columns.AutoFit

      Range("G2").Select
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Range("C8:D50").Select
    ActiveSheet.PivotTables("SnM").TableStyle2 = "PivotStyleDark24"
    Range("G8:H50").Select
    ActiveSheet.PivotTables("Mem").TableStyle2 = "PivotStyleDark28"
    Range("B3:I36").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
   Range("C5").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Range("G5:H5").Select
    Range("H5").Activate
    With Selection
        .HorizontalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With




   ActiveWindow.Zoom = 200

End Sub
Private Sub RemoveTotals()

    Sheets("Status N Memos (24-26)").Select
    ActiveSheet.PivotTables("SnM").PivotSelect "Status[All]", xlLabelOnly + _
        xlFirstRow, True
    Range("C5").Select
    ActiveWorkbook.ShowPivotTableFieldList = True
    Sheets("Status N Memos (24-26)").Select
    Range("B5").Select
    With ActiveSheet.PivotTables("SnM")
        .ColumnGrand = False
        .RowGrand = False
    End With

    ' TURN OFF ALL SUBTOTALS FOR EACH FIELD IN THE PIVOT TABLE AND HIDE THE FIELD CAPTIONS (HEADERS) IN THE PIVOT TABLE

    ActiveSheet.PivotTables("SnM").PivotFields("Amount").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Time Created").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Sender").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Receiver").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("IDs").Subtotals = Array(False, False _
        , False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Funding Method").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Payout Method").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Status").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Backend Status").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Category").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Group Request").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Memo").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("IP & Location").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("None").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Amount2").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Day").Subtotals = Array(False, False _
        , False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("Date").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").PivotFields("ShortDate").Subtotals = Array(False _
        , False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("SnM").DisplayFieldCaptions = True
    ActiveSheet.PivotTables("SnM").DisplayFieldCaptions = False
    ActiveSheet.PivotTables("SnM").DisplayFieldCaptions = True
    ActiveSheet.PivotTables("SnM").DisplayFieldCaptions = False
    Range("F2").Select
    With ActiveSheet.PivotTables("Mem")
        .ColumnGrand = False
        .RowGrand = False
    End With
    ActiveSheet.PivotTables("Mem").PivotFields("Amount").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Time Created").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Sender").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Receiver").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("IDs").Subtotals = Array(False, False _
        , False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Funding Method").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Payout Method").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Status").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Backend Status").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Category").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Group Request").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Memo").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("IP & Location").Subtotals = Array( _
        False, False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("None").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Amount2").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Day").Subtotals = Array(False, False _
        , False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("Date").Subtotals = Array(False, _
        False, False, False, False, False, False, False, False, False, False, False)
    ActiveSheet.PivotTables("Mem").PivotFields("ShortDate").Subtotals = Array(False _
        , False, False, False, False, False, False, False, False, False, False, False)
    Range("C5").Select
    Sheets("MULTIPLE (31)").Select
    Range("B9").Select
    With ActiveSheet.PivotTables("MULTIPLEPT")
        .ColumnGrand = False
        .RowGrand = False
    End With

    Sheets("DATA (2)").Select
End Sub


Private Sub DashboardINIT()

'FUNCTIONS TO CREATE AUTOMARK RFI SHEET

    Sheets("DATA (2)").Select
    Sheets.Add
    Sheets("Sheet15").name = "Dashboard"
    newdashboard
    AdjustRowHeight
    RFIAutoMark
    RFISheetFirstColumnDesign
    AddConditionChargeback
    AddConditionChargebackReversal
    AddConditionNonameZipcode
    AddConditionEngagementAbuse
    AddConditionATO1
    AddConditionATO2
    AddConditionSFI
    AddConditionBusiness
    AddConditionPairAnalysis
    TransactionFormulaAutomation
    AmountNPercentage
    CheckIfCorruptedFile
    HilightXMark
    manual
    Buttonsmanual
    StopLightNotesNGuidance
    Rfi_53
    NOTES2
'    ZIPCODEFINDER
'    Search


    Range("Z1").Value = ChrW(9642) ' This sets the square bullet character
    Set t = ActiveSheet.Range("G31")
     Set btn = ActiveSheet.Buttons.Add(t.Left, t.Top, t.Width * 2, t.Height * 2)
     With btn
    .OnAction = "gotoMULTIPLE"
    .Caption = "Multiple > "
    .name = "Multiple"
    .Font.Bold = True
    .Font.Size = 12 * 2
   .Font.Color = RGB(220, 20, 60) 'White text
    End With


     If Range("D31").Value = "x" Then
        btn.Visible = False
    Else
       btn.Visible = True
    End If



    Set L = ActiveSheet.Range("J18")

     Set btn = ActiveSheet.Buttons.Add(L.Left, L.Top, L.Width, L.Height)
     With btn
    .OnAction = "noLocation"
    .Caption = "No Location "
    .name = "No Location "
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)
    End With

    Range("E27").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]="""", ""CHECK RAPID"", """")"
    Selection.Font.Size = 10

    'CHECK IF CONDITIONS FOR ROUND ARE MEET
    Range("E34").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E34<=49.99"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E34>=50"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = vbRed
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = vbBlack
    End With

    'CHECK IF CONDITIONS FOR LOW DOLLAR ARE MEET
    Range("E32").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E32<=39.99"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E32>=40"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = vbRed
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = vbBlack
    End With


    Range("E31").Select
    Selection.InsertIndent 4.5
    Selection.Font.Bold = True


    'CHECK IF CONDITIONS FOR MULTIPLE ARE MEET
    Range("E31").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E31<4"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E31>=4"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = vbRed
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = vbBlack
    End With

    'CHECK IF CONDITIONS FOR CHARGEBACK ARE MEET
    Range("E40").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E40<=2"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E40>=3"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = vbRed
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = vbBlack
    End With

 'CHECK IF CONDITIONS FOR REFUND ARE MEET
    Range("E41").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E41<=2"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E41>=3"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = vbRed
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = vbBlack
    End With

    'CHECK IF CONDITIONS FOR CHARGEBACK REVERSAL ARE MEET
    Range("E43").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E43<=0"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E43>=1"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = vbRed
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = vbBlack
    End With

    'CHECK IF CONDITIONS FOR MULTIPLE FAILEDS ARE MEET
     Range("E42").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E42<=2"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E42>=3"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = vbRed
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = vbBlack
    End With
    'CHECK IF CONDITIONS FOR MINIMAL TRANSACTION ARE MEET
    Range("E33").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E33<6"
        Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = vbRed
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = vbBlack
    End With
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=E33>5"
     Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.InsertIndent 1
    Selection.InsertIndent 1
    Selection.InsertIndent 1


    If Range("D31").Value = " " Then
        Range("I31").Value = "Look for $10 Difference!"
        Range("I31").Font.Size = 8
    End If

    Range("E33").FormulaR1C1 = "=COUNTIF(RAWTABLE[Amount],""*"")"

        
    'for refunds counting
    Range("E41").FormulaR1C1 = _
        "=COUNTIF(RAWTABLE[Status], ""S: Canceled Customer Service" & Chr(10) & "R: Completed"")"
    'for x marking the refunds found
'    Range("D41").FormulaR1C1 = "=IF(RC[1]>2,""x"","""")"
   
    Range("F39").FormulaR1C1 = _
        "=IF(OR(R[1]C[-1]>0, R[2]C[-1]>0), ""     ACCUMULATED CB AND REFUND HIGHEST AMOUNT:"", "" "")"
        With Selection.Font
        .name = "Calibri"
        .FontStyle = "Regular"
        .Size = 12
        .Underline = xlUnderlineStyleNone
        .Color = 255
        .ThemeFont = xlThemeFontNone
    End With
   Range("F39:I39").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
        
        

    Range("G40").FormulaR1C1 = "='HIGH (29)'!R[-37]C[5]"
    Range("G41").FormulaR1C1 = "='HIGH (29)'!R[-37]C[5]"
'    Range("G40").FormulaR1C1 = "=IF(RC[-2] >0,'HIGH (29)'!R[-36]C[5],"" "")"
'    Range("G41").FormulaR1C1 = "=IF(RC[-2]>0,'HIGH (29)'!R[-38]C[5],"" "")"

    Range("G40:G41").Select
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=0"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With



    Range("G40:G42").Font.Size = 20
    With Range("G40:G42")
    .HorizontalAlignment = xlCenter
    .VerticalAlignment = xlCenter
   End With
   Selection.NumberFormat = "0.00"
  
   'for chargebacks counting
    Range("E40").FormulaR1C1 = _
        "=COUNTIF(RAWTABLE[Status], ""S: Canceled Chargeback" & Chr(10) & "R: Completed"")"


    Range("E42").FormulaR1C1 = _
        "=SUM((COUNTIF(RAWTABLE[Backend Status],""S: " & Chr(10) & "R: "")),(COUNTIF(RAWTABLE[Backend Status],""S: Due to cleanup" & Chr(10) & "R: Failed"")),(COUNTIF(RAWTABLE[Backend Status],""S: Failed" & Chr(10) & "R: Failed"")),(COUNTIF(RAWTABLE[Backend Status],""S: Canceled by customer service" & Chr(10) & "R: Canceled by customer service"")),(COUNTIF(RAWTABLE[Backend Status],""S: Declined by user" & Chr(10) & "R: Declined by user"")),(COUNTIF(RAWTABLE[Backend Status],""S: Canceled by risk review" & Chr(10) & "R: Canceled by risk review"")),(COUNTIF(RAWTABLE[Backend Status],""S: Refunded to other credential" & Chr(10) & "R: Expired"")" & _
        "),(COUNTIF(RAWTABLE[Status],""S: Canceled by customer service" & Chr(10) & "R: Canceled by customer service"")),(COUNTIF(RAWTABLE[Backend Status],""S: Expired" & Chr(10) & "R: Expired"")),(COUNTIF(RAWTABLE[Backend Status],""S: Same card used for sender and receiver" & Chr(10) & "R: Same card used for sender and receiver"")),(COUNTIF(RAWTABLE[Status],""S: Sent" & Chr(10) & "R: Pending Push Fail"")),(COUNTIF(RAWTABLE[Statu" & _
        "s],""S: Sent" & Chr(10) & "R: Pending Processing"")),(COUNTIF(RAWTABLE[Backend Status],""S: Completed" & Chr(10) & "R: Waiting for risk"")),(COUNTIF(RAWTABLE[Backend Status],""S: Initialized" & Chr(10) & "R: Initialized"")))" & _
        ""

    Range("E43").FormulaR1C1 = _
        "=COUNTIF(RAWTABLE[Status],""S: Chargeback Reversal" & Chr(10) & "R: Completed"")"


    With Selection
        .HorizontalAlignment = xlLeft
        .Font.Bold = True
    End With



     Set t = ActiveSheet.Range("F4")

     Set btn = ActiveSheet.Buttons.Add(t.Left, t.Top, t.Width, t.Height)
     With btn
    .OnAction = "Save"
    .Caption = "SAVE  "
    .name = "SAVE"
    .Font.Bold = True
    .Font.Size = 12


   .Font.Color = RGB(220, 20, 60) 'White text

    End With

Range("A1:D1").Select
End Sub
Sub MEMO()
    Dim ws As Worksheet
    Dim rng As Range
    Dim btn As Button

    ' Set reference to "Dashboard" sheet
    Set ws = ThisWorkbook.Sheets("Dashboard")

    ' Merge cells E24:E26 and format
    Set rng = ws.Range("E24:E26")
    With rng
        .Merge
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
    End With

    ' Set formula in merged cell E26
    ws.Range("E26").Formula = "'STATUS & MEMOS (24-26_40-43)'!R[-22]C[3]"

    ' Apply conditional formatting to E26
    With ws.Range("E26")
        .FormatConditions.Add Type:=xlExpression, Formula1:="=E26<=1"
        With .FormatConditions(1).Font
            .Color = -16752384
        End With
        With .FormatConditions(1).Interior
            .PatternColorIndex = xlAutomatic
            .Color = 13561798
        End With
        .FormatConditions.Add Type:=xlExpression, Formula1:="=E26>=2"
        With .FormatConditions(2).Font
            .Color = RGB(220, 20, 60) ' Red color
        End With
        With .FormatConditions(2).Interior
            .PatternColorIndex = xlAutomatic
            .Color = RGB(0, 0, 0) ' Black color
        End With
    End With

    ' Add a button to the worksheet
    Set rng = ws.Range("F26")
    Set btn = ws.Buttons.Add(rng.Left, rng.Top, rng.Width, rng.Height)
    With btn
        .OnAction = "GotoMEMO"
        .Caption = "MEMO >"
        .name = "MEMO"
        .Font.Bold = True
        .Font.Size = 12
        .Font.Color = RGB(220, 20, 60) ' Red color
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
    End With
End Sub


Sub noLocation()
    With Range("K18")
        .Value = "NOTE FOR LOCATION"
       .Interior.Color = RGB(220, 20, 60)
        .Font.Color = RGB(255, 255, 255)
        .Font.Bold = True ' Font size 10 (adjust as needed)
    End With

End Sub



Sub gotoMULTIPLE()
   Sheets("MULTIPLE (31)").Visible = True
   Sheets("MULTIPLE (31)").Activate
   Sheets("MULTIPLE (31)").Move Before:=Sheets(8)
End Sub
Private Sub OUTMDesign()
'
' ONE USER TO MANY TABLE DESIGN
'

'
    Sheets("OUTM_Receiver").Select
    Range("B1").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Sheets("OUTM_Sender").Select
    Range("B1").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With


End Sub

Private Sub RAWTABLEINIT()
'
' RAWTABLEINIT Macro
'

'
    Dim lastRow As Long
    Dim lastCol As Long
    Dim dataRange As Range

    Sheets(1).Activate

    ' Find the last row and last column with data in the worksheet
    lastRow = Sheets(1).Cells(Sheets(1).Rows.count, "A").End(xlUp).Row
    lastCol = Sheets(1).Cells(1, Sheets(1).Columns.count).End(xlToLeft).Column

    ' Set the data range based on the last row and last column
    Set dataRange = Sheets(1).Range(Sheets(1).Cells(1, 1), Sheets(1).Cells(lastRow, lastCol))

    ' Clear any previous selections
    Sheets(1).Cells.Select
    Application.CutCopyMode = False

    ' Add a table with the dynamic data range
    Sheets(1).ListObjects.Add(xlSrcRange, dataRange, , xlYes).name = "RAWTABLE"
End Sub

Private Sub HIGHLOW()

'
' FILTERING STATUS FOR LOW AND HIGH DOLLAR VALUE
'

    Rows("2:2").Select
    Selection.RowHeight = 33
    Range("D3").Select
    Range("D2").Select
    ActiveCell.FormulaR1C1 = "=COUNT(C[-1])"
    Range("C2:D2").Select
    Selection.ClearContents
    Range("G2").Select
    ActiveCell.FormulaR1C1 = "=COUNTA(C[-4])-1"
    Range("G3").Select
    Sheets("DATA (2)").Select
    Range("A56").Select
    Range(Selection, Selection.End(xlUp)).Select
    Range("A56").Select
    Range(Selection, Selection.End(xlUp)).Select
    Range("RAWTABLE[[#Headers],[Amount]]").Select
    Range(Selection, Selection.End(xlDown)).Select

    Dim lastRow As Long
    Dim lastCol As Long
    Dim dataRange As Range


    Sheets("DATA (3)").Select
    Sheets("DATA (3)").ListObjects("HITABLE").Range.AutoFilter Field:=8, Criteria1:=Array( _
            "S: " & Chr(10) & "R: Completed - Paid out", _
            "S: Failed - Failed to refund" & Chr(10) & "R: Completed - Paid out", _
            "S: Refunded to other credential" & Chr(10) & "R: Completed - Paid out", _
            "S: Canceled System Fail" & Chr(10) & "R: Completed", _
            "S: Canceled Chargeback" & Chr(10) & "R: Completed", _
            "S: Chargeback Reversal" & Chr(10) & "R: Completed", _
            "S: Canceled Customer Service" & Chr(10) & "R: Completed", _
            "S: Canceled Chargeback Reversal" & Chr(10) & "R: Completed", _
            "S: Completed" & Chr(10) & "R: Completed", _
            "S: Sent" & Chr(10) & "R: Pending Nux", _
            "S: Completed" & Chr(10) & "R: Cannot determine", _
            "S: Canceled Chargeback" & Chr(10) & "R: Canceled Chargeback", _
            "S: Canceled System Fail" & Chr(10) & "R: Completed"), Operator:=xlFilterValues

    ' Find the last row and last column with data in the worksheet
    lastRow = Sheets("DATA (3)").Cells(Sheets("DATA (3)").Rows.count, "A").End(xlUp).Row
    lastCol = Sheets("DATA (3)").Cells(1, Sheets("DATA (3)").Columns.count).End(xlToLeft).Column

    ' Set the data range based on the last row and last column
    Set dataRange = Sheets("DATA (3)").Range(Sheets("DATA (3)").Cells(1, 1), Sheets("DATA (3)").Cells(lastRow, lastCol))

    dataRange.Copy

    ' Add a table with the dynamic data range
    Sheets.Add After:=ActiveSheet
    ActiveSheet.Paste


    ActiveSheet.name = "HISUCCESS"

    lastRow = ActiveSheet.Cells(ActiveSheet.Rows.count, "A").End(xlUp).Row
    lastCol = ActiveSheet.Cells(1, ActiveSheet.Columns.count).End(xlToLeft).Column

    Set dataRange = ActiveSheet.Range(ActiveSheet.Cells(1, 1), ActiveSheet.Cells(lastRow, lastCol))

    Dim tblExists As Boolean
    Dim WS_Count As Integer
    Dim i As Integer

    tblExists = False
    WS_Count = ActiveWorkbook.Worksheets.count

    WS_Count = ActiveWorkbook.Worksheets.count

    For i = 1 To WS_Count
        For Each O In Sheets(i).ListObjects
            If O.name = "HITABLE6" Then tblExists = True
        Next O
    Next i

    If (tblExists) Then
        Sheets("HISUCCESS").ListObjects("HITABLE6").Unlist
        Sheets("HISUCCESS").ListObjects.Add(xlSrcRange, dataRange, , xlYes).name = "HITABLE6"
    Else
        Sheets("HISUCCESS").ListObjects.Add(xlSrcRange, dataRange, , xlYes).name = "HITABLE6"
    End If


     Sheets.Add After:=ActiveSheet
    ActiveSheet.Select
    ActiveSheet.name = "HIGH (29)"
    Range("B4").Select
    ActiveCell.Formula2R1C1 = "=HITABLE6[Status]"
      Columns("B:B").Select
    Selection.ColumnWidth = 40
    Range("C3").Select
    Selection.Copy
    Range("B3").Select
    ActiveCell.FormulaR1C1 = " STATUS"
    Range("B4").Select
    Range("B4:B280").Select
    With Selection.Font
        .Color = -11480942
    End With
    Range("B3").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.Font.Size = 14
    Selection.Font.Bold = True
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight2
        .TintAndShade = 0.599993896298105
    End With
    Range("B3:B1272").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("C4").Select
    ActiveCell.Formula2R1C1 = "=HITABLE6[Backend Status]"
    Range("C5").Select
    Columns("C:C").EntireColumn.AutoFit
    Range("D4").Select
    ActiveCell.Formula2R1C1 = "=HITABLE6[Amount2]"
    Columns("D:D").Select
    Selection.NumberFormat = "0.00"
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Range("E4").Select
    ActiveCell.Formula2R1C1 = "=HITABLE6[Date]"
    Range("E5").Select
    Columns("E:E").EntireColumn.AutoFit
    Columns("E:E").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Range("C3").Select
    ActiveCell.FormulaR1C1 = "BACKEND STATUS"
    Range("D3").Select
    ActiveCell.FormulaR1C1 = "AMOUNT"
    Range("E3").Select
    ActiveCell.FormulaR1C1 = "DATE"
    Range("C3:E3").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Range(Selection, Selection.End(xlDown)).Select
    Selection.AutoFilter

    Call HighDollarCondition
    Columns("C:C").Select
    Selection.EntireColumn.Hidden = True
    Columns("F:G").Select
    Selection.EntireColumn.Hidden = True
    Range("B1:E1").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    Range("B2:E2").Select
    ActiveCell.FormulaR1C1 = "RFI 29 - HIGH DOLLAR VALUE"
     Range("B2:E2").Select
     With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight2
        .TintAndShade = 0.399975585192419
    End With

End Sub

Sub DATACREATION()
'
' DATACREATION Macro
'

'
    Sheets("DATA (2)").Select
    Sheets("DATA (2)").Copy Before:=Sheets(1)
    Sheets("DATA (3)").Select
    Sheets("DATA (3)").Move Before:=Sheets(2)
    Sheets("DATA (3)").Select
    Sheets("DATA (3)").Copy Before:=Sheets(2)
    Sheets("DATA (2)").Select
    Sheets("DATA (2)").Copy Before:=Sheets(3)
    Sheets("DATA (3)").Select
    Range("B6").Select
    Application.DisplayFormulaBar = True
    Range("A2").Select
    ActiveSheet.ListObjects("RAWTABLE3").name = "HITABLE"
    Range("B6").Select
    ActiveWorkbook.Worksheets("DATA (3)").ListObjects("HITABLE").Sort.SortFields. _
        Clear
    ActiveWorkbook.Worksheets("DATA (3)").ListObjects("HITABLE").Sort.SortFields. _
        Add2 Key:=Range("HITABLE[[#All],[Amount2]]"), SortOn:=xlSortOnValues, _
        Order:=xlDescending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("DATA (3)").ListObjects("HITABLE").Sort
        .Header = xlYes
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

    Sheets("DATA (4)").Select
    Range("E11").Select
    Range("I1").Select
    Selection.AutoFilter
        ActiveSheet.ListObjects("RAWTABLE34").Range.AutoFilter Field:=8, Criteria1:=Array( _
            "S: " & Chr(10) & "R: Completed - Paid out", _
            "S: Failed - Failed to refund" & Chr(10) & "R: Completed - Paid out", _
            "S: Refunded to other credential" & Chr(10) & "R: Completed - Paid out", _
            "S: Canceled System Fail" & Chr(10) & "R: Completed", _
            "S: Canceled Chargeback" & Chr(10) & "R: Completed", _
            "S: Chargeback Reversal" & Chr(10) & "R: Completed", _
            "S: Canceled Customer Service" & Chr(10) & "R: Completed", _
            "S: Canceled Chargeback Reversal" & Chr(10) & "R: Completed", _
            "S: Completed" & Chr(10) & "R: Completed", _
            "S: Sent" & Chr(10) & "R: Pending Nux", _
            "S: Completed" & Chr(10) & "R: Cannot determine", _
            "S: Canceled Chargeback" & Chr(10) & "R: Canceled Chargeback", _
             "S: Canceled System Fail" & Chr(10) & "R: Completed"), Operator:=xlFilterValues


    ActiveWorkbook.Worksheets("DATA (4)").ListObjects("RAWTABLE34").Sort.SortFields. _
        Add2 Key:=Range("RAWTABLE34[[#All],[Amount2]]"), SortOn:=xlSortOnValues, _
        Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("DATA (4)").ListObjects("RAWTABLE34").Sort
        .Header = xlYes
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

    Sheets("DATA (5)").Select
    Range("RAWTABLE5[#All]").Select
    ActiveSheet.ListObjects("RAWTABLE5").Range.AutoFilter Field:=19, Criteria1:= _
        "0.00"

End Sub
Sub HighDollarCondition()

     Range("E4:E20").Activate
    Application.CutCopyMode = False
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=$E$4"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16754788
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 10284031
    End With
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Application.CutCopyMode = False
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
            Formula1:="=$E$5"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = 0.599963377788629
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Application.CutCopyMode = False
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
            Formula1:="=$E$6"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 65535
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Application.CutCopyMode = False
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
            Formula1:="=$E$7"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Application.CutCopyMode = False
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
            Formula1:="=$E$8"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = 0.399945066682943
    End With

    Application.DisplayFormulaBar = True
    Application.DisplayFormulaBar = False
    ActiveWindow.DisplayHeadings = True
    Range("D4:D100").Select
    Selection.FormatConditions.AddColorScale ColorScaleType:=2
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    Selection.FormatConditions(1).ColorScaleCriteria(1).Type = _
        xlConditionValueLowestValue
    With Selection.FormatConditions(1).ColorScaleCriteria(1).FormatColor
        .Color = 16776444
    End With
    Selection.FormatConditions(1).ColorScaleCriteria(2).Type = _
        xlConditionValueHighestValue
    With Selection.FormatConditions(1).ColorScaleCriteria(2).FormatColor
        .Color = 7039480
    End With


    Range("D3").Select
    Selection.FormatConditions.Delete
    Columns("C:C").Select
    Application.CutCopyMode = False
    Selection.FormatConditions.Add Type:=xlTextString, String:="Completed", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -11480942
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.FormatConditions.Add Type:=xlTextString, String:="Completed", _
        TextOperator:=xlDoesNotContain
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16383844
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Range("C3").Select
    Selection.FormatConditions.Delete
    With Selection.Font
        .name = "Calibri"
        .Size = 14
        .Color = -16777216
    End With
    Range("C4").Select
    Columns("E:E").EntireColumn.AutoFit
    Columns("D:D").EntireColumn.AutoFit
    Columns("C:E").Select
    With Selection.Font
        .name = "Calibri"
        .Size = 14
        .Color = -16777216
    End With
    Columns("C:E").EntireColumn.AutoFit
    Range("F2").Select
    With Selection.Font
        .name = "Calibri"
        .Size = 14
        .Color = -16777216
    End With
    Columns("F:F").EntireColumn.AutoFit
    Range("G2").Select
    With Selection.Font
        .name = "Calibri"
        .Size = 15
        .Color = -16777216
    End With
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Range("G2").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With

 HighDifference

 'back end status high
       ActiveSheet.Range("$B$3:$E$500").AutoFilter Field:=1, Criteria1:=Array( _
        "S: " & Chr(10) & "R: Completed - Paid out", _
        "S: Canceled by customer service" & Chr(10) & "R: Completed - Paid out", _
        "S: Completed" & Chr(10) & "R: Completed - Paid out", _
        "S: Failed - Failed to refund" & Chr(10) & "R: Completed - Paid out", _
        "S: Completed" & Chr(10) & "R: Completed", _
        "S:" & Chr(10) & "R: Sender did a chargeback", _
        "S: Refunded to other credential" & Chr(10) & "R: Completed - Paid out"), Operator:=xlFilterValues

     Range("G2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark2
        .TintAndShade = -0.249977111117893
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
    End With
    Range("F2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight2
        .TintAndShade = 0.599993896298105
    End With
    Columns("C:E").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("C1:E2").Select
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("F2:G2").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("G2").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=R[2]C[-3]"
    Range("F2").Select
    ActiveCell.FormulaR1C1 = "Highest Value:"
    Range("C3:E3").Select
    Selection.Font.Bold = True

    Range("G2").Formula2R1C1 = _
        "=IF(OR(R[12]C[4]>39.99, MAX(FREQUENCY(FILTER(C[-2], C[-2]<=100), C[-2]))>7), TRUE, ""SKIP"")"
    Columns("G:G").EntireColumn.AutoFit
    Range("B1:E2").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("I3:I4").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
ActiveWindow.Zoom = 150
End Sub

Private Sub LowDollarValue()

    Sheets("DATA (4)").Select
    ActiveSheet.ListObjects("RAWTABLE34").Range.AutoFilter Field:=8, Criteria1:=Array( _
            "S: " & Chr(10) & "R: Completed - Paid out", _
            "S: Failed - Failed to refund" & Chr(10) & "R: Completed - Paid out", _
            "S: Refunded to other credential" & Chr(10) & "R: Completed - Paid out", _
            "S: Canceled System Fail" & Chr(10) & "R: Completed", _
            "S: Canceled Chargeback" & Chr(10) & "R: Completed", _
            "S: Chargeback Reversal" & Chr(10) & "R: Completed", _
            "S: Canceled Customer Service" & Chr(10) & "R: Completed", _
            "S: Canceled Chargeback Reversal" & Chr(10) & "R: Completed", _
            "S: Completed" & Chr(10) & "R: Completed", _
            "S: Sent" & Chr(10) & "R: Pending Nux", _
            "S: Completed" & Chr(10) & "R: Cannot determine", _
            "S: Canceled Chargeback" & Chr(10) & "R: Canceled Chargeback", _
             "S: Canceled System Fail" & Chr(10) & "R: Completed"), Operator:=xlFilterValues
    ActiveWorkbook.Worksheets("DATA (4)").ListObjects("RAWTABLE34").Sort.SortFields. _
        Add2 Key:=Range("RAWTABLE34[[#All],[Amount2]]"), SortOn:=xlSortOnValues, _
        Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("DATA (4)").ListObjects("RAWTABLE34").Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

    Dim lastRow As Long
    Dim lastCol As Long
    Dim dataRange As Range

    ' Find the last row and last column with data in the worksheet
    lastRow = Sheets("DATA (4)").Cells(Sheets("DATA (4)").Rows.count, "A").End(xlUp).Row
    lastCol = Sheets("DATA (4)").Cells(1, Sheets("DATA (4)").Columns.count).End(xlToLeft).Column

    ' Set the data range based on the last row and last column
    Set dataRange = Sheets("DATA (4)").Range(Sheets("DATA (4)").Cells(1, 1), Sheets("DATA (4)").Cells(lastRow, lastCol))

    dataRange.Copy

    ' Add a table with the dynamic data range
    Sheets.Add After:=ActiveSheet
    ActiveSheet.Paste
    ActiveSheet.name = "LOWSUCCESS"

    lastRow = ActiveSheet.Cells(ActiveSheet.Rows.count, "A").End(xlUp).Row
    lastCol = ActiveSheet.Cells(1, ActiveSheet.Columns.count).End(xlToLeft).Column

    Set dataRange = ActiveSheet.Range(ActiveSheet.Cells(1, 1), ActiveSheet.Cells(lastRow, lastCol))

    Dim tblExists As Boolean
    Dim WS_Count As Integer
    Dim i As Integer
    Dim name As String

    tblExists = False
    WS_Count = ActiveWorkbook.Worksheets.count

    For i = 1 To WS_Count
        For Each O In Sheets(i).ListObjects
            If O.name = "LOTABLE8" Or O.name = "LOTABLE7" Or O.name = "RAWTABLE349" Or O.name = "RAWTABLE347" Or O.name = "RAWTABLE348" Then
                tblExists = True
                name = O.name
            End If
        Next O
    Next i

    If (tblExists) Then
        If name = "LOTABLE7" Then
            Sheets("LOWSUCCESS").ListObjects("LOTABLE7").Unlist
        End If
        If name = "LOTABLE8" Then
            Sheets("LOWSUCCESS").ListObjects("LOTABLE8").Unlist
        End If
        If name = "RAWTABLE349" Then
            Sheets("LOWSUCCESS").ListObjects("RAWTABLE349").Unlist
        End If
        If name = "RAWTABLE347" Then
            Sheets("LOWSUCCESS").ListObjects("RAWTABLE347").Unlist
        End If
        If name = "RAWTABLE348" Then
            Sheets("LOWSUCCESS").ListObjects("RAWTABLE348").Unlist
        End If

        Sheets("LOWSUCCESS").ListObjects.Add(xlSrcRange, dataRange, , xlYes).name = "LOTABLE8"
    Else
        Sheets("LOWSUCCESS").ListObjects.Add(xlSrcRange, dataRange, , xlYes).name = "LOTABLE8"
    End If

    Sheets("LOWSUCCESS").Select
    Sheets.Add After:=ActiveSheet
    Range("D4").Select
    ActiveCell.Formula2R1C1 = "=LOTABLE8[Backend Status]"
    Range("D5").Select
    Columns("D:D").EntireColumn.AutoFit
    Range("E4").Select
    ActiveCell.Formula2R1C1 = "=LOTABLE8[Amount2]"
    Columns("E:E").Select
    Selection.NumberFormat = "General"
    Selection.NumberFormat = "0.00"
    Range("D3").Select
    ActiveCell.FormulaR1C1 = "BACKEND STATUS"
    Range("E3").Select
    ActiveCell.FormulaR1C1 = "AMOUNT"
    Columns("D:E").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Range("D3:E3").Select
    Selection.AutoFilter
    Selection.AutoFilter
    Range("E3").Select
    Selection.AutoFilter
    Range("E3").Select
    Sheets("LOWSUCCESS").Select
    ActiveWorkbook.Worksheets("LOWSUCCESS").ListObjects("LOTABLE8").Sort.SortFields _
        .Clear
    ActiveWorkbook.Worksheets("LOWSUCCESS").ListObjects("LOTABLE8").Sort.SortFields _
        .Add2 Key:=Range("LOTABLE8[[#All],[Amount2]]"), SortOn:=xlSortOnValues, _
        Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("LOWSUCCESS").ListObjects("LOTABLE8").Sort
        .Header = xlYes
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Sheets("Sheet12").Select
    Sheets("Sheet12").name = "LOW (32)"

    Range("F2").Select
    Sheets("HIGH (29)").Select
    Range("F2:G2").Select
    Selection.Copy
    Sheets("LOW (32)").Select
    Range("F2").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Columns("F:F").EntireColumn.AutoFit
    Range("F2").Value = "MARK RFI 32?"
    Range("G3").Select
    Columns("G:G").EntireColumn.AutoFit
    Range("G11,G13,G15,G17").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 15773696
    End With
    Range("H11,H13,H15,H17").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.349986266670736
    End With
    Range("G11:H17").Select
    Selection.Font.Size = 12
    With Selection.Font
        .name = "Calibri"
        .Size = 22
        .Color = -16777216
    End With
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("G11, G13, G15").Select
    Range("O2").Activate
    Selection.Font.Size = 20
    Selection.Font.Size = 18
    Range("G10").Select
    ActiveWindow.DisplayHeadings = True
    Columns("D:E").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("D1:E2").Select
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With

    Range("C14").Select
    Range("G11").Select
    ActiveCell.FormulaR1C1 = "<51"
    Range("G13").Select
    ActiveCell.FormulaR1C1 = "<100"
    Range("G15").Select
    ActiveCell.FormulaR1C1 = "<101"
    Range("G17").Select
    ActiveCell.FormulaR1C1 = "<151"

    Range("J14").FormulaR1C1 = "(40%)"
    Range("P2").Select
    Application.CutCopyMode = False
    Range("H15").Select
    Selection.NumberFormat = "General"

    Columns("C:E").Select
    With Selection.Font
        .name = "Calibri"
        .Size = 14
        .Color = -16777216
    End With
    Range("C2").Select
    Columns("C:D").EntireColumn.AutoFit
    Range("D3:E3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 15773696
    End With
    Range("F9").Select

    Range("C4").Select
    ActiveCell.Formula2R1C1 = "=LOTABLE8[Status]"
    Range("D3").Select
    Selection.Copy
    Range("C3").Select
    ActiveSheet.Paste
    Range("C3").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "STATUS"
    Range("C3").Select
    ActiveWindow.DisplayHeadings = True
    Columns("C:E").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("C1:E2").Select
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("B4").Select
    Columns("C:C").EntireColumn.AutoFit
    Columns("C:E").Select
    With Selection.Font
        .name = "Calibri"
        .Size = 14
        .Color = -16777216
    End With
    Range("C5:D1048576,D4,C4").Select
    Range("C4").Activate
    With Selection.Font
        .Color = -11489280
    End With
    Range("B4").Select

    Range("H4").Select
    Selection.ClearContents
    ActiveCell.FormulaR1C1 = "='HIGH (29)'!RC[-4]"
    Range("G5").Select
    Selection.Copy
    Range("G4").Select
    ActiveSheet.Paste
    Range("G4").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Highest Dollar Value:"
    Range("H5").Select
    Selection.Copy
    Range("H4").Select
    ActiveSheet.Paste
    Range("H4").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "='HIGH (29)'!RC[-4]"
    Range("G2").Select
    Range("H11").Select
    ActiveCell.FormulaR1C1 = "=COUNTIF(C[-3], ""<51"")"
    Range("H13").Select
    ActiveCell.FormulaR1C1 = "=COUNTIF(C[-3],""<100"")"
    Range("H15").Select
    ActiveCell.FormulaR1C1 = "=COUNTIF(C[-3],""<101"")"
    Range("H17").Select
     ActiveCell.FormulaR1C1 = "=COUNTIF(C[-3],""<151"")"
    LowDollarValueAddDesign
    Range("A20").Select
    Columns("G:G").EntireColumn.AutoFit
End Sub

Private Sub CreateAndConfigureSuccessChart()

    Range("AI1").Select
    ActiveCell.Formula2R1C1 = "=HITABLESUCCESS[Amount2]"
    Range("AJ1").Select
    ActiveCell.Formula2R1C1 = "=HITABLESUCCESS[Date]"
    Range("AI1:AJ1").Select
    Range(Selection, Selection.End(xlDown)).Select
    ActiveWindow.SmallScroll ToRight:=-22
    ActiveSheet.Shapes.AddChart2(227, xlLineStacked).Select
    ActiveChart.SetSourceData Source:=Range("'HIGH (29)'!$AI$1:$AJ$86")
    ActiveSheet.Shapes("Chart 1").IncrementLeft -157
    ActiveSheet.Shapes("Chart 1").IncrementTop -251
    ActiveSheet.Shapes("Chart 1").ScaleWidth 3.2458333333, msoFalse, _
        msoScaleFromTopLeft
    ActiveSheet.Shapes("Chart 1").ScaleHeight 3.462962963, msoFalse, _
        msoScaleFromTopLeft
    ActiveChart.ChartTitle.Select
    Selection.Delete
    ActiveSheet.ChartObjects("Chart 1").Activate
    ActiveSheet.Shapes("Chart 1").ScaleHeight 0.9946524064, msoFalse, _
        msoScaleFromBottomRight
    ActiveSheet.ChartObjects("Chart 1").Activate
    ActiveChart.PlotArea.Select
    Application.CutCopyMode = False
    Sheets("HISUCCESS").Select
    Range("Q3").Select
    ActiveWorkbook.Worksheets("HISUCCESS").ListObjects("HITABLESUCCESS").Sort. _
        SortFields.Clear
    ActiveWorkbook.Worksheets("HISUCCESS").ListObjects("HITABLESUCCESS").Sort. _
        SortFields.Add2 Key:=Range("HITABLESUCCESS[[#All],[ShortDate]]"), SortOn:= _
        xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("HISUCCESS").ListObjects("HITABLESUCCESS").Sort
        .Header = xlYes
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Sheets("HIGH (29)").Select
    ActiveChart.ChartArea.Select
    Range("U33").Select
    ActiveSheet.ChartObjects("Chart 1").Activate
    ActiveChart.PlotArea.Select
    ActiveChart.ChartArea.Select
    ActiveSheet.Shapes("Chart 1").ScaleWidth 0.9982884039, msoFalse, _
        msoScaleFromTopLeft
    ActiveSheet.Shapes("Chart 1").ScaleWidth 1.0128589799, msoFalse, _
        msoScaleFromTopLeft
End Sub
Private Sub RoundDollarValue()

    Dim lastRow As Long
    Dim lastCol As Long
    Dim dataRange As Range

    Sheets("DATA (5)").Select

    ' Find the last row and last column with data in the worksheet
    lastRow = Sheets("DATA (5)").Cells(Sheets("DATA (5)").Rows.count, "A").End(xlUp).Row
    lastCol = Sheets("DATA (5)").Cells(1, Sheets("DATA (5)").Columns.count).End(xlToLeft).Column

    ' Set the data range based on the last row and last column
    Set dataRange = Sheets("DATA (5)").Range(Sheets("DATA (5)").Cells(1, 1), Sheets("DATA (5)").Cells(lastRow, lastCol))

    dataRange.Copy

    ' Add a table with the dynamic data range
    Sheets.Add After:=ActiveSheet
    ActiveSheet.Paste
    ActiveSheet.name = "ROUNDSUCCESS"

    lastRow = ActiveSheet.Cells(ActiveSheet.Rows.count, "A").End(xlUp).Row
    lastCol = ActiveSheet.Cells(1, ActiveSheet.Columns.count).End(xlToLeft).Column

    Set dataRange = ActiveSheet.Range(ActiveSheet.Cells(1, 1), ActiveSheet.Cells(lastRow, lastCol))

    Dim tblExists As Boolean
    Dim WS_Count As Integer
    Dim i As Integer
    Dim name As String

    tblExists = False
    WS_Count = ActiveWorkbook.Worksheets.count

For i = 1 To WS_Count
        For Each O In Sheets(i).ListObjects
            If O.name = "ROUNDTABLE10" Or O.name = "ROUNDTABLE8" Or O.name = "ROUNDTABLE9" Or O.name = "ROUNDTABLE11" Or O.name = "RAWTABLE510" Or O.name = "RAWTABLE59" Or O.name = "RAWTABLE58" Then
                tblExists = True
                name = O.name
            End If
        Next O
    Next i

    If (tblExists) Then
        If name = "ROUNDTABLE8" Then
            Sheets("ROUNDSUCCESS").ListObjects("ROUNDTABLE8").Unlist
        End If
        If name = "ROUNDTABLE9" Then
            Sheets("ROUNDSUCCESS").ListObjects("ROUNDTABLE9").Unlist
        End If
        If name = "ROUNDTABLE7" Then
            Sheets("ROUNDSUCCESS").ListObjects("ROUNDTABLE7").Unlist
        End If
        If name = "ROUNDTABLE10" Then
            Sheets("ROUNDSUCCESS").ListObjects("ROUNDTABLE10").Unlist
        End If
        If name = "ROUNDTABLE11" Then
            Sheets("ROUNDSUCCESS").ListObjects("ROUNDTABLE11").Unlist
        End If
        If name = "RAWTABLE510" Then
            Sheets("ROUNDSUCCESS").ListObjects("RAWTABLE510").Unlist
        End If
      If name = "RAWTABLE59" Then
            Sheets("ROUNDSUCCESS").ListObjects("RAWTABLE59").Unlist
        End If
        If name = "RAWTABLE58" Then
            Sheets("ROUNDSUCCESS").ListObjects("RAWTABLE58").Unlist
        End If

        Sheets("ROUNDSUCCESS").ListObjects.Add(xlSrcRange, dataRange, , xlYes).name = "ROUNDTABLE10"
    Else
        Sheets("ROUNDSUCCESS").ListObjects.Add(xlSrcRange, dataRange, , xlYes).name = "ROUNDTABLE10"
    End If


    Sheets.Add After:=ActiveSheet
    ActiveSheet.name = "ROUND (34)"
    Sheets("ROUND (34)").Select
    Range("C4").Select
    ActiveCell.Formula2R1C1 = "=ROUNDTABLE10[Amount2]"
    Range("D4").Select
    ActiveCell.Formula2R1C1 = "=ROUNDTABLE10[Status]"
    Range("D5").Select
    Columns("D:D").EntireColumn.AutoFit
    Range("E3").Select
    ActiveCell.FormulaR1C1 = "BACKEND STATUS"
    Range("E4").Select
    ActiveCell.Formula2R1C1 = "=ROUNDTABLE10[Backend Status]"
    Range("F4").Select
    ActiveCell.Formula2R1C1 = "=ROUNDTABLE10[Round Identity]"
    Range("C:C,E:E").Select
    Range("E1").Activate
    Selection.NumberFormat = "General"
    Range("C3").Select
    ActiveCell.FormulaR1C1 = "AMOUNT"
    Range("D3").Select
    ActiveCell.FormulaR1C1 = "STATUS"
    Range("F3").Select
    ActiveCell.FormulaR1C1 = "ROUND IDENTITY"
    Range("G6").Select
    Columns("E:E").EntireColumn.AutoFit
    Columns("C:E").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
        .MergeCells = False
    End With

    Selection.NumberFormat = "0.00"
    Columns("C:E").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("F3:F1048576").Select
    Selection.NumberFormat = "0.00"
    Range("C1:E2").Select
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With

    Columns("G:G").Select
    Columns("F:F").EntireColumn.AutoFit
    Range("H10").Select
    ActiveCell.FormulaR1C1 = "ROUND COUNT:"
    Columns("H:H").Select
    Columns("H:H").EntireColumn.AutoFit
    Range("I10").Select
    ActiveCell.FormulaR1C1 = "=COUNT(C[-3],""=0.00"")"
    Range("E4").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range("H20").Select
    ActiveCell.FormulaR1C1 = "TOTAL TRANSACTIONS:"
    Columns("L:L").Select
    Columns("K:K").EntireColumn.AutoFit
    Range("I20").Select
    ActiveCell.FormulaR1C1 = "=COUNTA(RAWTABLE[Amount])"
    Range("C3:F3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 15773696
    End With
    Range("F2,H10,H20, H15, I14").Select
    Range("H20").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 15773696
    End With
    Range("I10,I20").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
    End With
    Range("C:E,F:F,H:H,I:I,K:K,L:L").Select
    Range("H25").Activate
    With Selection.Font
        .name = "Calibri"
        .Size = 14
        .Color = -16777216
    End With
    Range("G2").Select
     Range("G2").FormulaR1C1 = _
        "=IF(R[13]C[2]>49.99,TRUE,""SKIP RFI"")"

    Range("G2").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=G2=""X-MARK"""
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With
    Selection.FormatConditions(1).StopIfTrue = False

    Range("C3:F3").Select
    Selection.AutoFilter
    Range("I14").FormulaR1C1 = "50%"
    Range("I14").Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Selection.Font.Size = 18
    Selection.Font.Bold = True

    Range("H15").Value = "Round Percentage of All Transactions"

    Range("I15").FormulaR1C1 = "=IF(R[-5]C>2,R[-5]C/R[5]C*100,0)"
    Range("I15").Select
    Selection.NumberFormat = "0.00"
    Selection.Font.Size = 18
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=I15<=49.99"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:="=I15>=50"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = vbRed
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = vbBlack
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Range("J2").Select

    Range("C:E,F:F,H:H,I:I,K:K,L:L").EntireColumn.AutoFit

    Range("F3:F2048").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("D4:D12006,E4:E2006").Select
    Range("E4").Activate
    With Selection.Font
        .Color = -11489280
    End With
    Columns("G:H").EntireColumn.AutoFit
    Range("C1:F2").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("E20").Select
End Sub
Private Sub HIDESHEETS()

    Sheets("ROUND (34)").Visible = False
    Sheets("LOW (32)").Visible = False
    Sheets("MULTIPLE (31)").Visible = False
    Sheets("DATA (5)").Visible = False
    Sheets("DATA (3)").Visible = False
    Sheets("DATA (4)").Visible = False
    Sheets("HISUCCESS").Visible = False
    Sheets("LOWSUCCESS").Visible = False
    Sheets("ROUNDSUCCESS").Visible = False
End Sub


Private Sub ARRANGEMENT()

    Sheets("Dashboard").Select
    Sheets("Dashboard").Move Before:=Sheets(2)
    Sheets("DATA (2)").Select
    Sheets("DATA (2)").Move Before:=Sheets(6)
    Sheets("Status N Memos (24-26)").Select
    Sheets("Status N Memos (24-26)").Move Before:=Sheets(2)
    Sheets("Status N Memos (24-26)").Select
    Sheets("Status N Memos (24-26)").name = "STATUS & MEMOS (24-26_40-43)"
    Sheets("RAPID (27)").Select
    Sheets("RAPID (27)").Move Before:=Sheets(8)
    Sheets("HIGH (29)").Select
    Sheets("HIGH (29)").Move Before:=Sheets(10)
    HIDESHEETCONDITIONING
End Sub
Private Sub HIDESHEETCONDITIONING()

    If Worksheets("Dashboard").Range("D31").Value = " " Then
        Worksheets("MULTIPLE (31)").Visible = True
        Sheets("MULTIPLE (31)").Move Before:=Sheets(8)
    With ActiveWorkbook.Sheets("MULTIPLE (31)").Tab
        .ThemeColor = xlThemeColorAccent5
    End With
    End If
End Sub
Private Sub LowDollarValueAddDesign()


    Range("G4").Select
    ActiveCell.FormulaR1C1 = "Highest Dollar Value:"
    Range("H4").Select
    ActiveCell.FormulaR1C1 = "=MAX(C[-3])"
    Range("H4").Select
    With Selection.Font
        .name = "Calibri"
        .Size = 15
        .Color = -16777216
    End With

    Range("H5").FormulaR1C1 = "=COUNTA(RAWTABLE[Amount])"
    Range("H10").FormulaR1C1 = "=IF(R[1]C>2,R[1]C/R[-5]C*100,0)"
    Range("H12").FormulaR1C1 = "=IF(R[1]C>2,R[1]C/R[-7]C*100,0)"
    Range("H14").FormulaR1C1 = "=IF(R[1]C>2,R[1]C/R[-9]C*100,0)"
    Range("H16").FormulaR1C1 = "=IF(R[1]C>2,R[1]C/R[-11]C*100,0)"
    Range("K14").FormulaR1C1 = _
        "=IF(R[-10]C[-3]>2999, IF(R[3]C[-3]>2,R[3]C[-3]/R[-9]C[-3]*100,0), IF(AND(R[-10]C[-3]>999, R[-10]C[-3]<3000), IF(R[1]C[-3]>2,R[1]C[-3]/R[-9]C[-3]*100,0), IF(AND(R[-10]C[-3]>500, R[-10]C[-3]<1000), IF(R[-1]C[-3]>2,R[-1]C[-3]/R[-9]C[-3]*100,0), IF(R[-10]C[-3]<501, IF(R[-3]C[-3]>2,R[-3]C[-3]/R[-9]C[-3]*100,0), "" "") ) ) )"
    Range("J14").Select
    Selection.Font.Size = 20
    ActiveCell.FormulaR1C1 = "40%"
    Range("K14").Select
    Application.CutCopyMode = False

    Range("J14").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.Font.Size = 22
    Selection.Font.Bold = True
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 8248319
    End With

    Range("H10,H12,H14, H16,K14").Select
    Selection.NumberFormat = "0.00"
    Selection.Font.Size = 22
    Range("H10,H12,H14, H16,k14").Select
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _
        Formula1:="=40"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
      With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Range("H10,H12,H14,H16,K14").Select
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, Formula1:="=39.99"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
   With Selection.FormatConditions(1).Font
        .Color = vbRed
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = vbBlack
    End With
     Range("C1:F2").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone

End Sub

Sub tabcolors()

    Sheets("Dashboard").Select
    With ActiveWorkbook.Sheets("Dashboard").Tab
        .ThemeColor = xlThemeColorAccent2
    End With
    Sheets("RAPID (27)").Select
    With ActiveWorkbook.Sheets("RAPID (27)").Tab
            .ThemeColor = xlThemeColorLight2
    End With
    Sheets("HIGH (29)").Select
    With ActiveWorkbook.Sheets("HIGH (29)").Tab
        .Color = 65535
    End With
        Sheets("DATA (2)").Select
    With ActiveWorkbook.Sheets("DATA (2)").Tab
        .ThemeColor = xlThemeColorAccent6
    End With
    With ActiveWorkbook.Sheets("OUTM_Receiver").Tab
        .ThemeColor = xlThemeColorAccent4
    End With
    With ActiveWorkbook.Sheets("OUTM_Sender").Tab
        .ThemeColor = xlThemeColorAccent4
    End With

End Sub

Sub HighDifference()
   Range("I3").Select
    ActiveCell.FormulaR1C1 = "SPIKE!"
    Range("I4").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=RC[-5]-R[1]C[-5]"
    Range("I4").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.149998474074526
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Font.Size = 16
    Range("I3").Select
    Selection.Font.Size = 12
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight2
        .TintAndShade = 0.599993896298105
    End With


    Range("L3").FormulaR1C1 = _
        "=IFERROR(SUMIFS(R[1]C[-8]:R[497]C[-8], R[1]C[-10]:R[497]C[-10], ""*S: Canceled Chargeback*""),"" "")"
    Range("L4").FormulaR1C1 = _
         "=IFERROR(MAXIFS(RC[-8]:R[496]C[-8], RC[-10]:R[496]C[-10], ""*S: Canceled Customer Service*""),"" "")"
    Columns("K:K").ColumnWidth = 38
    Range("K3").Value = "TOTAL CHARGEBACK AMOUNT:"
    Range("K4").Value = "HIGHEST REFUND TRANSACTION AMOUNT:"
    Range("K3:L4").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("K3:K4").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 14857357
    End With
    Range("L3:L4").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 14342874
    End With
    Range("K3:K4").Select
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With


End Sub

Sub transpose()

Range("D5:D74").Select
Selection.Copy
Workbooks.Open "/Users/jamagom/Desktop/TM_AHT_TRACKER.xlsm"
t = Range("J2").Value
t = t - 1
 Range("v" & t).Select
    ActiveCell.PasteSpecial Paste:=xlPasteValues, transpose:=True
End Sub

Sub ZIPCODEFINDER()
'
    Range("J44").Select
    ActiveCell.FormulaR1C1 = "ENTER ZIP CODE:"
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
    End With
  Range("K44").Select
    ActiveCell.FormulaR1C1 = "SEARCH"
    Range("K44").Select
      With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With
     Range("J44:K47").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With
    Range("J47:K47").Select
    Selection.Merge
    ActiveCell.Formula2R1C1 = _
    "=IFERROR(" & Chr(10) & _
    "    ""This zip code is located in: "" &" & Chr(10) & _
    "    TEXTJOIN("", "", TRUE, FILTER(ZIPCODE.xlsx!R200C2:R41000C2, ZIPCODE.xlsx!R200C1:R41000C1 = R[-3]C[1]))," & Chr(10) & _
    "    ""ENTER ZIP CODE""" & Chr(10) & _
    ")"

'    ActiveCell.Formula2R1C1 = _
'        "=IFERROR(" & Chr(10) & "    ""This zip code is located in: "" &" & Chr(10) & "    TEXTJOIN("", "", TRUE, FILTER(ZIPCODE.xlsx!R200C2:R41000C2, ISNUMBER(SEARCH(R[-3]C[1], ZIPCODE.xlsx!R200C1:R41000C1))))," & Chr(10) & "    ""ENTER ZIP CODE""" & Chr(10) & ")"
    Selection.Font.Size = 14
    Selection.FormatConditions.Add Type:=xlTextString, String:="This", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternThemeColor = xlThemeColorAccent5
        .Color = 49407
        .PatternTintAndShade = 0.599963377788629
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Range("J44:K44").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With


End Sub

Sub Search()
   Columns("AB:AD").ColumnWidth = 65
    Range("AB1:AD3").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    Range("AC2").Select
    Selection.RowHeight = 30
    Selection.Font.Size = 22
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
  With Selection.Interior
.Pattern = xlSolid
.PatternColorIndex = xlAutomatic
.ColorIndex = 1  ' White
End With
    ActiveCell.FormulaR1C1 = "SEARCH"
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.249977111117893
    End With
    Range("AB1:AD4").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 16751412
    End With

    Range("AB7").Select
    ActiveCell.FormulaR1C1 = "QUESTIONS"
    Range("AC7").Select
    ActiveCell.FormulaR1C1 = "ANSWERS"
    Range("AD7").Select
    ActiveCell.FormulaR1C1 = "EXAMPLES"
    Range("AB7:AD7").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Selection.Font.Size = 12
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorLight1
    End With
    Range("AB8").Select
    ActiveCell.Formula2R1C1 = _
        "=IF(COUNTA(ZIPCODE.xlsx!R[-6]C[-20]:R[42992]C[-20]) = 0," & Chr(10) & "    """"," & Chr(10) & "    IFERROR(" & Chr(10) & "        FILTER(ZIPCODE.xlsx!R[-6]C[-20]:R[42992]C[-18], ISNUMBER(SEARCH(R[-6]C[1], ZIPCODE.xlsx!R[-6]C[-20]:R[42992]C[-20])))," & Chr(10) & "        ""DATA NOT FOUND""" & Chr(10) & "    )" & Chr(10) & ")"
    Range("AB8:AD24").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    Range("AB8:AD23").Select
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _
        Formula1:="=1"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    Range("AB8:AB24").Select
    With Selection
        .HorizontalAlignment = xlLeft
    End With
    Range("AC2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("AB4:AD4").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("B7").Select
    Cells.FormatConditions.Delete
    Range("E37").Select

    
End Sub
Sub Macro2()
  Range("B6:H11").Select
    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _
        "=ISBLANK($B8)"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16383844
        .TintAndShade = 0
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13551615
        .TintAndShade = 0
    End With

    
    

    Range("E28").Select
End Sub


Sub newdashboard()

AddConditionChargeback
MemoCount

 Range("D5:D74").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .Color = 15983577
    End With
    Range("A1:D1").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    Range("A1:D1").Select
    ActiveCell.FormulaR1C1 = _
        "Please read Instructions Tab Before Filling Out Sheet"
    Range("A1:D1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = -0.249977111117893
    End With
    Range("A1:D1").Select
    Selection.Font.Bold = True
    Range("A2:D3").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    Range("A2:D3").Select
    ActiveCell.FormulaR1C1 = _
        "*Additions and revisions resulting from unified and Novi SAR Matrix highlighted in yellow."
    Range("A4").Select
    Columns("A:A").ColumnWidth = 14.33
    Columns("B:B").ColumnWidth = 21.17
    Columns("C:C").ColumnWidth = 75
    Range("A2:D3").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Rows("4:4").RowHeight = 29
    Range("A4:D4").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Selection.Font.Bold = True
    Range("A4").Select
    ActiveCell.FormulaR1C1 = "Widget"
    Range("A4").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Range("B4").Select
    ActiveCell.FormulaR1C1 = "Category"
    Range("B4").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Range("C4").Select
    ActiveCell.FormulaR1C1 = "Red Flag Indicator"
    Range("C4").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Range("D4").Select
    ActiveCell.FormulaR1C1 = "RFI Found"
    Range("D4").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Range("A5:A16").Select
    Selection.Merge True
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    Range("A5:A16").Select
    ActiveCell.FormulaR1C1 = "User Information"
    Range("B5").Select
    ActiveCell.FormulaR1C1 = "Trigger Reason"
    Range("B6").Select
    ActiveCell.FormulaR1C1 = "Payments Disabled"
    Range("B7").Select
    ActiveCell.FormulaR1C1 = "Payments Disabled"
    Range("B8").Select
    ActiveCell.FormulaR1C1 = "Profile Authenticity"
    Range("B9").Select
    ActiveCell.FormulaR1C1 = "Profile Authenticity"
    Range("B10").Select
    ActiveCell.FormulaR1C1 = "Profile Authenticity"
    Range("B11").Select
    ActiveCell.FormulaR1C1 = "Profile Authenticity"
    Range("B12").Select
    ActiveCell.FormulaR1C1 = "Profile Authenticity"
    Range("B13").Select
    ActiveCell.FormulaR1C1 = "Profile Authenticity"
    Range("B14").Select
    ActiveCell.FormulaR1C1 = "Profile Authenticity"
    Range("B15").Select
    ActiveCell.FormulaR1C1 = "Profile Information"
    Range("B16").Select
    ActiveCell.FormulaR1C1 = "Profile Information"
    Range("B45").Select
    ActiveCell.FormulaR1C1 = "*Financial instrument block listed"
    Range("B46").Select
    ActiveCell.FormulaR1C1 = "*Cardholder name or PayPal account information does not match actual User name/Idology name."
     Range("B47:B48").Select
    ActiveCell.FormulaR1C1 = "Location Info"
    Range("B49").Select
    ActiveCell.FormulaR1C1 = "Card Sharing"
    Range("B50").Select
    ActiveCell.FormulaR1C1 = "Added Cards"
     Range("B51").Select
    ActiveCell.FormulaR1C1 = "Existing Card"
    Range("B52").Select
    ActiveCell.FormulaR1C1 = "Total Number of Cards"
    Range("B55").Select
     ActiveCell.FormulaR1C1 = " Changes in IP addresses"
    Range("B56").Select
         ActiveCell.FormulaR1C1 = "Multiple devices"
    Range("B57").Select
         ActiveCell.FormulaR1C1 = "Log in Attempts"
    Range("B58").Select
    ActiveCell.FormulaR1C1 = "IP Location"
     Range("B61").Select
    ActiveCell.FormulaR1C1 = "Sending to each other"
     Range("B62").Select
    ActiveCell.FormulaR1C1 = "Card Sharing"
     Range("B63").Select
    ActiveCell.FormulaR1C1 = "Other"
    Range("B65").Select
    ActiveCell.FormulaR1C1 = "Photos/Posts/Pages/" & vbCrLf & _
    "Groups """
    Range("B66").Select
   ActiveCell.FormulaR1C1 = "Photos/Posts/Pages/" & vbCrLf & _
    "Groups """
    Range("B67").Select
  ActiveCell.FormulaR1C1 = "Photos/Posts/Pages/" & vbCrLf & _
    "Groups """
      Range("B69").Select
    ActiveCell.FormulaR1C1 = "Risk notes/tag " & vbCrLf & _
    "present/Sigma " & vbCrLf & _
    "Automation"
    Range("B70").Select
    ActiveCell.FormulaR1C1 = "Other Facebook" & vbCrLf & _
    "XFN Note"
    Range("B71").Select
    ActiveCell.FormulaR1C1 = "Support Case"
    Range("B72").Select
    ActiveCell.FormulaR1C1 = "Changes of Profile" & vbCrLf & _
    "Information -"
    Range("C5").Select
    ActiveCell.FormulaR1C1 = "Case Triggered for SFI"
    Range("C6").Select
    ActiveCell.FormulaR1C1 = "* Payments Disabled by PayCom"
    Range("C7").Select
    ActiveCell.FormulaR1C1 = "*Payments Disabled by Risk"
    Range("C8").Select
    ActiveCell.FormulaR1C1 = "* User Name vs. Old name mismatch"
    Range("C9").Select
    ActiveCell.FormulaR1C1 = "* FAI Score > 0.5"
    Range("C10").Select
    ActiveCell.FormulaR1C1 = _
        "*No personal profile photos (of the user) including review of previous Profile Photos Album in User Albums."
    Rows("10:10").Select
    Range("B10").Activate
    Selection.RowHeight = 80
    Range("C10").Select
     ActiveCell.FormulaR1C1 = _
    "*No personal profile photos (of the user) including review of previous Profile Photos Album" & vbCrLf & _
    "in User Albums. (Note: Inauthentic Photos include: Animals, Animations/Cartoons," & vbCrLf & _
    "or where the User's face is obscured/unidentifiable by fillers/physical objects)" & vbCrLf & _
    "(Note: Analyst should have at least two photos used for comparison when determining whether the user's" & vbCrLf & _
    "photo is authentic)"
    Range("C11").Select
    ActiveCell.FormulaR1C1 = "*Account created <30 days ago"
    Range("C12").Select
    ActiveCell.FormulaR1C1 = "*Low Friend Count (eg.<10)"
    Range("C13").Select
    ActiveCell.FormulaR1C1 = _
        "*Number of days on FB vs Active days (High ratio of days on FB vs Active)"
    Range("C14").Select
    Rows("14:14").RowHeight = 35
    Range("C14").Select
    ActiveCell.FormulaR1C1 = _
        "*Fake Age(If the user's profile photo suggest that they are under 18)even though the profile says " & vbCrLf & _
        "the user is  18 or older (Birth date may be changed to appear over 18)"
    Range("C15").Select
    ActiveCell.FormulaR1C1 = "*User Profile zipcode is in high risk zipcode"
    Rows("16:16").Select
    Range("B16").Activate
    Selection.RowHeight = 40
    Range("C16").Select
    ActiveCell.FormulaR1C1 = _
        "*Other " & vbCrLf & _
        "-Does not appear to reflect an authentic person " & vbCrLf & _
        "-Activity log indicates that profile updates were conducted by another User"
    Range("C5,C6,C7,C27,C28,C29,C37,C38,C39,C40,C41,C42,C45,C46,C47,C48,C49,C58,C70,C74,A74,B74").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 288502
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("A17:D17").Select
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .Color = 288502
        End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
    Range("A19:D19").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
    Range("A18").Select
    ActiveCell.FormulaR1C1 = "Alerts"
    Range("A18").Select
    Selection.Font.Bold = True
    Selection.Font.Size = 18
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Range("B18").Select
    ActiveCell.FormulaR1C1 = "Alert History"
    Range("B18").Select
    Selection.Font.Size = 14
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Range("C18").Select
    ActiveCell.FormulaR1C1 = _
        "*User has ""Active"" alert in investigation at L1-L3 level"
    Range("C18").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 288502
    End With
    Range("D5:D23").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
   
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("C5,C6,C7,C27,C28,C29,C37,C38,C39,C40,C41,C42,C45,C46,C47,C48,C49,C58,C70,C74,A74,B74").Select
    Selection.Font.Bold = True
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Range("C18").Select
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Range("B5:B16").Select
    Selection.Font.Bold = True
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlTop
        .ReadingOrder = xlContext
    End With
    Range("A5:A16").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .Orientation = 90
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Selection.Font.Size = 22
    Selection.Font.Bold = True
    Range("B5:C16").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous

        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With

End Sub


Sub AdjustRowHeight()
    Range("A1").RowHeight = 15
    Range("B5:B9").RowHeight = 15
    Range("B11:B12").RowHeight = 15
     Range("B15").RowHeight = 15
     Range("B5:B9").RowHeight = 15
    Range("B10").RowHeight = 85
    Range("B16").RowHeight = 50
    Range("B20:B22").RowHeight = 25
    Range("B29").RowHeight = 110
    Range("B30:B31").RowHeight = 25
    Range("B40").RowHeight = 100
    Range("B52").RowHeight = 25
    Range("B61").RowHeight = 25
    Range("B72").RowHeight = 25
    Range("B71").RowHeight = 95
    
    
        
End Sub

Sub RFISheetColumnCDesign()

    Range("C5:C7").Select
    Selection.Font.Bold = True
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Range("B74").Select
    Selection.Font.Bold = True
    Selection.Value = "Other"
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlTop
    End With
    Range("C18").Select
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("B5:B16").Select
    Selection.Font.Bold = True
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlTop
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Range("A5:A16").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .Orientation = 90
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Selection.Font.Size = 22
    Selection.Font.Bold = True
    Range("B5:C16").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With

End Sub
Sub RFIAutoMark()
'
' rfiauto Macro
'

'

    Range("A20:A22").Select
    ActiveCell.FormulaR1C1 = "Identity" & vbCrLf & _
    "Verification" & vbCrLf & _
    "Check"
     Range("A24:A43").Select
       ActiveCell.FormulaR1C1 = "Transactions"
    Range("A45:A53").Select
       ActiveCell.FormulaR1C1 = "Financial Instrument Info"
    Range("A55:A59").Select
       ActiveCell.FormulaR1C1 = "IP Information"
    Range("A61:A63").Select
       ActiveCell.FormulaR1C1 = "Possible" & vbCrLf & _
       "Account" & vbCrLf & _
       "Matches "
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    With Selection.Font
        .name = "Calibri"
        .Size = 20
        .Underline = xlUnderlineStyleNone
        .Color = -16777216
        .ThemeFont = xlThemeFontNone
    End With
    Selection.Font.Bold = True

    Range("A65:A67").Select
       ActiveCell.FormulaR1C1 = "User Timeline | User Albums | Admined Pages" & vbCrLf & _
      "Admined Groups | User Group Membership List"
    Range("A69:A73").Select
       ActiveCell.FormulaR1C1 = "Account Action Notes"

    Range("B20").Select
    ActiveCell.FormulaR1C1 = "Mismatch Card/Profile name"
    Range("B21:B22").Value = "Failed Checks"
     Range("C29").Value = "*Unusual High Value Transactions. For example:" & vbCrLf & _
       "-$500 or recurring amounts over short period of time" & vbCrLf & _
       "-Transaction at one amount was cancelled (e.g., $2000) and subsequent transactions same day attempted at" & vbCrLf & _
       "differing amounts (e.g., $1500, $1000) with no memos indicating normal activity (Both)"
    Range("C28").Value = "*Unusual Circular Movement"
    Range("C27").Value = "* Unusual Rapid movement of funds - Rapid spending within a short time frame including attempted and " & vbCrLf & _
"successfully completed transactions. For example:" & vbCrLf & _
"-5 or more attempted transactions conducted within 5 minutes "
     Range("C30").Value = "Unable to determine the ultimate purpose of the transactions and is inconsistent with normal, personal activity. "
     Range("C31").Value = " Multiple Small/Similar Amounts -  Multiple transactions of smaller/similar amounts, i.e. 4 x $250 transactions"
     Range("C32").Value = "Low dollar value but high frequency/volume of transactions"
     Range("C33").Value = "Minimal transactional activity"
     Range("C34").Value = "Round dollar amounts"
     Range("C35").Value = "*Low social signals:  Low social signals between the sender/receiver or suspicious counterparties OR" & vbCrLf & _
"sender/receiver relationship ceases once the receiver has received the funds (i.e. Receiver blocks the sender)"
    Range("C36").Value = "* Strong social signals:  Strong social signals between users (mutual friends, days as friends, shared IPs, " & vbCrLf & _
"many same gender friends, etc)"
    Range("C37").Value = "* One user to many users: One receiver to many different senders or one sender to many different receivers " & vbCrLf & _
"indicating suspicious activity or vice versa For example:" & vbCrLf & _
"-5 or more transactions from more than one user, with same/similar dollar value AND memos do not indicate" & vbCrLf & _
"normal activity "
Range("C38").Value = "*Prostitution/Adult Exploitation/CEI Sender and receiver show patterns in User info indicating" & vbCrLf & _
"prostitution/exploitation (older male transacts commonly with younger females, female transacts with many" & vbCrLf & _
"men, look for significant age gaps between the sender and receiver etc.)"
Range("C39").Value = "*Terrorism " & vbCrLf & _
"- Transactions include/relate to identified suspects/victims"
Range("C40").Value = "* Multiple Sent Chargebacks: High count/ratio of Chargebacks For example:" & vbCrLf & _
"- 3 or more chargebacks in review period or 25% were CB or over $2000. Victim discovered the transactions " & vbCrLf & _
"were made and requested the funds to be returned through their card carrier or User committing OR user" & vbCrLf & _
"committing chargeback fraud."
Range("C41").Value = "*Multiple Sent Refunds: High count/ratio of Refunds." & vbCrLf & _
"- 3 or more Refunds in review period or $2000."
Range("C42").Value = "*Multiple Sent Failed Attempts: High count of Failed Attempts/Failed Payment Requests. For exmaple:" & vbCrLf & _
"- 3 or more transactions with status indicating they were cancelled by Risk)"
Range("A17:D17").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
    With Range("A19:D19").Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
Range("A44,b44,c44,D44").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
Range("C45").Value = "*Financial instrument block listed"
Range("C46").Value = "*Cardholder name or PayPal account information does not match actual User name/Idology name."
Range("C47").Value = " Cardholder location does not match User's profile information. For example:" & vbCrLf & _
"-2 or more financial instruments on account where at least one of the zip codes does not match the User's" & vbCrLf & _
"Home Location or Current Location per "User Information"
Range("C48").Value = "*Financial instruments tied to multiple zip codes or locations that appear unusual,especially from high-risk " & vbCrLf & _
"jurisdictions"
Range("C49").Value = "*Duplicate accounts are card sharing" & vbCrLf & _
"*Card sharing with multiple Users who are not friends or have no mutual friends"
Range("C50").Value = "* Unusual FIs added to Account when the suspected activity occurred. For example:" & vbCrLf & _
"- 3 or more card load attempts in 1 week (different cards)"
Range("C51").Value = "* Unusual use of existing cards when the suspected activity occurred. For example:" & vbCrLf & _
"-Existing card is all of a sudden sending to a newly added FI" & vbCrLf & _
"-Sudden surge in use of exisiting card"
Range("C52").Value = "*Unusual volume of active or attempted added financial instruments on the account. (eg. 4 or more Fis)"
Range("C53").Value = "*Other (please specify)"

Range("A54:D54").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
Range("C55").Value = "*Changes in home or current location around date and time of unusual activity, IP addresses are listed as " & vbCrLf & _
"SUSPICIOUS HIGH PROBABILITY, and cannot confirm normal activity (i.e traveling)" & vbCrLf & _
"*Rapid changes in the IP address location and potential patterns (E.g. Changes from coast to coast within " & vbCrLf & _
"the US, such as New York to Los Angeles)"
Range("C56").Value = "*Use of multiple devices"
Range("C57").Value = "*Unusual Action notes such as Password change, Login, New device added, Name change, Email change," & vbCrLf & _
"Payments in Messenger transaction, Credit Card/Coupon Action: Save Credit Card, Attempted Adding CC," & vbCrLf & _
"Password Mismatch "
Range("C58").Value = "Sender or receiver location tied to offshore jurisdictions known for tax-friendly regulations"
Range("C59").Value = "*Other (Inconsistencies/gaps & high-risk):" & vbCrLf & _
"- Gaps in IP data" & vbCrLf & _
"- Inconsistent location information/international or high risk area IPs "
Range("A60:D60").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
Range("C61").Value = "*Rapid same day attempted transactions between duplicate accounts"
Range("C62").Value = "* Duplicate accounts are card sharing"
Range("C63").Value = "*Other (please specify)"
Range("A64:D64").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With

    Range("C65").Value = "Most Common Typologies" & vbCrLf & _
"Photos, posts, pages, or groups referencing keywords and emojis related to:" & vbCrLf & _
"PLEASE SPECIFY LIST FROM LIST BELOW:" & vbCrLf & _
"- ATO" & vbCrLf & _
"- Gambling - Game of Chance" & vbCrLf & _
"- Fraud Scam/Scheme" & vbCrLf & _
"- Gambling - Game of Skill" & vbCrLf & _
"- Multiple Accounts"
Range("C66").Value = "High Risk Typologies" & vbCrLf & _
"Photos, posts, pages, or groups referencing keywords and emojis related to:" & vbCrLf & _
"PLEASE SPECIFY LIST FROM LIST BELOW:" & vbCrLf & _
"- Adult Exploitation (e.g., human trafficking and human smuggling)" & vbCrLf & _
"- Child Exploitation (e.g., child pornography, trafficking)" & vbCrLf & _
"- Drugs" & vbCrLf & _
"- Elder Abuse" & vbCrLf & _
"- Extortion/Sextortion" & vbCrLf & _
"- Firearms" & vbCrLf & _
"- Money Laundering (aiding and abetting)" & vbCrLf & _
"- Sanctions Hard Match" & vbCrLf & _
"- Unregistered MSB" & vbCrLf & _
"- Terrorism"
Range("C67").Value = "Other Photos/Posts/Pages/Groups:" & vbCrLf & _
"*Photos, posts, pages, or groups appear to indicate suspicious activity related to but not limited to:" & vbCrLf & _
"PLEASE SPECIFY LIST FROM LIST BELOW:" & vbCrLf & _
"- Illegal P2P Business Activity" & vbCrLf & _
"- Cybercrime (e.g., malware and hacking)" & vbCrLf & _
"- Exotic/wildlife sales" & vbCrLf & _
"- Prostitution" & vbCrLf & _
"* Posts, photos, groups, or pages confirming unusual activity. For example:" & vbCrLf & _
"-Profile photo appears inauthentic and inconsistent with normal facebook behavior" & vbCrLf & _
"-User had photos in albums, made any posts in any other group or page, is a member of a Facebook Group or " & vbCrLf & _
"groups admined appear to be related to suspected activity" & vbCrLf & _
"-lack of profile activity (posts, comments, photos, etc.)" & vbCrLf & _
"-Inconsistent profile activity (profile activity around the creation date of the profile does not match current " & vbCrLf & _
"activity such as photos posted, User information, posts, etc.) "
    Range("A68:D68").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With

    Range("C69").Value = "*Hacked lock/Compromised" & vbCrLf & _
   "Inauthentic/Fake"
     Range("C70").Value = "*Left on the User's account indicating unusual activity. For example:" & vbCrLf & _
"PLEASE SPECIFY LIST FROM LIST BELOW:" & vbCrLf & _
"-Codes or notes left by CO or Safety Teams in the Account Action Notes Section or Produced CEI Tag or Distributed CEI Tag, CEI Red Tag" & vbCrLf & _
"_ (Reach out to Safety Team to get code ratings)" & vbCrLf & _
"-Terrorism (Mere presence of the CEI and/or Terrorism tag does not warrant direct escalation. There must be content/txns related to tags." & vbCrLf & _
"-User banned from Marketplace" & vbCrLf & _
"-NCMEC REPORTER"
  Range("C71").Value = "*Unusual support cases submitted by the user related to the suspected activity" & vbCrLf & _
"*Support cases indicating User lost access/requesting help to regain access" & vbCrLf & _
 "*Support tickets logged by potential victims indicating paid for goods were not received"

   Range("C72").Value = "*Unusual attempts to change the profile information, potenitally jeopardizing the authenticity of the account"
   Range("C73").Value = "*Other"
   Range("C74").Value = "Check this box only in situations where there are additional red flags present in the case that are not" & vbCrLf & _
   "available on the existing RFI list and marked above in the sheet. Please document a rationale in the box" & vbCrLf & _
   "below highlighting all missing red flags and supporting why a manual override of the RFI Results Tab is" & vbCrLf & _
   "necessary and the case escalated." & vbCrLf & _
   "Manual Override Rationale: [INSERT RATIONALE]"

    Range("C20").Select
    ActiveCell.FormulaR1C1 = _
        "* Idology name significant mismatch from profile name or financial instrument information"
    Range("C21").Value = "* OFAC Check - did not pass*"
    Range("C22").Value = "*IDV Check Failed"
     Range("C23").Value = ""
    Range("A23:D23").Select
    With Selection.Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
Range("C24").Value = "Most Common Typologies" & vbCrLf & _
"Transaction memos referencing keywords and emojis related to:" & vbCrLf & _
"PLEASE SPECIFY LIST FROM LIST BELOW:" & vbCrLf & _
"- Gambling - Game of Chance" & vbCrLf & _
"- Fraud Scam/Scheme" & vbCrLf & _
"- Gambling - Game of Skill" & vbCrLf & _
"- Large Transactions" & vbCrLf & _
"- Multiple Accounts" & vbCrLf & _
"- Unusual Transactions" & vbCrLf & _
"Note: Transaction memo is an optional field. All guidance relating to transaction memos should also be " & vbCrLf & _
"applied to other user content to identify potentially unusual activity." & vbCrLf & _
"The same memo indicators outlined can be utilized in other widgets and/or content from the user. Examples" & vbCrLf & _
"include, but are not limited to:" & vbCrLf & _
"Posts" & vbCrLf & _
"Comments between users and/or transactional counterparties in Pages/Groups/Posts" & vbCrLf & _
"Marketplace Advertisements" & vbCrLf & _
"Group/Page Names" & vbCrLf & _
"Photos within the users albums and/or timeline posts" & vbCrLf & _
"Example: A user comment underneath a post asking for a ""spot"" in a ""rifa"" can be considered as evidence" & vbCrLf & _
"for Game of Chance activity. For more examples of keywords, please refer to the P2P Typology Guide under " & vbCrLf & _
"the applicable Typology(s)."
Range("C25").Value = "High Risk Typologies" & vbCrLf & _
"Transaction Memos referencing keywords and emojis related to:" & vbCrLf & _
"PLEASE SPECIFY LIST FROM LIST BELOW:" & vbCrLf & _
"- Adult Exploitation (e.g., human trafficking and human smuggling)" & vbCrLf & _
"- Child Exploitation (e.g., child pornography, trafficking)" & vbCrLf & _
"- Corruption and Bribery (e.g., commercial bribery, kleptocracy and foreign public corruption)" & vbCrLf & _
"- Drugs" & vbCrLf & _
"- Elder Abuse" & vbCrLf & _
"- Extortion/Sextortion" & vbCrLf & _
"- Firearms" & vbCrLf & _
"- Money Laundering (aiding and abetting)" & vbCrLf & _
"- Sanctions Hard Match" & vbCrLf & _
"- Unregistered MSB" & vbCrLf & _
"- Terrorism" & vbCrLf & _
"Note: Transaction memo is an optional field. All guidance relating to transaction memos should also be " & vbCrLf & _
"applied to other user content to identify potentially unusual activity." & vbCrLf & _
"The same memo indicators outlined can be utilized in other widgets and/or content from the user. Examples " & vbCrLf & _
"include, but are not limited to:" & vbCrLf & _
"Posts" & vbCrLf & _
"Comments between users and/or transactional counterparties in Pages/Groups/Posts" & vbCrLf & _
"Marketplace Advertisements Group/Page Names Photos within the users albums and/or timeline posts" & vbCrLf & _
 "Example: A user comment underneath a post asking for a spot in a rifa can be considered as evidence for" & vbCrLf & _
 "Game of Chance activity. For more examples of keywords, please refer to the P2P Typology Guide under the" & vbCrLf & _
 "applicable Typology(s)."
 Columns("C:C").AutoFit
 Range("C26").Value = "*Other Memos: " & vbCrLf & _
"- Transaction Memos appear to indicate suspicious activity related to but not limited to:" & vbCrLf & _
"PLEASE SPECIFY LIST FROM LIST BELOW:" & vbCrLf & _
"- Illegal P2P Business Activity" & vbCrLf & _
"- Cybercrime (e.g., malware and hacking)" & vbCrLf & _
"- Exotic/wildlife sales" & vbCrLf & _
"- Prostitution" & vbCrLf & _
"Note: Transaction memo is an optional field. All guidance relating to transaction memos should also be " & vbCrLf & _
"applied to other user content to identify potentially unusual activity." & vbCrLf & _
"The same memo indicators outlined can be utilized in other widgets and/or content from the user. Examples" & vbCrLf & _
"include, but are not limited to:" & vbCrLf & _
"Posts" & vbCrLf & _
"Comments between users and/or transactional counterparties in Pages/Groups/Posts" & vbCrLf & _
"Marketplace Advertisements" & vbCrLf & _
"Group/Page Names" & vbCrLf & _
"Photos within the users albums and/or timeline posts" & vbCrLf & _
"Example: A user comment underneath a post asking for a spot in a rifa can be considered as evidence" & vbCrLf & _
"for Game of Chance activity. For more examples of keywords, please refer to the P2P Typology Guide under" & vbCrLf & _
"the applicable Typology(s)."
Range("B24:B26").Value = "Memos"
Range("B27:B34").Value = "Patterns"
Range("B35:B39").Value = "Counterparties"
Range("B40:B42").Value = "Multiple" & vbCrLf & _
"CB / Refunds / Failed" & vbCrLf & _
"s"
Range("B43,B53,B73,B59,B63").Value = "*Other"

Range("C5:C74").Select
With Selection
        .VerticalAlignment = xlTop
 End With
    Sheets("Dashboard").Select
    Range("B5").Select
    ActiveCell.FormulaR1C1 = "Trigger Reason"
    Range("B5:B73").Select
    Selection.Font.Bold = True
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlTop
        .ReadingOrder = xlContext
    End With
End Sub

Sub HilightXMark()

    Range("D5:D74").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="X", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 48893
    End With

  ActiveWindow.DisplayHeadings = True
 ActiveWindow.DisplayGridlines = False
    Range("A1:D74").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    
    Range("D5:D74").Select
    With Selection
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .HorizontalAlignment = xlCenter
    End With
    Range("b5:b74").Select
      With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
         End With
End Sub

Sub RFISheetFirstColumnDesign()

    Range("A24:A43").Select
    Range("A43").Activate
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .Orientation = 90
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Selection.Font.Size = 28
    Selection.Font.Bold = True
    Range("A45:A53").Select
    Range("A53").Activate
    Selection.Merge
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .Orientation = 90
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Selection.Font.Size = 18
    Selection.Font.Bold = True
    Range("A55:A59").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .Orientation = 90
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Selection.Font.Size = 20
    Selection.Font.Bold = True
    Range("A65:A67").Select
    Range("A67").Activate
    Selection.Merge
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .Orientation = 90
        .ReadingOrder = xlContext
    End With
    Selection.Font.Size = 16
    Selection.Font.Bold = True
    Range("A69:A73").Select
    Range("A73").Activate
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .Orientation = 90
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Selection.Font.Size = 18
    Selection.Font.Bold = True
    Range("A24:A43").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .Orientation = 90
        .ReadingOrder = xlContext
    End With
    Range("A45:A53").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Range("A55:A59").Select
    Range("B74").Value = "OTHER"
        With Selection
        .VerticalAlignment = xlTop
        End With
End Sub
Sub StopLightNotesNGuidance()

    Range("J1:K2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
      End With
    Range("J2").Select
    Selection.Cut Destination:=Range("K2")
    Range("J1:K2").Select
    Columns("J:J").ColumnWidth = 15
    Columns("K:K").ColumnWidth = 22.83

    Selection.Merge
    ActiveCell.FormulaR1C1 = "NOTES AND GUIDANCE FOR" & vbCrLf & _
    "ESCALATING THE CASE"
     Range("J1:K2").Select
    Selection.Font.Size = 14
    Range("J9").Select
    ActiveCell.FormulaR1C1 = "UserContent"
    Range("J4").Select
    ActiveCell.FormulaR1C1 = "RFI 43"
    Range("J5:J6").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    Range("J5:J6").Select
    ActiveCell.FormulaR1C1 = "RFI 53"
    Range("J7:J8").Select
    Range("J8").Activate
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.Merge
  Range("J7:J8").Select
    ActiveCell.FormulaR1C1 = "RFI 73"
    Range("J10").Select
    ActiveCell.FormulaR1C1 = "ATO SCENARIO 1"
    Range("J11:J13").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    Range("J11").Select
    ActiveCell.FormulaR1C1 = "ATO SCENARIO 2"
    Range("J14").Select
    ActiveCell.FormulaR1C1 = "SFI"
    Range("J15").Select
    ActiveCell.FormulaR1C1 = "PAIR ANALYSIS"
    Range("J16").Select
    ActiveCell.FormulaR1C1 = "Chargeback"
    Range("J3:J16").Select
    Selection.Font.Size = 12
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Selection.InsertIndent 1
    Range("J4:J8").Select
    Range("J7").Activate
    Selection.InsertIndent 3
    Range("J14").Select
    Selection.InsertIndent 5
    Range("J1:K18").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("K4:K18").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Range("A1").Select
    End Sub
Sub AddConditionChargebackReversal()

    Range("K4").Select
    ActiveCell.Formula2R1C1 = _
        "=IFERROR(IFS(R[39]C4 = ""X"",""Chargeback Reversal""),"" "")"
    
    Range("K4").Select
    Selection.Font.Bold = True
    Selection.Font.Size = 14
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With
    Selection.FormatConditions.Add Type:=xlTextString, String:= _
        "Chargeback Reversal", TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False

    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    
End Sub

Sub AddConditionNonameZipcode()

    Range("K5:K6").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    Range("K5:K6").Select
    ActiveCell.Formula2R1C1 = _
        "=IFERROR(IFS(R[48]C[-7] = ""X"", ""NO NAME/ZIPCODE""),"" "")"
    Range("K5:K6").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="NO", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Range("K5:K6").Select
    Selection.Font.Bold = True
    Selection.Font.Size = 14
End Sub

Sub AddConditionEngagementAbuse()

    Range("K7:K8").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    Range("K7:K8").Select
    ActiveCell.Formula2R1C1 = _
        "=IFERROR(IFS(R[66]C[-7]=""X"",""ENGAGEMENT ABUSE""),"""")"
 Selection.FormatConditions.Add Type:=xlTextString, String:="ABUSE", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Range("K7:K8").Select
    Selection.Font.Bold = True
    Selection.Font.Size = 14

 
End Sub
Sub AddConditionATO1()

    Range("K10").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(IF(COUNTIF(R[55]C[-7],""x"") + COUNTIF(R[17]C[-7], ""x"")+COUNTIF(R[32]C[-7],""x"") + COUNTIF(R[30]C[-7], ""x"")+ COUNTIF(R[39]C[-7],""x"") +COUNTIF(R[37]C[-7], ""x"") + COUNTIF(R[45]C[-7],""x"")+ COUNTIF(R[47]C[-7], ""x"")>=4,""ESCALATE FOR ATO"","" ""),"" "")"
    Selection.FormatConditions.Add Type:=xlTextString, String:="ATO", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
     With Selection
        .HorizontalAlignment = xlCenter
       .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Font.Bold = True
    Selection.Font.Size = 14
 
 
  
End Sub
Sub AddConditionATO2()

     Range("K12").Select
    ActiveCell.FormulaR1C1 = _
   "=IFERROR(IF(OR(COUNTIF(R[-6]C[-7]:R[-5]C[-7], ""X""))+COUNTIF(R[15]C[-7],""X"")+COUNTIF(R[-7]C[-7],""X"")+COUNTIF(R[28]C[-7],""X"")+COUNTIF(R[33]C[-7],""X"")+COUNTIF(R[57]C[-7],""X"")>=3,""ESCALATE FOR ATO"","" ""),"" "")"
    Selection.FormatConditions.Add Type:=xlTextString, String:="ATO", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    Range("K11,K12,K13").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Selection.Font.Bold = True
    Selection.Font.Size = 14
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With
  Range("K11:K13").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge

End Sub
Sub AddConditionSFI()
    Range("K14").Select
    ActiveCell.FormulaR1C1 = _
        "=IFERROR(IF(AND(R[-9]C[-7]=""x"",COUNTIF(R[-9]C[-7]:R[59]C[-7],""x"")>=5),""SFI"","" ""),"""")"
    Selection.Font.Bold = True
    Selection.Font.Size = 18
    Selection.FormatConditions.Add Type:=xlTextString, String:="sfi", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False

End Sub

Sub AddConditionPairAnalysis()
    Range("K15").Select
ActiveCell.FormulaR1C1 = "=IF(OR(R[20]C[-7]=""X"", R[34]C[-7]=""X""), ""PairAnalysis?"", """")"
       Selection.FormatConditions.Add Type:=xlTextString, String:="PairAnalysis?", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Selection.Font.Bold = True
    Selection.Font.Size = 14
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
End Sub

Sub AddConditionBusiness()

Range("K9").Select
ActiveCell.FormulaR1C1 = "=IF(OR(R[56]C[-7]=""X"", R[57]C[-7]=""X"", R[58]C[-7]=""X""), ""UserContent"", """")"
Call AddConditionUserContent

End Sub
Sub AddConditionUserContent()
  Selection.FormatConditions.Add Type:=xlTextString, String:="UserContent", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Selection.Font.Bold = True
    Selection.Font.Size = 14
   With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
End Sub
Sub AddConditionChargeback()

    Range("K16").Select
      ActiveCell.FormulaR1C1 = "=IF(R[24]C[-7]=""X"",""Chargeback"","""")"
     Selection.FormatConditions.Add Type:=xlTextString, String:="Chargeback", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False
        With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Selection.Font.Bold = True
    Selection.Font.Size = 14
   With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlTop
        .ReadingOrder = xlContext
    End With

End Sub

Sub TransactionFormulaAutomation()

    Range("D27").FormulaR1C1 = "=IF('RAPID (27)'!R[-25]C[2]=TRUE,""x"","" "")" 'Rapid
    Range("D31").FormulaR1C1 = "=IF(RC[1]>=4,""x"","" "")" 'Multiple
    Range("D32").FormulaR1C1 = "=IF('LOW (32)'!R[-30]C[3]=TRUE,""x"","" "")" 'Low Dollar Value
    Range("D33").FormulaR1C1 = "=IF(RC[1]<6,""x"","" "")" 'Minimal transaction
    Range("D34").FormulaR1C1 = "=IF('ROUND (34)'!R[-32]C[3]=TRUE,""x"","" "")" 'Round Dollar Value
'    Range("D40").FormulaR1C1 = "=IF(OR(RC[1]/R[-7]C[1]>=0.25,RC[1]>=3),""x"","" "")"
    Range("D42").FormulaR1C1 = "=IF(RC[1]>=3,""x"","" "")" 'Failed
    Range("D43").FormulaR1C1 = "=IF(RC[1]>=1,""x"","" "")" 'CBreversal
'    Range("D40").FormulaR1C1 = "=IF(R[-7]C[1]=0,"""",IF(OR(RC[1]/R[-7]C[1]>=0.25,RC[1]>=3),""x"","" ""))"
    Range("D40").FormulaR1C1 = "=IF(R[-7]C[1]=0,"""",IF(OR(RC[1]/R[-7]C[1]>=0.25,RC[1]>=3,RC[3]>=2000),""x"",""""))"
    Range("D41").FormulaR1C1 = "=IF(OR(RC[1]>2,RC[3]>=2000),""x"","""")"

    Range("E31").Select
    Range("E27:E43").Select
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Selection.Font.Size = 12
End Sub
Sub AmountNPercentage()


'INSIGHTS WHY RFI IS MARK
    Range("E29").FormulaR1C1 = _
        "=IF(SUBTOTAL(104, 'HIGH (29)'!C[-1])<490, ""Skip RFI"", SUBTOTAL(104, 'HIGH (29)'!C[-1]))"
    Range("E31").FormulaR1C1 = "='MULTIPLE (31)'!R[169]C[-2]"
    Range("E32").FormulaR1C1 = "='LOW (32)'!R[-18]C[6]"
    Range("E34").FormulaR1C1 = "='ROUND (34)'!R[-19]C[4]"
    Range("E35").Select
    Selection.InsertIndent 1
    Selection.InsertIndent 1
    Range("E34").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = False
    End With

    Range("E42").Select
    Application.CutCopyMode = False
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _
        Formula1:="=2"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16776961
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 4.99893185216834E-02
    End With
    Selection.FormatConditions(1).StopIfTrue = False
       Range("E42").Select
    Application.CutCopyMode = False
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _
        Formula1:="=$E$42"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
   

End Sub
Sub CheckIfCorruptedFile()

    Range("AZ1").Select
    ActiveCell.Formula2R1C1 = _
        "=SUM(LEN(R[4]C[-48]:R[73]C[-48])) - SUM(IF(R[4]C[-48]:R[73]C[-48] = ""X"", 1, 0)) - SUM(IF(R[4]C[-48]:R[73]C[-48] = "" "", 1, 0))"
    Range("K20").Select
    ActiveCell.FormulaR1C1 = "=IF(R[-19]C[41]>0,""CORRUPTED FILE"","""")"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With
    Selection.Font.Size = 16
    Selection.FormatConditions.Add Type:=xlTextString, String:="CORRUPTED", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 657641
    End With
    
    
End Sub
Sub MemoCount()

Range("E26").Select
ActiveCell.FormulaR1C1 = "=IF((COUNTA(RAWTABLE[Memo]))>1, ""( / ) MEMO"", ""NO MEMO"")"
  Range("E26").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="( / )", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16776961
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Range("E26").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="NO", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    ActiveWindow.SmallScroll Down:=1
    Range("E29,E37").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="SKIP", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16752384
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13561798
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Range("E35").Value = "( / ) LSS"
    Range("E36").Value = "( / ) SSS"
End Sub


Sub manual()
   Range("M8:BJ8").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Range("M1:Y2").Select
      ActiveCell.Value = "AUTOMATIC RESOLUTION NOTES WITH MANUAL OVERRIDE RATIONALE"
       With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
       With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
  Range("Z1:Z2").Select
   With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
     
'    Notes
    Range("A10").Select

 End Sub
Sub NOTES2()

    Range("F48").Select
    ActiveCell.FormulaR1C1 = "=IF(R[1]C[-2] = ""x"", ""DUPLICATE ? :"","" "")"
    Range("G48").Select
    ActiveCell.FormulaR1C1 = "=IF(R[1]C[-3] = ""x"", ""LSS ? :"","" "")"
     Range("F64").Select
    ActiveCell.FormulaR1C1 = "=IF(R[1]C[-2] = ""x"", ""ATO ? :"","" "")"
    Range("G64").Select
    ActiveCell.FormulaR1C1 = "=IF(R[1]C[-3] = ""x"", ""GOC ? :"","" "")"
    Range("F48,G48,F64,G4").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
    Range("F49:G49").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="X", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    With Selection
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
     Range("F65:G65").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="X", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    End With
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
   Set N = ActiveSheet.Range("N4")
     Set btn = ActiveSheet.Buttons.Add(N.Left, N.Top, N.Width, N.Height)
     With btn
    .OnAction = "ATO"
    .Caption = "ATO "
    .name = "ATO"
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)
    End With
    Set O = ActiveSheet.Range("O4")
     Set btn = ActiveSheet.Buttons.Add(O.Left, O.Top, O.Width, O.Height)
     With btn
    .OnAction = "BUSINESS"
    .Caption = "BUSINESS "
    .name = "BUSINESS"
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)
    End With
    
    Set P = ActiveSheet.Range("P4")
    Set btn = ActiveSheet.Buttons.Add(P.Left, P.Top, P.Width, P.Height)
    With btn
    .OnAction = "GOC"
    .Caption = "GOC "
    .name = "GOC"
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)
    End With
CopyBox
End Sub
Sub CopyBox()

 Range("N9:Z9").Select
    Selection.Font.Size = 12
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
        .MergeCells = True
    End With

    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .Weight = xlMedium
    End With

Range("M17:V17").Select
    ActiveCell.FormulaR1C1 = "=IF(R[32]C[-7]=""X"",""FOUND DUPLICATE ACCOUNT, DOUBLE CHECK RFI 28,61 AND 62"",""TM"")"
    Selection.FormatConditions.Add Type:=xlTextString, String:="TM", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    Selection.FormatConditions.Add Type:=xlTextString, String:="found", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False

  Set H = ActiveSheet.Range("H4")

     Set btn = ActiveSheet.Buttons.Add(H.Left, H.Top, H.Width, H.Height)
     With btn
    .Caption = "DASH "
    .OnAction = "DASH"
    .name = "DASH "
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)

    End With
    
    
  Set G = ActiveSheet.Range("G4")

     Set btn = ActiveSheet.Buttons.Add(G.Left, G.Top, G.Width, G.Height)
     With btn
    .Caption = "UNHIDE "
    .OnAction = "UNHIDE"
    .name = "UNHIDE "
    .Font.Bold = True
    .Font.Size = 12


   .Font.Color = RGB(220, 20, 60)

    End With
    
      Set M = ActiveSheet.Range("M9")

     Set btn = ActiveSheet.Buttons.Add(M.Left, M.Top, M.Width, M.Height)
     With btn
    .Caption = "BLURB"
    .OnAction = "BLURB"
    .name = "BLURB"
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)
    End With
    
     Set Z = ActiveSheet.Range("m4")
    Set btn = ActiveSheet.Buttons.Add(Z.Left, Z.Top, Z.Width, Z.Height)
     With btn
    .Caption = "RESOLVE  "
    .OnAction = "RESOLVE"
    .name = "RESOLVE "
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)
    End With
    
     Set b = ActiveSheet.Range("G35")

     Set btn = ActiveSheet.Buttons.Add(b.Left, b.Top, b.Width, b.Height)
     With btn
    .Caption = "BFF Tool "
    .OnAction = "BFFTool"
    .name = "BFF Tool "
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)

    End With
    
    Set C = ActiveSheet.Range("Z4")

     Set btn = ActiveSheet.Buttons.Add(C.Left, C.Top, C.Width, C.Height)
     With btn
    .Caption = "SFI "
    .OnAction = "SFINote"
    .name = "SFI"
    .Font.Bold = True
    .Font.Size = 12
   .Font.Color = RGB(220, 20, 60)

    End With

End Sub

Sub BLURB()
Range("N9:Z9").Copy
Application.CutCopyMode = False
End Sub
Sub RESOLVE()
  Range("M3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
    End With
Range("N9:Z9").Value = "Conclusion: Case is resolved due to insufficient number and severity of red flag indicators present to indicate unusual activity."
Range("M5:Y7").Copy
Application.CutCopyMode = False
End Sub
Sub SFINote()
OtherNote
Range("N9:Z9").Value = "Note: Due to potential indication of SFI, hence escalating the case to L1A for further review. "
Range("M5:Y7").Copy
Application.CutCopyMode = False
End Sub
Sub DASH()
Range("F34").Select
End Sub
Sub UNHIDE()


    Sheets("ROUND (34)").Visible = True
    Sheets("LOW (32)").Visible = True
    Sheets("MULTIPLE (31)").Visible = True
    Sheets("MULTIPLE (31)").Select
    Sheets("MULTIPLE (31)").Move Before:=Sheets(1)
    Sheets("LOW (32)").Select
    Sheets("LOW (32)").Move Before:=Sheets(4)
    Sheets("ROUND (34)").Select
    Sheets("ROUND (34)").Move Before:=Sheets(3)
    
    

End Sub
Sub Buttonsmanual()

 Set Q = ActiveSheet.Range("S4")
     Set btn = ActiveSheet.Buttons.Add(Q.Left, Q.Top, Q.Width, Q.Height)
     With btn
    .Caption = "GOC & BUS"
    .OnAction = "GOCandBusiness"
    .name = "GOCandBusiness "
    .Font.Bold = True
    .Font.Size = 12
    .Font.Color = RGB(220, 20, 60)
    End With




 Set R = ActiveSheet.Range("R4")

     Set btn = ActiveSheet.Buttons.Add(R.Left, R.Top, R.Width, R.Height)
     With btn
    .Caption = "CB"
    .OnAction = "CB"
    .name = "CB"
    .Font.Bold = True
    .Font.Size = 12
    .Font.Color = RGB(220, 20, 60)
    End With



 Set S = ActiveSheet.Range("Q4")

     Set btn = ActiveSheet.Buttons.Add(S.Left, S.Top, S.Width, S.Height)
     With btn
    .Caption = "FAKE "
    .OnAction = "FAKE"
    .name = "FAKE "
    .Font.Bold = True
    .Font.Size = 12
    .Font.Color = RGB(220, 20, 60)
    End With



 Set t = ActiveSheet.Range("T4")

     Set btn = ActiveSheet.Buttons.Add(t.Left, t.Top, t.Width, t.Height)
     With btn
    .Caption = "ATO & BUS "
    .OnAction = "ATOANDBUS"
    .name = "ATOA ND BUS "
    .Font.Bold = True
    .Font.Size = 12
    .Font.Color = RGB(220, 20, 60)
    End With




 Set U = ActiveSheet.Range("U4")

     Set btn = ActiveSheet.Buttons.Add(U.Left, U.Top, U.Width, U.Height)
     With btn
    .Caption = "ATO & GOC "
    .OnAction = "ATOANDGOC"
    .name = "ATOANDGOC "
    .Font.Bold = True
    .Font.Size = 12
    .Font.Color = RGB(220, 20, 60)
    End With


 Set v = ActiveSheet.Range("V4")

     Set btn = ActiveSheet.Buttons.Add(v.Left, v.Top, v.Width, v.Height)
     With btn
    .Caption = "ATO&FAKE "
    .OnAction = "ATOANDFAKE"
    .name = "ATO & FAKE "
    .Font.Bold = True
    .Font.Size = 12
    .Font.Color = RGB(220, 20, 60)
    End With




 Set w = ActiveSheet.Range("W4")

     Set btn = ActiveSheet.Buttons.Add(w.Left, w.Top, w.Width, w.Height)
     With btn
    .Caption = "ATO & SFI "
    .OnAction = "ATOANDSFI"
    .name = "ATOANDSFI "
    .Font.Bold = True
    .Font.Size = 12
    .Font.Color = RGB(220, 20, 60)
    End With


 Set X = ActiveSheet.Range("X4")

     Set btn = ActiveSheet.Buttons.Add(X.Left, X.Top, X.Width, X.Height)
     With btn
     .Caption = "ATO&SFI&CB "
    .OnAction = "ATOANDSFIANDCB"
    .name = "ATOANDSFIANDCB "
    .Font.Bold = True
    .Font.Size = 10
    .Font.Color = RGB(220, 20, 60)
    End With


 Set Q = ActiveSheet.Range("Y4")

     Set btn = ActiveSheet.Buttons.Add(Q.Left, Q.Top, Q.Width, Q.Height)
     With btn
   
      .Caption = "ATO & CB "
      .OnAction = "ATOANDCB"
      .name = "ATOANDCB "
    .Font.Bold = True
    .Font.Size = 12
    .Font.Color = RGB(220, 20, 60)
    End With
End Sub
Sub OtherNote()
    Dim replacementChar As String
    
    ' Set formulas in the specified ranges
    Range("M5").FormulaR1C1 = "=IF(R[38]C[-9]=""x"", ""     o Other (Chargeback Reversal)"", """")"
    Range("M6").Formula = _
        "=IF(R[47]C[-7]=""x"", ""       o Other (No Name On Card)"", """") & " & _
        "IF(R[47]C[-6]=""x"", ""       o Other (No Zipcode On Card)"", """") & " & _
        "IF(R[47]C[-4]=""x"", ""       o Other (No Name And Zipcode On Card)"", """")"
    Range("M7").Formula = "=IF(R[66]C[-9]=""x"", ""       o Other (ENGAGEMENT ABUSE)"", """")"
    
    ' Get the replacement character from Z1
    replacementChar = Range("Z1").Value
    
    ' Replace "o " with the specified replacement character
    Range("M5:M7").Replace What:="o ", Replacement:=replacementChar & " ", _
                   LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _
                   FormulaVersion:=xlReplaceFormula2
End Sub

Sub GOCandBusiness()


OtherNote
Range("M8:BJ8").Select
ActiveCell.FormulaR1C1 = _
        "=""Manual Override Rationale: ["" & (IF(R[59]C[-9]=""x"", ""Found Posts related to Business, "", """")) & (IF(R[57]C[-6]=""x"", "" and Post related to Game of Chance, "", """"))& (IF(R[23]C[-9]=""x"", ""A high volume of transactions with same/similar dollar value, "", """")) & (IF(R[26]C[-9]=""x"", ""Many transfers are sent in 'round dollar' amounts, "", """")) & (IF(R[21]C[-9]=""x"", ""Many transfers are sent in large amounts, "", """")" & _
        ") & ""Transactions consist of many senders to one receiver (the User that is the host)]"""
    Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note: Found Game of Chance, business post and TU is transacting with multiple CP considering risk-based approach,  hence escalating the case to L1A for further review."

   
    Range("M5:BJ8").Copy
    Application.CutCopyMode = False
    
     Range("S3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("T3:Y3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
      Range("M3:R3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select
                                                                                        

End Sub
Sub CB()
OtherNote
    Range("M8:BJ8").Select
    ActiveCell.FormulaR1C1 = _
         "=""Manual Override Rationale: [Found Chargeback Transaction]"""
    Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note: Found Multiple Chargeback in transaction, Hence Escalating the case to L1A for further review. "
         
    Range("M5:BJ8").Select
    Selection.Copy
    Application.CutCopyMode = False
    
      Range("R3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("S3:X3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
      Range("M3:Q3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select

End Sub
Sub FAKE()
OtherNote
Range("M8").Select
If Range("D9").Value = "x" Then
    ActiveCell.FormulaR1C1 = "=""Manual Override Rationale: [FAI Score > 0.5, Profile information does not appear authentic, Less timeline and photo on User Album, No ID verification]"""
Else
    ActiveCell.FormulaR1C1 = "=""Manual Override Rationale: [Profile information does not appear authentic, Less timeline and photo on User Album, No ID verification]"""
End If
Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note: Account seems to be inauthentic, hence escalating the case to L1A for further review."
         
    Range("M5:BJ8").Select
    Application.CutCopyMode = False
    
    
      Range("Q3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("R3:Y3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
      Range("M3:P3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select
    
    End Sub
Sub ATOANDBUS()
OtherNote
 Dim rationale As String
    
    ' Initialize the rationale string
    rationale = "Manual Override Rationale: ["
    
    ' Append conditions to the rationale
    If Range("D67").Value = "x" Then rationale = rationale & "Found Business post, "
    If Range("D5").Value = "x" Then rationale = rationale & "Case Triggered for SFI, "
    If Range("D6").Value = "x" Then rationale = rationale & "Payment Disabled by Paycom, "
    If Range("D7").Value = "x" Then rationale = rationale & "Payment Disabled by risk, "
    If Range("D27").Value = "x" Then rationale = rationale & "Unusual Rapid movement of funds, "
    If Range("D40").Value = "x" Then rationale = rationale & "Multiple Sent Chargebacks, "
    If Range("D41").Value = "x" Then rationale = rationale & "Multiple Sent Refunds: High count/ratio of Refunds, "
    If Range("D42").Value = "x" Then rationale = rationale & "Multiple Sent failed, "
    If Range("D45").Value = "x" Then rationale = rationale & "Financial instrument block listed, "
    If Range("D47").Value = "x" Then rationale = rationale & "Cardholder location does not match User's profile information, "
    If Range("F49").Value = "x" Then rationale = rationale & "Duplicate accounts are card sharing, "
    If Range("G49").Value = "x" Then rationale = rationale & "Card sharing with multiple Users who are not friends or have no mutual friends, "
    If Range("D55").Value = "x" Then rationale = rationale & "Changes in IP Addresses, "
    If Range("D57").Value = "x" Then rationale = rationale & "Log in Attempts, "
    If Range("F65").Value = "x" Then rationale = rationale & "Found Post Related to Account Takeover, "
    If Range("G65").Value = "x" Then rationale = rationale & "Found Post Related Game Of Chance, "
    If Range("D69").Value = "x" Then rationale = rationale & "Compromised Account, "
    
    ' Remove the last comma and space, if needed
    If Right(rationale, 2) = ", " Then
        rationale = Left(rationale, Len(rationale) - 2)
    End If
    
    ' Close the bracket
    rationale = rationale & "]"
    
    ' Output the result in a specific cell
    Range("M8").Value = rationale
    
    Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note:  Found ATO indicators and Escalating the case on risk-based approach to L1A as there are posts/transactions related to business. "
         
    Range("M5:BJ8").Copy
    Application.CutCopyMode = False



      Range("T3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("U3:X3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
      Range("M3:S3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select
    End Sub
Sub ATOANDGOC()
OtherNote
  Dim rationale As String
    
    ' Initialize the rationale string
    rationale = "Manual Override Rationale: [ "
    
    ' Append conditions to the rationale
    If Range("G65").Value = "x" Then rationale = rationale & "Found Game of chance post, "
    If Range("D5").Value = "x" Then rationale = rationale & "Case Triggered for SFI, "
    If Range("D6").Value = "x" Then rationale = rationale & "Payment Disabled by Paycom, "
    If Range("D7").Value = "x" Then rationale = rationale & "Payment Disabled by risk, "
    If Range("D27").Value = "x" Then rationale = rationale & "Unusual Rapid movement of funds, "
    If Range("D40").Value = "x" Then rationale = rationale & "Multiple Sent Chargebacks, "
    If Range("D41").Value = "x" Then rationale = rationale & "Multiple Sent Refunds: High count/ratio of Refunds, "
    If Range("D42").Value = "x" Then rationale = rationale & "Multiple Sent failed, "
    If Range("D45").Value = "x" Then rationale = rationale & "Financial instrument block listed, "
    If Range("D47").Value = "x" Then rationale = rationale & "Cardholder location does not match User's profile information, "
    If Range("F49").Value = "x" Then rationale = rationale & "Duplicate accounts are card sharing, "
    If Range("G49").Value = "x" Then rationale = rationale & "Card sharing with multiple Users who are not friends or have no mutual friends, "
    If Range("D55").Value = "x" Then rationale = rationale & "Changes in IP Addresses, "
    If Range("D57").Value = "x" Then rationale = rationale & "Log in Attempts, "
    If Range("F65").Value = "x" Then rationale = rationale & "Found Post Related to Account Takeover, "
    If Range("G65").Value = "x" Then rationale = rationale & "Found Post Related Game Of Chance, "
    If Range("D69").Value = "x" Then rationale = rationale & "Compromised Account, "
    
    ' Remove the last comma and space, if needed
    If Right(rationale, 2) = ", " Then
        rationale = Left(rationale, Len(rationale) - 2)
    End If
    
    ' Close the bracket
    rationale = rationale & "]"
    
    ' Output the result in a specific cell
    Range("M8").Value = rationale
    Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note: Found ATO indicators and Found posts related to game of chance, hence escalating the case to L1A for further review."
         
    Range("M5:BJ8").Copy
    Application.CutCopyMode = False
    
    
      Range("U3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("V3:X3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
      Range("M3:T3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select
End Sub
Sub ATOANDFAKE()
OtherNote
Dim rationale As String
    
    ' Initialize the rationale string
    rationale = "Manual Override Rationale: [Profile information does not appear authentic, Less timeline and photo on User Album, No ID verification "
    
    ' Append conditions to the rationale
    If Range("D9").Value = "x" Then rationale = rationale & "FAI Score > 0.5, "
    If Range("D5").Value = "x" Then rationale = rationale & "Case Triggered for SFI, "
    If Range("D6").Value = "x" Then rationale = rationale & "Payment Disabled by Paycom, "
    If Range("D7").Value = "x" Then rationale = rationale & "Payment Disabled by risk, "
    If Range("D27").Value = "x" Then rationale = rationale & "Unusual Rapid movement of funds, "
    If Range("D40").Value = "x" Then rationale = rationale & "Multiple Sent Chargebacks, "
    If Range("D41").Value = "x" Then rationale = rationale & "Multiple Sent Refunds: High count/ratio of Refunds, "
    If Range("D42").Value = "x" Then rationale = rationale & "Multiple Sent failed, "
    If Range("D45").Value = "x" Then rationale = rationale & "Financial instrument block listed, "
    If Range("D47").Value = "x" Then rationale = rationale & "Cardholder location does not match User's profile information, "
    If Range("F49").Value = "x" Then rationale = rationale & "Duplicate accounts are card sharing, "
    If Range("G49").Value = "x" Then rationale = rationale & "Card sharing with multiple Users who are not friends or have no mutual friends, "
    If Range("D55").Value = "x" Then rationale = rationale & "Changes in IP Addresses, "
    If Range("D57").Value = "x" Then rationale = rationale & "Log in Attempts, "
    If Range("F65").Value = "x" Then rationale = rationale & "Found Post Related to Account Takeover, "
    If Range("G65").Value = "x" Then rationale = rationale & "Found Post Related Game Of Chance, "
    If Range("D69").Value = "x" Then rationale = rationale & "Compromised Account, "
    
    ' Remove the last comma and space, if needed
    If Right(rationale, 2) = ", " Then
        rationale = Left(rationale, Len(rationale) - 2)
    End If
    
    ' Close the bracket
    rationale = rationale & "]"
    
    ' Output the result in a specific cell
    Range("M8").Value = rationale
    Range("N9:Z9").FormulaR1C1 = _
        "Note: Found ATO indicators and account seems to be inauthentic, hence escalating case to L1A for further review."

 
    Range("M5:BJ8").Copy
    Application.CutCopyMode = False
      Range("V3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("W3:Y3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
      Range("M3:U3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select
    End Sub
Sub ATOANDSFI()
OtherNote
Dim rationale As String
    
    ' Initialize the rationale string
    rationale = "Manual Override Rationale: [Found"
    
    ' Append conditions to the rationale
    If Range("D5").Value = "x" Then rationale = rationale & " Case Triggered for SFI, "
    If Range("D6").Value = "x" Then rationale = rationale & "Payment Disabled by Paycom, "
    If Range("D7").Value = "x" Then rationale = rationale & "Payment Disabled by risk, "
    If Range("D27").Value = "x" Then rationale = rationale & "Unusual Rapid movement of funds, "
    If Range("D40").Value = "x" Then rationale = rationale & "Multiple Sent Chargebacks, "
    If Range("D41").Value = "x" Then rationale = rationale & "Multiple Sent Refunds: High count/ratio of Refunds, "
    If Range("D42").Value = "x" Then rationale = rationale & "Multiple Sent failed, "
    If Range("D45").Value = "x" Then rationale = rationale & "Financial instrument block listed, "
    If Range("D47").Value = "x" Then rationale = rationale & "Cardholder location does not match User's profile information, "
    If Range("F49").Value = "x" Then rationale = rationale & "Duplicate accounts are card sharing, "
    If Range("G49").Value = "x" Then rationale = rationale & "Card sharing with multiple Users who are not friends or have no mutual friends, "
    If Range("D55").Value = "x" Then rationale = rationale & "Changes in IP Addresses, "
    If Range("D57").Value = "x" Then rationale = rationale & "Log in Attempts, "
    If Range("F65").Value = "x" Then rationale = rationale & "Found Post Related to Account Takeover, "
    If Range("G65").Value = "x" Then rationale = rationale & "Found Post Related Game Of Chance, "
    If Range("D69").Value = "x" Then rationale = rationale & "Compromised Account, "
    
    ' Remove the last comma and space, if needed
    If Right(rationale, 2) = ", " Then
        rationale = Left(rationale, Len(rationale) - 2)
    End If
    
    ' Close the bracket
    rationale = rationale & "]"
    
    ' Output the result in a specific cell
    Range("M8").Value = rationale
    Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note: Due to ATO and potential indication of SFI, hence escalating the case to L1A for further review. "
 
    Range("M5:BJ8").Copy
    Application.CutCopyMode = False
    
Range("W3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("X3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
      Range("M3:V3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select
    End Sub
Sub ATOANDCB()
OtherNote

Dim rationale As String
    
    ' Initialize the rationale string
    rationale = "Manual Override Rationale: [Found"
    
    ' Append conditions to the rationale
    If Range("D40").Value = "x" Then rationale = rationale & " Multiple Sent Chargebacks, "
    If Range("D5").Value = "x" Then rationale = rationale & "Case Triggered for SFI, "
    If Range("D6").Value = "x" Then rationale = rationale & "Payment Disabled by Paycom, "
    If Range("D7").Value = "x" Then rationale = rationale & "Payment Disabled by risk, "
    If Range("D27").Value = "x" Then rationale = rationale & "Unusual Rapid movement of funds, "
    If Range("D41").Value = "x" Then rationale = rationale & "Multiple Sent Refunds: High count/ratio of Refunds, "
    If Range("D42").Value = "x" Then rationale = rationale & "Multiple Sent failed, "
    If Range("D45").Value = "x" Then rationale = rationale & "Financial instrument block listed, "
    If Range("D47").Value = "x" Then rationale = rationale & "Cardholder location does not match User's profile information, "
    If Range("F49").Value = "x" Then rationale = rationale & "Duplicate accounts are card sharing, "
    If Range("G49").Value = "x" Then rationale = rationale & "Card sharing with multiple Users who are not friends or have no mutual friends, "
    If Range("D55").Value = "x" Then rationale = rationale & "Changes in IP Addresses, "
    If Range("D57").Value = "x" Then rationale = rationale & "Log in Attempts, "
    If Range("F65").Value = "x" Then rationale = rationale & "Found Post Related to Account Takeover, "
    If Range("G65").Value = "x" Then rationale = rationale & "Found Post Related Game Of Chance, "
    If Range("D69").Value = "x" Then rationale = rationale & "Compromised Account, "
    
    ' Remove the last comma and space, if needed
    If Right(rationale, 2) = ", " Then
        rationale = Left(rationale, Len(rationale) - 2)
    End If
    
    ' Close the bracket
    rationale = rationale & "]"
    
    ' Output the result in a specific cell
    Range("M8").Value = rationale
    Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note: Due to Potential indication of ATO & found multiple CHARGEBACK in transaction. Hence, escalating the case to L1A for further review. "

 
    Range("M7:BJ8").Copy
    Application.CutCopyMode = False
    
    Range("Y3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With

      Range("M3:X3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select
End Sub
Sub ATOANDSFIANDCB()
OtherNote
Dim rationale As String
    
    ' Initialize the rationale string
    rationale = "Manual Override Rationale: [Found"
    
    ' Append conditions to the rationale
    If Range("D40").Value = "x" Then rationale = rationale & "Multiple Sent Chargebacks, "
    If Range("D5").Value = "x" Then rationale = rationale & "Case Triggered for SFI, "
    If Range("D6").Value = "x" Then rationale = rationale & "Payment Disabled by Paycom, "
    If Range("D7").Value = "x" Then rationale = rationale & "Payment Disabled by risk, "
    If Range("D27").Value = "x" Then rationale = rationale & "Unusual Rapid movement of funds, "
    If Range("D41").Value = "x" Then rationale = rationale & "Multiple Sent Refunds: High count/ratio of Refunds, "
    If Range("D42").Value = "x" Then rationale = rationale & "Multiple Sent failed, "
    If Range("D45").Value = "x" Then rationale = rationale & "Financial instrument block listed, "
    If Range("D47").Value = "x" Then rationale = rationale & "Cardholder location does not match User's profile information, "
    If Range("F49").Value = "x" Then rationale = rationale & "Duplicate accounts are card sharing, "
    If Range("G49").Value = "x" Then rationale = rationale & "Card sharing with multiple Users who are not friends or have no mutual friends, "
    If Range("D55").Value = "x" Then rationale = rationale & "Changes in IP Addresses, "
    If Range("D57").Value = "x" Then rationale = rationale & "Log in Attempts, "
    If Range("F65").Value = "x" Then rationale = rationale & "Found Post Related to Account Takeover, "
    If Range("G65").Value = "x" Then rationale = rationale & "Found Post Related Game Of Chance, "
    If Range("D69").Value = "x" Then rationale = rationale & "Compromised Account, "
    
    ' Remove the last comma and space, if needed
    If Right(rationale, 2) = ", " Then
        rationale = Left(rationale, Len(rationale) - 2)
    End If
    
    ' Close the bracket
    rationale = rationale & "]"
    
    ' Output the result in a specific cell
    Range("M8").Value = rationale
    Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note: Found potential indication of ATO & SFI & found multiple CHARGEBACK in transaction, hence Escalating the case to L1A for further review. "
 
    Range("M5:BJ8").Select
    Selection.Copy
    Application.CutCopyMode = False
    
     Range("X3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("Y3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
      Range("M3:W3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select
    End Sub

Sub Business()
OtherNote
    Range("M8:BJ8").FormulaR1C1 = _
        "=""Manual Override Rationale: ["" & (IF(R[59]C[-9]=""x"", ""Found Posts related to Business, "", """")) & (IF(R[23]C[-9]=""x"", ""A high volume of transactions with same/similar dollar value, "", """")) & (IF(R[26]C[-9]=""x"", ""Many transfers are sent in 'round dollar' amounts, "", """")) & (IF(R[21]C[-9]=""x"", ""Many transfers are sent in large amounts, "", """")" & _
        ") & ""Transactions consist of many senders to one receiver (the User that is the host)]"""
   Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note: Escalating the case on risk-based approach to L1A as there are posts/transactions related to business. "
        
           
    Range("M5:BJ8").Select
    Selection.Copy
    Application.CutCopyMode = False
    
    Range("O3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("P3:X3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    Range("M3:N3").Select
       End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select
    End Sub
Sub Goc()
OtherNote


    Range("M8:BJ8").Select
    ActiveCell.FormulaR1C1 = _
        "=""Manual Override Rationale: ["" & (IF(R[57]C[-6]=""x"", ""Found Post related to Game of Chance, "", """")) & (IF(R[23]C[-9]=""x"", ""A high volume of transactions with same/similar dollar value, "", """")) & (IF(R[24]C[-9]=""x"", ""Low dollar value but high frequency, "", """")) & ""Transactions consist of many senders to one receiver (the User that is the host)]"""
          Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note: Found posts related to Game of Chance, hence escalating the case to L1A for further review."
        
           
    Range("M5:BJ8").Select
    Selection.Copy
    Application.CutCopyMode = False
    Range("P3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("Q3:X3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
      Range("M3:O3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    
    
   
    Range("M5:BJ8").Select
    End Sub
Sub ATO()
OtherNote
    
    Dim rationale As String
    
    ' Initialize the rationale string
    rationale = "Manual Override Rationale: [Found "
    
    ' Append conditions to the rationale
    If Range("D5").Value = "x" Then rationale = rationale & "Case Triggered for SFI, "
    If Range("D6").Value = "x" Then rationale = rationale & "Payment Disabled by Paycom, "
    If Range("D7").Value = "x" Then rationale = rationale & "Payment Disabled by risk, "
    If Range("D27").Value = "x" Then rationale = rationale & "Unusual Rapid movement of funds, "
    If Range("D40").Value = "x" Then rationale = rationale & "Multiple Sent Chargebacks, "
    If Range("D41").Value = "x" Then rationale = rationale & "Multiple Sent Refunds: High count/ratio of Refunds, "
    If Range("D42").Value = "x" Then rationale = rationale & "Multiple Sent failed, "
    If Range("D45").Value = "x" Then rationale = rationale & "Financial instrument block listed, "
    If Range("D47").Value = "x" Then rationale = rationale & "Cardholder location does not match User's profile information, "
    If Range("F49").Value = "x" Then rationale = rationale & "Duplicate accounts are card sharing, "
    If Range("G49").Value = "x" Then rationale = rationale & "Card sharing with multiple Users who are not friends or have no mutual friends, "
    If Range("D55").Value = "x" Then rationale = rationale & "Changes in IP Addresses, "
    If Range("D57").Value = "x" Then rationale = rationale & "Log in Attempts, "
    If Range("F65").Value = "x" Then rationale = rationale & "Found Post Related to Account Takeover, "
    If Range("G65").Value = "x" Then rationale = rationale & "Found Post Related Game Of Chance, "
    If Range("D69").Value = "x" Then rationale = rationale & "Compromised Account, "
    
    ' Remove the last comma and space, if needed
    If Right(rationale, 2) = ", " Then
        rationale = Left(rationale, Len(rationale) - 2)
    End If
    
    ' Close the bracket
    rationale = rationale & "]"
    
    ' Output the result in a specific cell
    Range("M8").Value = rationale
'    ActiveCell.FormulaR1C1 = _
'        "=""Manual Override Rationale: [Found"" &" & Chr(10) & "(IF(R[-2]C[-9]=""x"", ""Payment Disabled by Paycom, "", """")) &" & Chr(10) & "(IF(R[-1]C[-9]=""x"", ""Payment Disabled by risk, "", """")) &" & Chr(10) & "(IF(R[-3]C[-9]=""x"", ""Case Triggered for SFI, "", """")) &" & Chr(10) & "(IF(R[19]C[-9]=""x"", ""Unusual Rapid movement of funds, "", """")) &" & Chr(10) & "(IF(R[32]C[-9]=""x"", ""Multiple Sent Chargebacks, "", """")) &" & Chr(10) & "(IF(" & _
'        "R[34]C[-9]=""x"", ""Multiple Sent failed, "", """")) &" & Chr(10) & "(IF(R[37]C[-9]=""x"", ""Financial instrument block listed, "", """")) &" & Chr(10) & "(IF(R[39]C[-9]=""x"", ""Cardholder location does not match User's profile information, "", """")) &" & Chr(10) & "(IF(R[41]C[-7]=""x"", ""Duplicate accounts are card sharing, "", """")) &" & Chr(10) & "(IF(R[41]C[-6]=""x"", ""Card sharing with multiple Users who are no" & _
'        "t friends or have no mutual friends, "", """")) &" & Chr(10) & "(IF(R[47]C[-9]=""x"", ""Changes in IP Addresses, "", """")) &" & Chr(10) & "(IF(R[49]C[-9]=""x"", ""Log in Attempts, "", """")) &" & Chr(10) & "(IF(R[57]C[-7]=""x"", ""Found Post Related to Account Takeover, "", """")) &" & Chr(10) & "(IF(R[57]C[-6]=""x"", ""Found Post Related Game Of Chance, "", """")) &" & Chr(10) & "(IF(R[61]C[-9]=""x"", ""Compromised Account, "", """"" & _
'        ")) &" & Chr(10) & """]"""
    Range("N9:Z9").Select
    ActiveCell.FormulaR1C1 = _
        "Note: Found ATO indicators, hence escalating the case to L1A for further review."
           
    Range("M5:BJ8").Select
    Selection.Copy
    Application.CutCopyMode = False
        
    Range("N3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399975585192419
    End With
    Range("O3:X3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
      Range("M3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    Range("M5:BJ8").Select
    End Sub

Sub BFFTool()

   
    Sheets.Add After:=ActiveSheet
    Sheets("Sheet18").Select
    Sheets("Sheet18").Move Before:=Sheets(15)
    Sheets("Sheet18").Select
    Sheets("Sheet18").name = "BFF TOOL"
    
    Range("E8").Select
    ActiveCell.Formula2R1C1 = _
        "=TOCOL(UNIQUE('Unusual Circular (28)'!R[-7]C[-2]:R[1992]C[-1]))"
    Range("E1:E2000").Select
    Selection.Copy
    Columns("F:F").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, transpose:=False
    Columns("E:K").EntireColumn.AutoFit
    Application.CutCopyMode = False
    Range("G10").Select
    Application.CutCopyMode = False
    ActiveCell.Formula2R1C1 = "=UNIQUE(RC[-1]:R[1992]C[-1])"
    Range("G10:G500").Copy
    Range("H10").PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False
    Range("H10:H500").Select
    Selection.TextToColumns Destination:=Range("H10"), DataType:=xlDelimited, _
        TextQualifier:=xlNone, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _
        :="(", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True
    Range("I10:I500").Select
    Selection.Replace What:=")", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, FormulaVersion:= _
        xlReplaceFormula2
    Selection.NumberFormat = "0"
    Columns("E:G").Select
    Range("G1").Activate
    Selection.EntireColumn.Hidden = True
    Columns("H:H").ColumnWidth = 23.33
    Columns("I:I").ColumnWidth = 30.5
    Range("H9:I30").Select
    ActiveSheet.ListObjects.Add(xlSrcRange, Range("$H$9:$I$500"), , xlNo).name = _
        "Table8"
    Range("Table8[#All]").Select
    ActiveSheet.ListObjects("Table8").TableStyle = "TableStyleMedium13"
    Range("Table8[[#Headers],[Column1]]").Select
    ActiveCell.FormulaR1C1 = "NAME"
    Range("Table8[[#Headers],[Column2]]").Select
    ActiveCell.FormulaR1C1 = "UID"
    Range("Table8[#Headers]").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Range("D11:D501").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    ActiveWindow.DisplayGridlines = False
    Range("H1:H500").Select
    Selection.Replace What:="0", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, FormulaVersion:= _
        xlReplaceFormula2
    Range("H1:I500").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
Columns("H:I").Select
    Selection.Font.Size = 18
    Rows("2:6").Select
    Range("B6").Activate
    Selection.Delete Shift:=xlUp
    Columns("H:H").ColumnWidth = 61
    Columns("I:I").ColumnWidth = 57.33
    Range("H2:I2").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    Range("H2:I2").Select
    ActiveCell.FormulaR1C1 = "NAME AND UID OF FB USER"
   Range("H2:I2").Select
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = -0.499984740745262
    End With
    Range("I6").Select
End Sub
Sub Rfi_53()
'
' rfi_53 Macro
'

'
     Range("F52").Value = "=IF(D53 = ""x"", ""No Name:"","" "")"
     Range("G52").Value = "=IF(D53  = ""x"", ""No ZipCode? :"","" "")"
     Range("I52").Value = "=IF(D53 = ""x"", ""No Name and Zipcode On Card? :"","" "")"
    Range("I53:J53").Select
    Selection.Merge
    Range("f53:I53").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="x", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With
     Range("M5:Y5").Merge
     Range("M6:Y6").Merge
     Range("M7:Y7").Merge
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .ReadingOrder = xlContext
    End With
End Sub

Sub USERINFO()
    Dim i As Integer
    Dim response As VbMsgBoxResult
    Dim questions() As Variant
    Dim prompt As String
    ActiveWindow.Zoom = 70
    
    ' Define your questions
    questions = Array( _
        "[ RFI 5 ] Is Trigger Reason SFI?", _
        "[ RFI 6 ] Payments Disabled by PayCom?", _
        "[ RFI 7 ] Payments Disabled by Risk?", _
        "[ RFI 8 ] User Name vs. Old name mismatch?", _
        "[ RFI 9 ] FAI Score > 0.5?", _
        "[ RFI 10 ] No personal profile photos ?", _
        "[ RFI 11 ] Account created <30 days ago", _
        "[ RFI 12 ] Low Friend Count (eg.<10)", _
        "[ RFI 13 ] Number of days on FB vs Active days (High ratio of days on FB vs Active)?", _
        "[ RFI 14 ] Fake Age?", _
        "[ RFI 15 ] User Profile zipcode is in high risk zipcode?", _
        "[ RFI 16 ] Does not appear to reflect an authentic person " _
    )
    
    ' Loop through the questions
    For i = LBound(questions) To UBound(questions)
        prompt = questions(i)
        
        ' Show message box with Yes, No, and Close options
        response = MsgBox(prompt, vbYesNoCancel)
        
        Select Case response
            Case vbYes
                ' Mark the corresponding cell with "X"
                Range("D" & (i + 5)).Value = "X"
            
            Case vbNo
                Range("D" & (i + 5)).ClearContents
            
            Case vbCancel
                If ActiveCell.Address = "$D$5" Then
                    MsgBox "Cancel button clicked, exiting..."
                    Exit Sub
                Else
                    i = i - 2
                End If
                
        End Select
    Next i
End Sub
Sub IDV()
    i = 1

    prompt = "[ RFI 20 ] Idology name significant mismatch from profile name ?"
    response = MsgBox(prompt, vbYesNo)

    If response = vbYes Then
        prompt = "[ RFI 20 ] Check financial instrument widget. Idology name significant mismatch from financial instrument information?"
        response2 = MsgBox(prompt, vbYesNoCancel)
         If response2 = vbYes Then
         Range("D20").Value = "x"
         ElseIf response2 = vbNo Then
        Range("D20").ClearContents
 End If
    ElseIf response = vbNo Then
        Range("D20").ClearContents
    Else
  
    End If

    prompt = "[ RFI 21 ] OFAC Check - did not pass"
    response = MsgBox(prompt, vbYesNoCancel)

    If response = vbYes Then
        Range("D21").Value = "x"
    ElseIf response = vbNo Then
        Range("D21").ClearContents
    Else
        i = i - 2
    End If

    prompt = "[ RFI 22 ] IDV Check Failed"
    response = MsgBox(prompt, vbYesNoCancel)

    If response = vbYes Then
        Range("D22").Value = "x"
    ElseIf response = vbNo Then
        Range("D22").ClearContents
    Else
        i = i - 2
    End If
End Sub




Sub FI()
    Dim i As Integer
    Dim response As VbMsgBoxResult
    Dim questions() As Variant
    Dim prompt As String
    
    ' Define your questions
        questions = Array( _
        "[ RFI 45 ] Financial instrument block listed?", _
        "[ RFI 46 ] Cardholder name or PayPal account information does not match actual User name/Idology name?", _
        "[ RFI 47 ] Cardholder location does not match User's profile information?", _
        "[ RFI 48 ] Financial instruments tied to multiple zip codes or locations that appear unusual,especially from high-risk jurisdictions?", _
        "[ RFI 49 ] Duplicate accounts are card sharing orCard sharing with multiple Users who are not friends or have no mutual friends?", _
        "[ RFI 50 ] Unusual FIs added to Account when the suspected activity occurred. For example: 3 or more card load attempts in 1 week (different cards)?", _
        "[ RFI 51 ] Unusual use of existing cards when the suspected activity occurred?", _
        "[ RFI 52 ] Unusual volume of active or attempted added financial instruments on the account. (eg. 4 or more Fis)", _
        "[ RFI 53 ] Other (please specify) " _
    )



    ' Loop through the questions
    For i = LBound(questions) To UBound(questions)
        prompt = questions(i)
        
        ' Show message box with Yes, No, and Close options
          response = MsgBox(prompt, vbYesNoCancel)

        Select Case response
            Case vbYes
                ' Mark the corresponding cell with "X"
                Range("D" & (i + 45)).Value = "X"
            
            Case vbNo
                Range("D" & (i + 45)).ClearContents
            Case vbCancel
                ' Exit the subroutine if Cancel (Close) is chosen
                i = i - 2
                
        End Select
    Next i
End Sub
   



'==========================================================================================================================================

'==========================================================================================================================================

'==========================================================================================================================================



Public Sub IPCreation()
' IPCreation Macro

Dim ws As Worksheet

' Add new sheet and set name
Set ws = Sheets.Add
ws.name = "IpInformation"

' Set header and formatting
With ws.Range("B1")
    .FormulaR1C1 = "Insert IP Data Here"
    .Font.name = "Calibri"
    .Font.Size = 20
    .Font.Bold = True
    .Font.Color = -16777216
End With


ws.Columns("B:B").EntireColumn.AutoFit
ws.Columns("A:A").ColumnWidth = 24.83

' Add button
ws.Buttons.Add(7, 5, 120, 30).Select
With Selection
    .OnAction = "PERSONAL.XLSB!GenerateIPTable.GenerateIPTable"
    .Characters.Text = "Generate IP"
    .Characters.Font.name = "Calibri"
    .Characters.Font.Size = 12
End With


End Sub

'= = = = = = = = = = = = = = = = = = = = = = = = = = = =
Private Sub GenerateIPTable()
'  Sheets("Unusual Circular (28)").Select
'    ActiveWorkbook.Worksheets("Unusual Circular (28)").ListObjects("RAWTABLE").Sort _
'        .SortFields.Clear
'   Sheets("IpInformation").Select
    Dim lastRow As Long
    Dim lastCol As Long
    Dim dataRange As Range
    Dim rowCount As Integer
    
 
    lastRow = Sheets("IpInformation").Cells(Sheets("IpInformation").Rows.count, "B").End(xlUp).Row
    lastCol = Sheets("IpInformation").Cells(2, Sheets("IpInformation").Columns.count).End(xlToLeft).Column

    Set dataRange = Sheets("IpInformation").Range(Sheets("IpInformation").Cells(1, 1), Sheets("IpInformation").Cells(lastRow, lastCol))

    rowCount = dataRange.count / 10

    Dim i As Long
    Dim initCounter As Integer
    Dim counter As Integer
    Dim rangeName As String
    initCounter = 0
    counter = 4

    For i = 1 To rowCount
        rangeName = "D" & i
        Range(rangeName).Select
        ActiveCell.Formula2R1C1 = "=TRANSPOSE(R[" & initCounter & "]C[-2]:R[" & counter & "]C[-2])"
        initCounter = initCounter + 4
        counter = counter + 4
        
        If i = rowCount Then
        Exit For
        End If
    Next i

TableCreationIP
GenerateIPTableCondition
IPButtons
DateColor
ActiveWorkbook.Save

Offshore
IPBorder
End Sub

'= = = = = = = = = = = = = = = = = = = = = = = = =
Private Sub TableCreationIP()
Dim dataRange As Range

''lastRow = dataRange.Rows.Count
''lastCol = dataRange.Columns.Count

' Set data range
Set dataRange = Sheets("IpInformation").UsedRange

' Call other subs
SEARCHBOXIP
DateOfTransactions
RemoveDuplicateTransactions
End Sub

'= = = = = = = = = = = = = = = = = = = = =
Sub SEARCHBOXIP()

' Copy and paste values
Columns("D:H").Copy
Range("J1").PasteSpecial xlPasteValues

'Create table
ActiveSheet.ListObjects.Add(xlSrcRange, Range("$J1:$N$5000"), , xlNo).name = "IPTABLE1"

Columns("B:N").EntireColumn.Hidden = True

' Set search header
Range("P1").Value2 = "SEARCH :"
Range("P1").Font.Size = 16

'''' ======Set search formula
Range("P3").Formula2R1C1 = _
   "=FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,1))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,2))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,3))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,4))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,5))),""NO RESULTS!"")))))"
'    Range("P3").Formula2R1C1 = _
'        "=FILTER(IPTABLE1, (ISERROR(SEARCH(R[-2]C[1], INDEX(IPTABLE1, 0, 1))) *" & Chr(10) & "                   ISERROR(SEARCH(R[-2]C[1], INDEX(IPTABLE1, 0, 2))) *" & Chr(10) & "                   ISERROR(SEARCH(R[-2]C[1], INDEX(IPTABLE1, 0, 3))) *" & Chr(10) & "                   ISERROR(SEARCH(R[-2]C[1], INDEX(IPTABLE1, 0, 4))) *" & Chr(10) & "                   ISERROR(SEARCH(R[-2]C[1], INDEX(IPTABLE1, 0, 5)))) *" & Chr(10) & "            " & _
'        "      (INDEX(IPTABLE1, 0, 1) <> 0)," & Chr(10) & "        ""NO RESULTS!"")" & _
'        ""


' Format search results
Columns("P:P").NumberFormat = "[$-x-sysdate]dddd, mmmm dd, yyyy"
Columns("P:P").EntireColumn.AutoFit
Columns("Q:T").EntireColumn.AutoFit

' Set formatting for search header and results
Range("Q1").Interior.ThemeColor = xlThemeColorAccent5
Range("Q1").Interior.TintAndShade = 0.599993896298105
Range("P1").Interior.Color = 65535

' Add formatting condition
Range("P3:T500").FormatConditions.Add xlTextString, String:="=$Q$1", TextOperator:=xlContains
With Range("P3:T500").FormatConditions(1)
    .Font.Color = -16754788
    .Interior.Color = 10284031
End With
End Sub

'= = = = = = = = = = = = = = = = = = =
Private Sub DateOfTransactions()

' Set header and formula

 Range("V1").Value2 = "Date of Transactions"
 Range("V2").Formula2R1C1 = "=RAWTABLE[Date]"

 ' Apply formatting
 With Columns("V:V")
     .EntireColumn.AutoFit
     .Font.name = "Calibri"
     .Font.Size = 14
     .Font.Color = -16777216
     .HorizontalAlignment = xlCenter
     .VerticalAlignment = xlBottom
     .WrapText = False
     .ReadingOrder = xlContext
     .MergeCells = False
     .Interior.Pattern = xlSolid
     .Interior.ThemeColor = xlThemeColorAccent1
     .Interior.TintAndShade = 0.399975585192419
 End With
 End Sub

' = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
Private Sub GenerateIPTableCondition()
    Dim targetRange As Range
    Set targetRange = Range("P3:T500")
'search highlight
    Range("R1").FormulaR1C1 = " Enter Location"
    Range("R2").FormulaR1C1 = " Enter Location Two"
    Range("S1").FormulaR1C1 = " Enter Status"
    Range("T1").FormulaR1C1 = " Enter Activity"

' Add formatting conditions
    Range("P3:T500").Select
    Range("P3").Activate
    Selection.FormatConditions.Add Type:=xlTextString, String:="=$Q$1", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16777216
    End With
    With Selection.FormatConditions(1).Interior
        .Color = 10284031
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Columns("R:R").Select
    Range("R3").Activate
    Selection.FormatConditions.Add Type:=xlTextString, String:="=$R$1", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
 With Selection.FormatConditions(1).Font
    ' Set font color to black
    .Color = RGB(0, 0, 0)  ' Black
End With

With Selection.FormatConditions(1).Interior
    ' Set interior (background) color
    .PatternColorIndex = xlAutomatic
   .Color = RGB(184, 228, 184)  ' Light Green
End With
    Selection.FormatConditions(1).StopIfTrue = False
    Range("R2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 12182968
    End With
     Columns("R:R").Select
    Range("R3").Activate
    Selection.FormatConditions.Add Type:=xlTextString, String:="=$R$2", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
 With Selection.FormatConditions(1).Font
    ' Set font color to black
    .Color = RGB(0, 0, 0)  ' Black
End With

With Selection.FormatConditions(1).Interior
    ' Set interior (background) color
    .PatternColorIndex = xlAutomatic
   .Color = RGB(184, 228, 184)  ' Light Green
End With
    Selection.FormatConditions(1).StopIfTrue = False
    Columns("S:S").Select
    Range("S3").Activate
    Selection.FormatConditions.Add Type:=xlTextString, String:="=$S$1", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
    ' Set font color to white
    .Color = RGB(255, 255, 255)  ' White
End With

With Selection.FormatConditions(1).Interior
    ' Set interior (background) color to light gray
    .PatternColorIndex = xlAutomatic
    .Color = RGB(0, 0, 0)  ' Black
End With
    Columns("T:T").Select
    Range("T3").Activate
    Selection.FormatConditions.Add Type:=xlTextString, String:="=$T$1", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
    ' Set font color to white
    .Color = RGB(255, 255, 255)  ' White
End With

With Selection.FormatConditions(1).Interior
    ' Set interior (background) color to light gray
    .PatternColorIndex = xlAutomatic
    .Color = RGB(0, 0, 0)  ' Black
End With

    Selection.FormatConditions(1).StopIfTrue = False
End Sub

'= = = = = = = = = = = = = = = = = = = = = = = = =
Private Sub RemoveDuplicateTransactions()
Dim sourceRange As Range
 Dim targetRange As Range

 Set sourceRange = Columns("V:V")
 Set targetRange = Columns("X:X")

 sourceRange.Copy
 targetRange.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, transpose:=False

 With targetRange
     .HorizontalAlignment = xlCenter
     .VerticalAlignment = xlBottom
     .ReadingOrder = xlContext
     .MergeCells = False
     .Font.Size = 14
     .EntireColumn.AutoFit
 End With

 sourceRange.EntireColumn.Hidden = True
 targetRange.RemoveDuplicates Columns:=1, Header:=xlYes

Range("X1:X500").Select
    ActiveWorkbook.Worksheets("IpInformation").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("IpInformation").Sort.SortFields.Add2 Key:=Range( _
        "X1:X500"), SortOn:=xlSortOnValues, Order:=xlDescending, CustomOrder:= _
        "Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec", DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("IpInformation").Sort
        .SetRange Range("X1:X500")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub
'= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =


 Sub IPButtons()
    ' Add a button to the worksheet
      
    Set Y = ActiveSheet.Range("A3")

     Set btn = ActiveSheet.Buttons.Add(Y.Left, Y.Top, Y.Width, Y.Height)
     With btn
    .OnAction = "FilterA"
       .Caption = "RFI 55 "
    .name = "RFI 55 "
    .Font.Bold = True
    .Font.Size = 12

  
   .Font.Color = RGB(220, 20, 60) 'White text


    End With
      
    Set X = ActiveSheet.Range("A4")

     Set btn = ActiveSheet.Buttons.Add(X.Left, X.Top, X.Width, X.Height)
     With btn
    .OnAction = "FilterB"
    .Caption = "RFI 56 "
    .name = "RFI 56 "
    .Font.Bold = True
    .Font.Size = 12

  
   .Font.Color = RGB(220, 20, 60) 'White text


    End With
      
    Set Z = ActiveSheet.Range("A5")

     Set btn = ActiveSheet.Buttons.Add(Z.Left, Z.Top, Z.Width, Z.Height)
     With btn
    .OnAction = "Filterc"
    .Caption = "RFI 57 "
    .name = "RFI 57"
    .Font.Bold = True
    .Font.Size = 12

  
   .Font.Color = RGB(220, 20, 60) 'White text


    End With
       Set v = ActiveSheet.Range("A6")

     Set btn = ActiveSheet.Buttons.Add(v.Left, v.Top, v.Width, v.Height)
     With btn
    .Caption = "RFI 58/59 "
    .OnAction = "FilterD"
    .name = "RFI 58/59 "
    .Font.Bold = True
    .Font.Size = 12

  
   .Font.Color = RGB(220, 20, 60) 'White text


    End With
    Set w = ActiveSheet.Range("A7")

     Set btn = ActiveSheet.Buttons.Add(w.Left, w.Top, w.Width, w.Height)
     With btn
    .Caption = "Hi prob RFI[57,58,59] "
    .OnAction = "IPUpdate"
    .name = "Hi prob RFI[57,58,59]"
    .Font.Bold = True
    .Font.Size = 12

  
   .Font.Color = RGB(220, 20, 60) 'White text


    End With
    
     Set w = ActiveSheet.Range("A9")

     Set btn = ActiveSheet.Buttons.Add(w.Left, w.Top, w.Width, w.Height)
     With btn
    .Caption = "CLEAR "
    .OnAction = "FilterE"
    .name = "CLEAR"
    .Font.Bold = True
    .Font.Size = 12

  
   .Font.Color = RGB(220, 20, 60) 'White text


    End With
    End Sub
    
Sub FilterA()
'rfi 55
 Range("Q1,T2,S2").Select
Selection.ClearContents
 Range("Q2").Value = " COUNTRY"
Range("T2").Value = "Password Mismatch"
Range("S2").Value = "did\'t"
Range("U2").Value = "unknown"
Range("S1").Value = "hi prob"
Range("AT1").Value = "Pre-authentication Flow Enrolled"
    Range("P3").Select
    ActiveCell.Formula2R1C1 = _
        "=FILTER(" & Chr(10) & "    IPTABLE1," & Chr(10) & "    (" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[3], INDEX(IPTABLE1, , 3))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[4], INDEX(IPTABLE1, , 3))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[5], INDEX(IPTABLE1, , 3))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[3], INDEX(IPTABLE1, , 2))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[5], INDEX(IPTABLE1, , 2))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[4], INDEX(IPTA" & _
        "BLE1, , 2))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[3], INDEX(IPTABLE1, , 4))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[5], INDEX(IPTABLE1, , 4))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[4], INDEX(IPTABLE1, , 4))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[3], INDEX(IPTABLE1, , 5))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[5], INDEX(IPTABLE1, , 5))) *" & Chr(10) & "        ISERROR(SEARCH(R[-1]C[4], INDEX(IPTABLE1, , 5))) *" & _
        "" & Chr(10) & "        ISERROR(SEARCH(R[-2]C[30], INDEX(IPTABLE1, , 5)))" & Chr(10) & "    ) *" & Chr(10) & "    (INDEX(IPTABLE1, , 1) <> 0)," & Chr(10) & "    ""NO RESULTS!""" & Chr(10) & ")" & _
        ""

Range("P2").Value = " RFI 55 "
End Sub
Sub SetFilterFormula()
    Dim formulaString As String
    
    formulaString = "=FILTER(IPTABLE1, " & _
        "(ISERROR(SEARCH(S2, INDEX(IPTABLE1, , 3))) * " & _
        "ISERROR(SEARCH(T2, INDEX(IPTABLE1, , 3))) * " & _
        "ISERROR(SEARCH(U2, INDEX(IPTABLE1, , 3))) * " & _
        "ISERROR(SEARCH(S2, INDEX(IPTABLE1, , 2))) * " & _
        "ISERROR(SEARCH(U2, INDEX(IPTABLE1, , 2))) * " & _
        "ISERROR(SEARCH(T2, INDEX(IPTABLE1, , 2))) * " & _
        "ISERROR(SEARCH(S2, INDEX(IPTABLE1, , 4))) * " & _
        "ISERROR(SEARCH(U2, INDEX(IPTABLE1, , 4))) * " & _
        "ISERROR(SEARCH(T2, INDEX(IPTABLE1, , 4))) * " & _
        "ISERROR(SEARCH(S2, INDEX(IPTABLE1, , 5))) * " & _
        "ISERROR(SEARCH(U2, INDEX(IPTABLE1, , 5))) * " & _
        "ISERROR(SEARCH(T2, INDEX(IPTABLE1, , 5)))) * " & _
        "(INDEX(IPTABLE1, , 1) <> 0), " & _
        """NO RESULTS!"")"

    Range("P3").Formula = formulaString
End Sub


Sub FilterB()
 Range("Q1").Select
Selection.ClearContents
 Range("Q2").Value = " COUNTRY"
  Range("S1").Value = "Enter Status"
Range("Q1").Value = "New User Device"
Range("P3").Formula2R1C1 = _
   "=FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,1))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,2))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,3))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,4))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,5))),""NO RESULTS!"")))))"
Range("P2").Value = " RFI 56 "
End Sub

Sub Filterc()

 Range("Q1,S1").Select
Selection.ClearContents
 Range("Q2").Value = " COUNTRY"
   Range("S1").Value = "Enter Status"
Range("AI1").Value = "low prob"
Range("AJ1").Value = "success"
Range("AK1").Value = "New user"
    Range("P3").Formula2R1C1 = _
        "=FILTER(IPTABLE1," & Chr(10) & "    (ISNUMBER(SEARCH(R[-2]C[19], INDEX(IPTABLE1, 0, 1))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[19], INDEX(IPTABLE1, 0, 2))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[19], INDEX(IPTABLE1, 0, 3))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[19], INDEX(IPTABLE1, 0, 4))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[19], INDEX(IPTABLE1, 0, 5))) > 0) +" & Chr(10) & "    (ISNUMBER(SEARCH(R[-2]C[20], INDEX(IPTABLE1, 0" & _
        ", 1))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[20], INDEX(IPTABLE1, 0, 2))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[20], INDEX(IPTABLE1, 0, 3))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[20], INDEX(IPTABLE1, 0, 4))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[20], INDEX(IPTABLE1, 0, 5))) > 0) +" & Chr(10) & "    (ISNUMBER(SEARCH(R[-2]C[21], INDEX(IPTABLE1, 0, 1))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[21], INDEX(IPTABLE1, 0, 2))) +" & Chr(10) & "" & _
        "     ISNUMBER(SEARCH(R[-2]C[21], INDEX(IPTABLE1, 0, 3))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[21], INDEX(IPTABLE1, 0, 4))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[21], INDEX(IPTABLE1, 0, 5))) > 0)," & Chr(10) & "    ""NO RESULTS!"")" & _
        ""

Range("P2").Value = "RFI 57 "
End Sub

'
'
'End Sub
Sub FilterD()
 Range("Q1,S1").Select
 Selection.ClearContents
  Range("Q2").Value = "United States"
  Range("S1").Value = "Enter Status"
Range("AJ1").Value = "success"
Range("AK1").Value = "New user"
Range("P3").Formula2R1C1 = _
"=FILTER(IPTABLE1," & Chr(10) & _
"    (ISNUMBER(SEARCH(R[-2]C[20], INDEX(IPTABLE1, 0, 1))) +" & Chr(10) & _
"     ISNUMBER(SEARCH(R[-2]C[20], INDEX(IPTABLE1, 0, 2))) +" & Chr(10) & _
"     ISNUMBER(SEARCH(R[-2]C[20], INDEX(IPTABLE1, 0, 3))) +" & Chr(10) & _
"     ISNUMBER(SEARCH(R[-2]C[20], INDEX(IPTABLE1, 0, 4))) +" & Chr(10) & _
"     ISNUMBER(SEARCH(R[-2]C[20], INDEX(IPTABLE1, 0, 5))) > 0) +" & Chr(10) & _
"    (ISNUMBER(SEARCH(R[-2]C[21], INDEX(IPTABLE1, 0, 1))) +" & Chr(10) & _
"     ISNUMBER(SEARCH(R[-2]C[21], INDEX(IPTABLE1, 0, 2))) +" & Chr(10) & _
"     ISNUMBER(SEARCH(R[-2]C[21], INDEX(IPTABLE1, 0, 3))) +" & Chr(10) & _
"     ISNUMBER(SEARCH(R[-2]C[21], INDEX(IPTABLE1, 0, 4))) +" & Chr(10) & _
"     ISNUMBER(SEARCH(R[-2]C[21], INDEX(IPTABLE1, 0, 5))) > 0)," & Chr(10) & _
"    ""NO RESULTS!"")"


Columns("R:R").Select
    Range("R3").Activate
    Selection.FormatConditions.Add Type:=xlTextString, String:="=$Q$2", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
   With Selection.FormatConditions(1).Font
  
    .Color = RGB(0, 0, 0)  ' Black
  
End With

With Selection.FormatConditions(1).Interior
    .PatternColorIndex = xlAutomatic
    .Color = RGB(184, 228, 184)  ' Light Green
End With

Range("P2").Value = "RFI 59 "
Offshore
End Sub



Sub FilterE()
   Range("Q1,T2,S2").Select
    Selection.ClearContents
     Range("S1").Value = "Enter Status"
Range("P3").Formula2R1C1 = _
   "=FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,1))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,2))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,3))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,4))),FILTER(IPTABLE1,ISNUMBER(SEARCH(R[-2]C[1],INDEX(IPTABLE1,0,5))),""NO RESULTS!"")))))"
 Range("Q2").Value = " COUNTRY"
Range("P2").Value = " FOR IP WIDGET "
End Sub

Sub IPUpdate()
'
' ipnewupdate Macro
'

'
 Range("Q1").Select
 Selection.ClearContents
  Range("Q2").Value = "United States"
    Range("AM1").Value = "hi prob"
    Range("AN1").Value = "Reset"
    Range("AO1").Value = "Attempting adding CC"
    Range("AP1").Value = "Failed"
    Range("AQ1").Value = "Terminated"
   Range("AR1").Value = "Password Mismatch"
    Range("AS1").Value = "MLB Block"
    Range("AT1").Value = "Pre-authentication Flow Enrolled"
    Columns("AM:AQ").EntireColumn.AutoFit


    Range("P3").Select
    ActiveCell.Formula2R1C1 = _
        "=FILTER(" & Chr(10) & "    IPTABLE1," & Chr(10) & "    ISNUMBER(SEARCH(R[-2]C[23], INDEX(IPTABLE1, 0, 4))) *" & Chr(10) & "  (ISNUMBER(SEARCH(R[-2]C[30], INDEX(IPTABLE1, 0, 5))) +" & Chr(10) & "   ISNUMBER(SEARCH(R[-2]C[24], INDEX(IPTABLE1, 0, 5))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[25], INDEX(IPTABLE1, 0, 5))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[26], INDEX(IPTABLE1, 0, 5))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[27], INDEX(IPTABLE1, 0, 5))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[28], INDEX(IPTABLE1, 0," & _
        " 5))) +" & Chr(10) & "     ISNUMBER(SEARCH(R[-2]C[29], INDEX(IPTABLE1, 0, 5))) = 0)," & Chr(10) & "    ""NO RESULTS!""" & Chr(10) & ")" & _
        ""
    Columns("R:R").Select
    Range("R3").Activate
    Selection.FormatConditions.Add Type:=xlTextString, String:="=$Q$2", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
   With Selection.FormatConditions(1).Font
  
    .Color = RGB(0, 0, 0)  ' Black
  
End With

With Selection.FormatConditions(1).Interior
    .PatternColorIndex = xlAutomatic
    .Color = RGB(184, 228, 184)  ' Light Green
End With
        
        
Range("P2").Value = "[RFI 57,58,59]"

End Sub





Sub DateColor()
'
' DateColor Macro
'

'
    Range("X:X").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="mar", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent5
        .TintAndShade = 0.399945066682943
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.FormatConditions.Add Type:=xlTextString, String:="may", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 7599359
  
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.FormatConditions.Add Type:=xlTextString, String:="Jun", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 9437118
    
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Selection.FormatConditions.Add Type:=xlTextString, String:="jul", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 10251519
    
    End With
    Selection.FormatConditions(1).StopIfTrue = False
  Range("P1:P2").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Range("P2").Select
    Selection.Font.Size = 16

    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 4.99893185216834E-02
    End With
    Range("P1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 4.99893185216834E-02
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
   Range("Q2").Select
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Range("P2").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorLight1
    End With
    
    Columns("S:S").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="Low", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = -0.249946592608417
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.FormatConditions.Add Type:=xlTextString, String:="Hi", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.FormatConditions.Add Type:=xlTextString, String:="success", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 5287936
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Selection.FormatConditions.Add Type:=xlTextString, String:="new", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -1003520
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Columns("R:R").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="Baja", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With
    Columns("R:R").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="Missouri", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With
    
    Columns("R:R").Select
    Selection.FormatConditions.Add Type:=xlTextString, String:="georgia", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .ThemeColor = xlThemeColorDark1
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With


End Sub

Sub Offshoree()
    Range("AV1").Value = "Bermuda"
    Range("AV2").Value = "Bahamas "
    Range("AV3").Value = "the British Virgin Islands "
    Range("AV4").Value = "Cayman Islands"
    Range("AV5").Value = "Hong Kong"
    Range("AV6").Value = "Isle of Man"
    Range("AV7").Value = "Jersey"
    Range("AV8").Value = "Kuwait"
    Range("AV9").Value = "Luxembourg"
    Range("AV10").Value = "Macao"
    Range("AV11").Value = "Malta"
    Range("AV12").Value = "Mauritius"
    Range("AV13").Value = "Qatar"
    Range("AV14").Value = "Guernsey"
    Range("AV15").Value = "Gibraltar"
    Range("AV16").Value = "Panama"
    
    
    Columns("R:R").Select
    Range("R3").Activate
    Selection.FormatConditions.Add Type:=xlTextString, String:="=$V$1", _
        TextOperator:=xlContains
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
   With Selection.FormatConditions(1).Font
    .Color = RGB(0, 0, 0)  ' Black
  
End With

With Selection.FormatConditions(1).Interior
    .PatternColorIndex = xlAutomatic
    .Color = RGB(230, 190, 255)
End With
End Sub
Sub Offshore()
    Dim countries As Variant
    Dim i As Integer
   
    ' Array of countries
    countries = Array("Bermuda", "Bahamas", "the British Virgin Islands", "Cayman Islands", _
                      "Hong Kong", "Isle of Man", "Jersey", "Kuwait", "Luxembourg", _
                      "Macao", "Malta", "Mauritius", "Qatar", "Guernsey", "Gibraltar", "Panama")

    ' Populate the range with country names
    For i = LBound(countries) To UBound(countries)
        Range("AV" & (i + 1)).Value = countries(i)
    Next i

    ' Clear previous conditional formats in Column R
  '  Columns("R:R").FormatConditions.Delete
    
    ' Set formatting for Column R based on the array values
    For i = LBound(countries) To UBound(countries)
        With Columns("R:R").FormatConditions.Add(Type:=xlTextString, String:=countries(i), _
            TextOperator:=xlContains)
            .SetFirstPriority
            With .Font
                .Color = RGB(0, 0, 0)  ' Black
            End With
            With .Interior
                .PatternColorIndex = xlAutomatic
                .Color = RGB(230, 190, 255)
            End With
        End With
    Next i
    Range("P3").Select
End Sub

Sub IPBorder()
'
' Macro5 Macro
'

'
    Rows("1:300").Select
    ActiveWindow.SmallScroll Down:=-264
    Selection.RowHeight = 33
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("P:P").ColumnWidth = 40
    Columns("R:T").ColumnWidth = 40
    Columns("Q:Q").ColumnWidth = 20
    Range("P3:T300").Select
  
    
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlHairline
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlHairline
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlHairline
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlHairline
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlHairline
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlHairline
    End With
    Selection.Font.Size = 14
    Range("q3:q500").Font.Size = 1
End Sub

'==========================================================================================================================================

'==========================================================================================================================================

'==========================================================================================================================================

Type UserInfos
    UserName As String
    OldNames() As String
    HomLoc As String
    CurrLoc As String
    ProfLoc As String
    DateJoined As Date
    DaysActive As Integer
    DaysOnFacebook As Integer
    DaysOnFacebooks As Integer
    NumOfFriends As Integer
    FAI As Single
    PaymentStatus As String
    TriggerReasons As String
    
  
End Type

Dim USERINFO As UserInfos
Dim worksheetName As String
Dim MarkString As String, NoMarkString As String


Sub UserInformationInit()
'
' UserInformationInit Macro
'

'
    Sheets.Add
    Sheets("Sheet17").Select
    Sheets("Sheet17").name = "UserInformation"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "Insert User Data Here"
    Range("B1").Select
    Selection.Font.Bold = True
    Selection.Font.Italic = True
    Selection.Font.Size = 12
    Selection.Font.Size = 14
    Selection.Font.Size = 16
    Selection.Font.Size = 18
    Columns("B:B").EntireColumn.AutoFit
    Columns("A:A").Select
    Selection.ColumnWidth = 30
    Range("A1").Select
    ActiveSheet.Buttons.Add(11, 7, 120, 30).Select
    Selection.OnAction = "PERSONAL.XLSB!UserInformation.UserInformation"
    ActiveSheet.Shapes("Button 1").IncrementLeft 23
    ActiveSheet.Shapes("Button 1").IncrementTop 1
    Selection.Characters.Text = "Button 1"
    With Selection.Characters(Start:=1, Length:=8).Font
        .name = "Calibri"
        .FontStyle = "Regular"
        .Size = 11
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    ActiveSheet.Shapes.SelectAll
    Selection.Characters.Text = "Automate Results"
    With Selection.Characters(Start:=1, Length:=16).Font
        .name = "Calibri"
        .FontStyle = "Regular"
        .Size = 12
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
    Range("F21").Select
    Sheets("UserInformation").Select
    
    Columns("G:G").Select
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=""X"""
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Color = -16383844
        .TintAndShade = 0
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13551615
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Cells.FormatConditions.Delete
    Columns("G:G").Select
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=""X"""
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Font
        .Bold = True
        .Italic = False
        .TintAndShade = 0
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249946592608417
    End With
    Selection.FormatConditions(1).StopIfTrue = True
    
    ActiveWindow.DisplayGridlines = False
    
End Sub


Sub UserInformation()
   ' Sheets("Sheet1").name = "UserInformation"
    worksheetName = "UserInformation"    ' Edit WorkSheet Name here.. Make sure it is the same in Excel
    
    MarkString = "X"
    NoMarkString = " "
    
    Dim counter As Integer
    Dim userLabels() As Variant
    ReDim userLabels(0 To 22)
    
    UserLabelsInit (userLabels)
    
    UserInfoCondition
    
    DESIGN
    
    NewGUI
  '  userinfomarkings
End Sub

Private Sub UserInfoCondition()
    ' === RFI 05 SECTION ===
    RFI05
    
    ' === RFI 06 SECTION ===
    RFI06
    
    ' === RFI 07 SECTION ===
    RFI07
    
    ' === RFI 08 SECTION ===
    RFI08
    
    ' === RFI 09 SECTION ===
    RFI09
    
    ' === RFI 10 SECTION ===
    Sheets(worksheetName).Range("F10").Value = "RFI 10"
    Sheets(worksheetName).Range("H10").Value = "Check Profile"
    
    ' === RFI 11 SECTION ===
    RFI11
    
    ' === RFI 12 SECTION ===
    RFI12
    
    ' === RFI 13 SECTION ===
    RFI13
    
    ' === RFI 14 SECTION ===
    Sheets(worksheetName).Range("F14").Value = "RFI 14"
    Sheets(worksheetName).Range("H14").Value = "Check Profile"
    
    ' === RFI 15 SECTION ===
    RFI15
    
     ' === RFI 16 SECTION ===
    Sheets(worksheetName).Range("F16").Value = "RFI 16"
    Sheets(worksheetName).Range("H16").Value = "Inauthentic??"
    
End Sub

Private Sub RFI05()
    If USERINFO.TriggerReasons = "SFI" Then
        Sheets(worksheetName).Range("F5").Value = "RFI 5"
        Sheets(worksheetName).Range("G5").Value = MarkString
        Sheets(worksheetName).Range("H5").Value = USERINFO.TriggerReasons
    Else
        Sheets(worksheetName).Range("F5").Value = "RFI 5"
        Sheets(worksheetName).Range("G5").Value = NoMarkString
        Sheets(worksheetName).Range("H5").Value = USERINFO.TriggerReasons
    End If
End Sub

Private Sub RFI06()
    If USERINFO.PaymentStatus = "Payments Disabled" Then
        Sheets(worksheetName).Range("F6").Value = "RFI 6"
        Sheets(worksheetName).Range("G6").Value = MarkString
        Sheets(worksheetName).Range("H6").Value = USERINFO.PaymentStatus
        Sheets(worksheetName).Range("J6").Value = " Check Shields"

    Else
        Sheets(worksheetName).Range("F6").Value = "RFI 6"
        Sheets(worksheetName).Range("G6").Value = NoMarkString
        Sheets(worksheetName).Range("H6").Value = USERINFO.PaymentStatus
    
    
    End If
End Sub

Private Sub RFI07()
    If USERINFO.PaymentStatus = "Payments Disabled" Then
        Sheets(worksheetName).Range("F7").Value = "RFI 7"
        Sheets(worksheetName).Range("G7").Value = MarkString
        Sheets(worksheetName).Range("H7").Value = USERINFO.PaymentStatus
        Sheets(worksheetName).Range("J7").Value = " check Account Action Notes."

    Else
        Sheets(worksheetName).Range("F7").Value = "RFI 7"
        Sheets(worksheetName).Range("G7").Value = NoMarkString
        Sheets(worksheetName).Range("H7").Value = USERINFO.PaymentStatus
       
    End If
End Sub

Private Sub RFI08()
    Dim finalRes As String
    Dim trueCounter As Integer, sizeCounter As Integer
    falseCounter = 0
    sizeCounter = falseCounter
    Debug.Print IsEmpty(USERINFO.OldNames)

    If IsEmpty(USERINFO.OldNames) = False Then
        For Each oldName In USERINFO.OldNames
            If IsEmpty(oldName) = False Then
                finalRes = StrComp(USERINFO.UserName, oldName, vbTextCompare)
                Debug.Print "FINAL RES: " & finalRes
                If finalRes = "-1" Then
                    trueCounter = trueCounter + 1
                    Debug.Print trueCounter
                End If
            End If
            sizeCounter = sizeCounter + 1
        Next oldName
    Else
        Sheets(worksheetName).Range("G8").Value = False
        Sheets(worksheetName).Range("H8").Value = "Old Names not Found"
    End If
    sizeCounter = sizeCounter - 1
    Debug.Print trueCounter & " = " & sizeCounter
    
    If trueCounter < sizeCounter Then
            Sheets(worksheetName).Range("F8").Value = "RFI 8"
            Sheets(worksheetName).Range("G8").Value = NoMarkString
            Sheets(worksheetName).Range("H8").Value = "Check old name"
        Else
            Sheets(worksheetName).Range("F8").Value = "RFI 8"
            Sheets(worksheetName).Range("G8").Value = NoMarkString
            Sheets(worksheetName).Range("H8").Value = "Check old name"
    End If
End Sub

Private Sub RFI09()
    If USERINFO.FAI > 0.59 Then
        Sheets(worksheetName).Range("F9").Value = "RFI 9"
        Sheets(worksheetName).Range("G9").Value = MarkString
        Sheets(worksheetName).Range("H9").Value = USERINFO.FAI
    Else
        Sheets(worksheetName).Range("F9").Value = "RFI 9"
        Sheets(worksheetName).Range("G9").Value = NoMarkString
        Sheets(worksheetName).Range("H9").Value = USERINFO.FAI
    End If
End Sub

Private Sub RFI11()
    If USERINFO.DaysOnFacebook < 30 Then
        Sheets(worksheetName).Range("F11").Value = "RFI 11"
        Sheets(worksheetName).Range("G11").Value = MarkString
        Sheets(worksheetName).Range("H11").Value = USERINFO.DaysOnFacebook
    Else
        Sheets(worksheetName).Range("F11").Value = "RFI 11"
        Sheets(worksheetName).Range("G11").Value = NoMarkString
        Sheets(worksheetName).Range("H11").Value = USERINFO.DaysOnFacebook
    End If
End Sub

Private Sub RFI12()
    If USERINFO.NumOfFriends < 10 Then
        Sheets(worksheetName).Range("F12").Value = "RFI 12"
        Sheets(worksheetName).Range("G12").Value = MarkString
        Sheets(worksheetName).Range("H12").Value = USERINFO.NumOfFriends
    Else
        Sheets(worksheetName).Range("F12").Value = "RFI 12"
        Sheets(worksheetName).Range("G12").Value = NoMarkString
        Sheets(worksheetName).Range("H12").Value = USERINFO.NumOfFriends
    End If
End Sub

Private Sub RFI13()
Dim DayActive As Double
Dim FormattedDayActive As String

'    Range("H13").NumberFormat = "0.00"
'    Range("H13").FormulaR1C1 = "=R[7]C[-6]/R[9]C[-6]*100"
'    DayActive = (userInfo.DaysActive / userInfo.DaysOnFacebook) * 100
    DayActive = (USERINFO.DaysOnFacebooks / USERINFO.DaysOnFacebook) * 100
    FormattedDayActive = Format(DayActive, "0.00")
'    If Range("H13") > 29 Then
    If FormattedDayActive > 29 Then
        Sheets(worksheetName).Range("F13").Value = "RFI 13"
        Sheets(worksheetName).Range("G13").Value = NoMarkString
        Sheets(worksheetName).Range("H13").Value = FormattedDayActive
    Else
        Sheets(worksheetName).Range("F13").Value = "RFI 13"
        Sheets(worksheetName).Range("G13").Value = MarkString
        Sheets(worksheetName).Range("H13").Value = FormattedDayActive
    End If
End Sub
Private Sub RFI15()
    Dim HomeLocRes As Boolean
    Dim CurrLocRes As Boolean
    Dim ProfLocRes As Boolean

    ' Array of country codes to check against
    Dim countryCodes As Variant
    countryCodes = Array("Afghanistan", "Algeria", "Angola", "Antarctica", "Armenia", "Azerbaijan", "Bangladesh", "Barbados", "Belarus", "Belize", _
                         "Benin", "Bhutan", "Bolivia", "Brazil", "Bulgaria", "Burkina Faso", "Cambodia", "Cameroon", "Cape Verde", "Cayman Islands", _
                         "Central African Republic", "Chad", "China", "Comoros", "Cte D'ivoire", "Democratic Republic Of The Congo", "Djibouti", "Equatorial Guinea", "Eritrea", "Eswatini", _
                         "Ethiopia", "Gabon", "Gambia", "Ghana", "Gibraltar", "Guatemala", "Guinea", "Guinea-Bissau", "Guyana", "Haiti", _
                         "Honduras", "Iraq", "Israel", "Jamaica", "Jordan", "Kenya", "Kuwait", "Kyrgyzstan", "Laos", "Lebanon", _
                         "Lesotho", "Liberia", "Libya", "Macao SAR, China", "Madagascar", "Malawi", "Maldives", "Mali", "Marshall Islands", "Mauritania", _
                         "Montenegro", "Mozambique", "Myanmar", "Nepal", "Netherlands Antilles", "Nicaragua", "Niger", "Nigeria", "Pakistan", "Palau", _
                         "Palestine, State of", "Panama", "Papua New Guinea", "Philippines", "Republic Of Congo", "Rwanda", "Saint Kitts and Nevis", "Samoa", "Sao Tome and Principe", "Saudi Arabia", _
                         "Senegal", "Serbia", "Seychelles", "Sierra Leone", "Sint Maarten", "Solomon Islands", "Somalia", "South Africa", "South Sudan", "Sri Lanka", _
                         "Sudan", "Suriname", "Tajikistan", "Tanzania", "Thailand", "Togo", "Tonga", "Trinidad and Tobago", "Turkey", "Turkmenistan", _
                         "Turks and Caicos Islands", "Uganda", "Ukraine", "United Arab Emirates", "Vanuatu", "Venezuela", "Vietnam", "Yemen", "Zambia", "Zimbabwe", "ZW", _
                         "Cuba", "Iran", "North Korea", "Russia", "Syrian Arab Republic", "Ukraine - Crimea Region", "Ukraine - Donetsk Region", "Ukraine - Luhansk Region")

    ' Check if any location contains a country code
    HomeLocRes = ContainsCountryCode(USERINFO.HomLoc, countryCodes)
    CurrLocRes = ContainsCountryCode(USERINFO.CurrLoc, countryCodes)
    ProfLocRes = ContainsCountryCode(USERINFO.ProfLoc, countryCodes)

    If HomeLocRes Or CurrLocRes Or ProfLocRes Then
        Sheets(worksheetName).Range("F15").Value = "RFI 15"
        Sheets(worksheetName).Range("G15").Value = MarkString
        Sheets(worksheetName).Range("H15").Value = "High Risk / Sanction Country"
    Else
        Sheets(worksheetName).Range("F15").Value = "RFI 15"
        Sheets(worksheetName).Range("G15").Value = NoMarkString
        Sheets(worksheetName).Range("H15").Value = "No High Risk country found"
    End If
End Sub

Function ContainsCountryCode(location As String, countryCodes As Variant) As Boolean
    Dim countryCode As Variant
    For Each countryCode In countryCodes
        If InStr(1, location, countryCode, vbTextCompare) <> 0 Then
            ContainsCountryCode = True
            Exit Function
        End If
    Next countryCode
    ContainsCountryCode = False
End Function

Private Sub UserLabelsInit(userLabels As Variant)
    ReDim USERINFO.OldNames(0)
    
    userLabels(0) = "User Name"
    userLabels(1) = "Gender"
    userLabels(2) = "Date of Birth"
    userLabels(3) = "Old Names"
    userLabels(4) = "Phone"
    userLabels(5) = "Email"
    userLabels(6) = "Home Location"
    userLabels(7) = "Current Location"
    userLabels(8) = "Profile Location"
    userLabels(9) = "Date Joined"
    userLabels(10) = "Days Active"
    userLabels(11) = "Days on Facebook"
    userLabels(12) = "Number of Friends"
    userLabels(13) = "Relationship"
    userLabels(14) = "P2P 7-Day Sum"
    userLabels(15) = "P2P Lifetime Sum"
    userLabels(16) = "P2P Sent in 30 Days"
    userLabels(17) = "P2P Received in 30 Days"
    userLabels(18) = "Account Status"
    userLabels(19) = "Fake or Hacked Score"
    userLabels(20) = "FAI"
    userLabels(21) = "Payment Status"
    userLabels(22) = "Trigger Reasons"
    
    Dim lastRow As Long
    Dim lastCol As Long
    Dim dataRange As Range
    Dim OldNameCounter As Integer
    
    
    lastRow = Sheets(worksheetName).Cells(Sheets(worksheetName).Rows.count, "B").End(xlUp).Row
    lastCol = Sheets(worksheetName).Cells(1, Sheets(worksheetName).Columns.count).End(xlToLeft).Column
    
    Set dataRange = Sheets(worksheetName).Range(Sheets(worksheetName).Cells(1, 1), Sheets(worksheetName).Cells(lastRow, lastCol))
     
    For Each cell In dataRange
        For Each counter In userLabels
            If cell.Value = counter Then
                Debug.Print counter & " Detected"
                If counter = "User Name" Then
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    USERINFO.UserName = ActiveCell.Value
                    Debug.Print USERINFO.UserName
                End If
                If counter = "Old Names" Then
                    Dim oNCounter As Integer
                    oNCounter = 0
                    ReDim USERINFO.OldNames(0)
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    While ActiveCell.Value <> "Phone"
                        USERINFO.OldNames(UBound(USERINFO.OldNames)) = ActiveCell.Value
                        If ActiveCell.Value <> "Phone" Then
                            ReDim Preserve USERINFO.OldNames(UBound(USERINFO.OldNames) + 1)
                            ActiveCell.Offset(1, 0).Select
                        End If
                    Wend
                    For Each oldName In USERINFO.OldNames
                        Debug.Print oldName
                    Next
                End If
                If counter = "Home Location" Then
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    USERINFO.HomLoc = ActiveCell.Value
                    Debug.Print USERINFO.HomLoc
                End If
                If counter = "Current Location" Then
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    USERINFO.CurrLoc = ActiveCell.Value
                    Debug.Print USERINFO.CurrLoc
                End If
                If counter = "Profile Location" Then
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    USERINFO.ProfLoc = ActiveCell.Value
                    Debug.Print USERINFO.ProfLoc
                End If
                If counter = "Date Joined" Then
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    USERINFO.DateJoined = ActiveCell.Value
                    Debug.Print USERINFO.DateJoined
                End If
''                If counter = "Days Active" Then
''                    cell.Select
''                    ActiveCell.Offset(1, 0).Select
''                    userInfo.DaysActive = CInt(ActiveCell.Value)
''                    Debug.Print userInfo.DaysActive
''                End If
                  If counter = "Days on Facebook" Then
                    cell.Select
                    ActiveCell.Offset(-1, 0).Select
                    USERINFO.DaysOnFacebooks = CInt(ActiveCell.Value)
                    Debug.Print USERINFO.DaysOnFacebooks
                End If
                If counter = "Days on Facebook" Then
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    USERINFO.DaysOnFacebook = CInt(ActiveCell.Value)
                    Debug.Print USERINFO.DaysOnFacebook
                End If
                If counter = "Number of Friends" Then
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    USERINFO.NumOfFriends = ActiveCell.Value
                    Debug.Print USERINFO.NumOfFriends
                End If
                If counter = "FAI" Then
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    USERINFO.FAI = ActiveCell.Value
                    Debug.Print USERINFO.FAI
                End If
                If counter = "Payment Status" Then
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    USERINFO.PaymentStatus = ActiveCell.Value
                    Debug.Print USERINFO.PaymentStatus
                End If
                If counter = "Trigger Reasons" Then
                    cell.Select
                    ActiveCell.Offset(1, 0).Select
                    USERINFO.TriggerReasons = ActiveCell.Value
                    Debug.Print USERINFO.TriggerReasons
                End If
            End If
        Next counter
    Next cell
    

End Sub


Sub DESIGN()
'
' UINFO Macro
'

'
    Range("F5:L16").Font.Size = 26
    Columns("E:E").ColumnWidth = 11.17
    Columns("F:F").ColumnWidth = 16.5
    Columns("G:G").ColumnWidth = 22.17
    Columns("H:H").ColumnWidth = 40.67
    
        Range("F5:F16").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent3
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Range("G5:H16").Select
    ActiveWindow.SmallScroll Down:=0
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("G5:G16").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("H8").Select
    ActiveWindow.SmallScroll Down:=0
    
     Columns("G:G").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With

    Columns("H:H").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    ActiveWindow.DisplayGridlines = False
    
     Columns("A:C").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -0.499984740745262
        .PatternTintAndShade = 0
    End With
    Range("I6:I7").Select
    Selection.Font.Size = 12

    Range("F10").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 4.99893185216834E-02
        .PatternTintAndShade = 0
    End With
    Range("F14").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 4.99893185216834E-02
        .PatternTintAndShade = 0
    End With

  Range("G5:H16").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With

End Sub


Sub color2()

    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 4.99893185216834E-02
        .PatternTintAndShade = 0
    End With
    Range("F10").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 4.99893185216834E-02
        .PatternTintAndShade = 0
    End With
    Range("F14").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 4.99893185216834E-02
        .PatternTintAndShade = 0
    End With
End Sub
Sub border()
    Range("G5:H16").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlDash
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
End Sub

Sub userinfomarkings()
    Range("G10:H10").Merge
    Range("G14:H14").Merge
    Range("G16:H16").Merge
    Columns("H:H").EntireColumn.AutoFit
Sheets("Dashboard").Select
    Range("D5:D16").ClearContents
    Range("D5").FormulaR1C1 = "=IF(UserInformation!RC[3]=""X"",""x"","""")"
    Range("D7").FormulaR1C1 = "=IF(UserInformation!RC[3]=""X"",""x"","""")"
    Range("D9").FormulaR1C1 = "=IF(UserInformation!RC[3]=""X"",""x"","""")"
    Range("D11").FormulaR1C1 = "=IF(UserInformation!RC[3]=""X"",""x"","""")"
    Range("D12").FormulaR1C1 = "=IF(UserInformation!RC[3]=""X"",""x"","""")"
    Range("D13").FormulaR1C1 = "=IF(UserInformation!RC[3]=""X"",""x"","""")"
    Range("D15").FormulaR1C1 = "=IF(UserInformation!RC[3]=""X"",""x"","""")"

End Sub

Sub NewGUI()
'
' NewGUI Macro
'

'
    Range("G10,G14,G16").Select
    Selection.Font.Size = 16
    Range("H15").Select
    Selection.Font.Size = 18
    Range("F5:F16").Select
    Selection.InsertIndent 1
    Selection.InsertIndent 1
    Selection.InsertIndent 1

    ActiveCell.FormulaR1C1 = "RFI 5"
    Range("F5:F9").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
     Range("F11:F13").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Range("F15:F16").Select
     With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 255
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    Range("G5:G16").Select
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=""X"""
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 49407
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    
    Range("G3").Select
    ActiveCell.FormulaR1C1 = """MARK OR SKIP"""
    Selection.Font.Size = 14
   Selection.Font.Bold = True
    Range("F3").Select
    ActiveCell.FormulaR1C1 = """RFI"""
    Selection.InsertIndent 1
    Selection.InsertIndent 1
    Selection.InsertIndent 1
    Selection.InsertIndent 1
    Selection.InsertIndent 1
    Selection.InsertIndent 1
    Selection.InsertIndent 1
    Selection.Font.Size = 14
    Selection.Font.Bold = True
    Range("H3").Select
    ActiveCell.FormulaR1C1 = """AUTOMATION RESULT"""
    Range("H3").Select
   Selection.Font.Size = 14
   Selection.Font.Bold = True
    Range("E2:I18").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    Range("F3:H3").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
       Range("F3:H3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 49407
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
    End With
    
    Range("F1:H1").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .ReadingOrder = xlContext
    End With
    Selection.Merge
    ActiveCell.FormulaR1C1 = "USER INFORMATION WIDGET"
    Range("F1:H1").Select
    Selection.Font.Size = 18
    
        Columns("B:B").EntireColumn.AutoFit
        
'''''button user info
'Set Z = ActiveSheet.Range("I3")
'
'     Set btn = ActiveSheet.Buttons.Add(Z.Left, Z.Top, Z.Width, Z.Height)
'     With btn
'    .OnAction = "CopyUserInfo"
'    .Caption = "CopyUserInfo "
'    .name = "SAVE"
'    .Font.Bold = True
'    .Font.Size = 12
'
'
'   .Font.Color = RGB(220, 20, 60) 'White text

    Range("C1").Select
End Sub
Sub CopyUserInfo()

    Range("G5:G16").Select
    Selection.Copy
    Workbooks.Open "/Users/locationunix/Desktop/RFI_Sheet/L0_RFI_UID.xlsx"
    Range("D5:D16").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, transpose:=False
    
  
End Sub

enduser info


